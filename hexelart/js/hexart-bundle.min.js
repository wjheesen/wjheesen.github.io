!function t(e,r,n){function o(a,c){if(!r[a]){if(!e[a]){var s="function"==typeof require&&require;if(!c&&s)return s(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var f=r[a]={exports:{}};e[a][0].call(f.exports,function(t){var r=e[a][1][t];return o(r?r:t)},f,f.exports,t,e,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,r){"use strict";function n(t){var e=t>>3;return 7&t&&e++,new i(new ArrayBuffer(e))}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../math/rect"),i=function(){function t(t){this.data=new Uint8Array(t),this.length=t.byteLength<<3}return t.prototype.get=function(t){var e=t>>3,r=7&t,n=this.data[e];return n>>r&1},t.prototype.set=function(t){var e=t>>3,r=7&t;this.data[e]|=1<<r},t.prototype.clear=function(t){var e=t>>3,r=7&t;this.data[e]&=~(1<<r)},t.prototype.forEach=function(t){for(var e=0;e<this.data.length;e++)for(var r=this.data[e],n=0;8>n;n++)t(r>>n&1)},t.prototype.toString=function(){var t="";return this.forEach(function(e){t+=e}),t},t}();r.BitArray=i;var a=function(){function t(t,e,r){this.data=t,this.color=r,this.bounds=e}return t.make=function(e,r,i,a){for(var c,s=0,u=0;i>s;s++)for(var f=0;r>f;f++)e.get(u++)&&(c?o.unionXY(c,f,s):c=o.ltrb(void 0,f,s,f,s));if(!c)return null;for(var h=o.width(c)+1,p=o.height(c)+1,l=n(h*p),s=c.bottom,u=0;s<=c.top;s++)for(var f=c.left;f<=c.right;f++,u++)e.get(s*r+f)&&l.set(u);return new t(l,c,a)},t.prototype.forEachSetBit=function(t,e){var r=this,n=this.bounds.left,o=this.bounds.bottom*t;this.data.forEach(function(i){i&&e(o+n),++n>r.bounds.right&&(n=r.bounds.left,o+=t)})},t}();r.BinaryImage=a,r.createBitArray=n},{"../math/rect":23}],2:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./item"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t){return new e(new Uint8Array(4*t))},Object.defineProperty(e.prototype,"r",{get:function(){return this.data[this.dataPosition+0]},set:function(t){this.data[this.dataPosition+0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this.data[this.dataPosition+1]},set:function(t){this.data[this.dataPosition+1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this.data[this.dataPosition+2]},set:function(t){this.data[this.dataPosition+2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this.data[this.dataPosition+3]},set:function(t){this.data[this.dataPosition+3]=t},enumerable:!0,configurable:!0}),e.prototype.itemLength=function(){return 4},e.prototype.set=function(t,e,r,n,o){var i=t*this.itemLength();this.data[i++]=e,this.data[i++]=r,this.data[i++]=n,this.data[i++]=o},e.prototype.put=function(t,e,r,n){this.data[this.dataPosition++]=t,this.data[this.dataPosition++]=e,this.data[this.dataPosition++]=r,this.data[this.dataPosition++]=n},e}(o.ItemBuffer);r.ColorBuffer=i},{"./item":3}],3:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function t(t,e){void 0===e&&(e=0),this.data=t,this.dataPosition=e*this.itemLength()}return t.prototype.position=function(){return this.dataPosition/this.itemLength()>>0},t.prototype.capacity=function(){return this.data.length/this.itemLength()>>0},t.prototype.hasValidPosition=function(){return 0<=this.dataPosition&&this.dataPosition<this.data.length},t.prototype.moveToPosition=function(t){return this.dataPosition=t*this.itemLength(),this.hasValidPosition()},t.prototype.moveToFirst=function(){return this.dataPosition=0,this.dataPosition<this.data.length},t.prototype.moveToNext=function(){return this.dataPosition+=this.itemLength(),this.hasValidPosition()},t.prototype.moveToPrevous=function(){return this.dataPosition-=this.itemLength(),this.hasValidPosition()},t.prototype.moveToLast=function(){return this.data.length?(this.dataPosition=this.data.length-this.itemLength(),!0):(this.dataPosition=0,!1)},t.prototype.setBuffer=function(t,e,r){for(var n=e.dataPosition,o=t*this.itemLength();r--;)for(var i=this.itemLength();i--;)this.data[o++]=e.data[n++]},t.prototype.setItem=function(t,e){for(var r=this.itemLength(),n=0,o=t*r;r--;)this.data[o++]=e.data[n++]},t.prototype.setEachItem=function(t){for(var e=0,r=this.data.length;r--;)for(var n=0,o=this.itemLength();o--;)this.data[e++]=t.data[n++]},t.prototype.putItem=function(t){for(var e=this.itemLength(),r=0;e--;)this.data[this.dataPosition++]=t.data[r++]},t.prototype.putBuffer=function(t,e){for(void 0===e&&(e=t.capacity()-t.position());e--;)for(var r=this.itemLength();r--;)this.data[this.dataPosition++]=t.data[t.dataPosition++]},t.prototype.equals=function(t){if(this.data.length!==t.data.length)return!1;for(var e=0;e<this.data.length;e++)if(this.data[e]!==t.data[e])return!1;return!0},t.prototype.equalsScalar=function(t){for(var e=0;e<this.data.length;e++)if(this.data[e]!==t)return!1;return!0},t.prototype.epsilonEquals=function(t,e){if(this.data.length!==t.data.length)return!1;for(var r=0;r<this.data.length;r++)if(Math.abs(this.data[r]-t.data[r])>e)return!1;return!0},t.prototype.epsilonEqualsScalar=function(t,e,r){for(var n=0;n<this.data.length;n++)if(Math.abs(this.data[n]-e)>r)return!1;return!0},t}();r.ItemBuffer=n},{}],4:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./item"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t){return new e(new Uint16Array(3*t))},Object.defineProperty(e.prototype,"first",{get:function(){return this.data[this.dataPosition+0]},set:function(t){this.data[this.dataPosition+0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"second",{get:function(){return this.data[this.dataPosition+1]},set:function(t){this.data[this.dataPosition+1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"third",{get:function(){return this.data[this.dataPosition+2]},set:function(t){this.data[this.dataPosition+2]=t},enumerable:!0,configurable:!0}),e.prototype.itemLength=function(){return 3},e.prototype.set=function(t,e,r,n){var o=t*this.itemLength();this.data[o++]=e,this.data[o++]=r,this.data[o++]=n},e.prototype.put=function(t,e,r){this.data[this.dataPosition++]=t,this.data[this.dataPosition++]=e,this.data[this.dataPosition++]=r},e}(o.ItemBuffer);r.TriangleIndicesBuffer=i},{"./item":3}],5:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./item"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t){return new e(new Float32Array(2*t))},Object.defineProperty(e.prototype,"x",{get:function(){return this.data[this.dataPosition+0]},set:function(t){this.data[this.dataPosition+0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.data[this.dataPosition+1]},set:function(t){this.data[this.dataPosition+1]=t},enumerable:!0,configurable:!0}),e.prototype.itemLength=function(){return 2},e.prototype.set=function(t,e,r){var n=t*this.itemLength();this.data[n++]=e,this.data[n++]=r},e.prototype.put=function(t,e){this.data[this.dataPosition++]=t,this.data[this.dataPosition++]=e},e}(o.ItemBuffer);r.Vec2Buffer=i},{"./item":3}],6:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("../math/rect"),i=t("../math/mat2d"),a=t("./vec2"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t){return new e(new Float32Array(2*t))},e.prototype.calculateBounds=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.capacity()),o.unionOfPoints(void 0,this.data,t*this.itemLength(),e)},e.prototype.contains=function(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=this.capacity());var o=!1;return this.forEachEdge(function(r,n,i,a){n>e!=a>e&&(i-r)*(e-n)/(a-n)+r>t&&(o=!o)},r,n),o},e.prototype.containsPoint=function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=this.capacity()),this.contains(t.x,t.y,e,r)},e.prototype.offset=function(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=this.capacity());for(var o=r*this.itemLength(),i=0;n>=i;i++)this.data[o++]+=t,this.data[o++]+=e},e.prototype.transform=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=this.capacity());var n=e*this.itemLength();i.mapPoints(t,this.data,n,r,this.data,n)},e.prototype.forEachEdge=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=this.capacity());for(var n=this.data,o=this.itemLength(),i=o*e,a=o*(e+r),c=n[a-2],s=n[a-1],u=0,f=0;a>i;)u=n[i++],f=n[i++],t(c,s,u,f),c=u,s=f},e}(a.Vec2Buffer);r.VertexBuffer=c},{"../math/mat2d":20,"../math/rect":23,"./vec2":5}],7:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./item"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(){return new e(new Uint8Array(4))},Object.defineProperty(e.prototype,"r",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),e}(o.Item);r.Color=i},{"./item":9}],8:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./item"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(){return new e(new Float32Array(4))},Object.defineProperty(e.prototype,"r",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),e}(o.Item);r.ColorF=i},{"./item":9}],9:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function t(t){this.data=t}return t}();r.Item=n},{}],10:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./item"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(){return new e(new Float32Array(4))},Object.defineProperty(e.prototype,"x1",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x2",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y2",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),e}(o.Item);r.Line=i},{"./item":9}],11:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./item"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(){return new e(new Float32Array(9))},Object.defineProperty(e.prototype,"c1r1",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c1r2",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c1r3",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c2r1",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c2r2",{get:function(){return this.data[4]},set:function(t){this.data[4]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c2r3",{get:function(){return this.data[5]},set:function(t){this.data[5]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c3r1",{get:function(){return this.data[6]},set:function(t){this.data[6]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c3r2",{get:function(){return this.data[7]},set:function(t){this.data[7]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c3r3",{get:function(){return this.data[8]},set:function(t){this.data[8]=t},enumerable:!0,configurable:!0}),e}(o.Item);r.Mat3=i},{"./item":9}],12:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./item"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(){return new e(new Float32Array(16))},Object.defineProperty(e.prototype,"c1r1",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c1r2",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c1r3",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c1r4",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c2r1",{get:function(){return this.data[4]},set:function(t){this.data[4]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c2r2",{get:function(){return this.data[5]},set:function(t){this.data[5]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c2r3",{get:function(){return this.data[6]},set:function(t){this.data[6]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c2r4",{get:function(){return this.data[7]},set:function(t){this.data[7]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c3r1",{get:function(){return this.data[8]},set:function(t){this.data[8]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c3r2",{get:function(){return this.data[9]},set:function(t){this.data[9]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c3r3",{get:function(){return this.data[10]},set:function(t){this.data[10]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c3r4",{get:function(){return this.data[11]},set:function(t){this.data[11]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c4r1",{get:function(){return this.data[12]},set:function(t){this.data[12]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c4r2",{get:function(){return this.data[13]},set:function(t){this.data[13]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c4r3",{get:function(){return this.data[14]},set:function(t){this.data[14]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c4r4",{get:function(){return this.data[15]},set:function(t){this.data[15]=t},enumerable:!0,configurable:!0}),e}(o.Item);r.Mat4=i},{"./item":9}],13:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./item"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(){return new e(new Float32Array(4))},Object.defineProperty(e.prototype,"left",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),e}(o.Item);r.Rect=i},{"./item":9}],14:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./item"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(){return new e(new Float32Array(2))},Object.defineProperty(e.prototype,"x",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),e}(o.Item);r.Vec2=i},{"./item":9}],15:[function(t,e,r){"use strict";function n(t){return 1==t.length?"0"+t:t}function o(t,e,r){return t>r?t:r>e?e:r}function i(t,e){return Math.floor(Math.random()*(e-t+1))+t}Object.defineProperty(r,"__esModule",{value:!0}),r.ArgbRegex=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,r.pad=n,r.clamp=o,r.randomInt=i},{}],16:[function(t,e,r){"use strict";function n(t,e,r,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),{r:t,g:e,b:r,a:n}}function o(t,e){return void 0===e&&(e=n()),e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a,e}function i(t,e,r){return void 0===r&&(r=n()),r.r=t.r+e.r,r.g=t.g+e.g,r.b=t.b+e.b,r.a=t.a+e.a,r}function a(t,e,r){return void 0===r&&(r=n()),r.r=t.r-e.r,r.g=t.g-e.g,r.b=t.b-e.b,r.a=t.a-e.a,r}function c(t,e){t.r*=e,t.g*=e,t.b*=e,t.a*=e}function s(t,e){t.r/=e,t.g/=e,t.b/=e,t.a/=e}function u(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a}function f(t,e){return t.r===e&&t.g===e&&t.b===e&&t.a===e}function h(t,e,r){return Math.abs(t.r-e.r)<=r&&Math.abs(t.g-e.g)<=r&&Math.abs(t.b-e.b)<=r&&Math.abs(t.a-e.a)<=r}function p(t,e,r){return Math.abs(t.r-e)<=r&&Math.abs(t.g-e)<=r&&Math.abs(t.b-e)<=r&&Math.abs(t.a-e)<=r}function l(t){return"{ r: "+t.r+", g: "+t.g+", b: "+t.b+", a: "+t.a+" }"}function d(t,e,r,o,i){return void 0===t&&(t=n()),t.r=e,t.g=r,t.b=o,t.a=i,t}function g(){return{r:0,g:0,b:0,a:255}}function v(){return{r:255,g:255,b:255,a:255}}function b(t){return void 0===t&&(t=g()),t.r=S.randomInt(0,255),t.g=S.randomInt(0,255),t.b=S.randomInt(0,255),t}function m(t){return 255===t.a}function y(t){return 0===t.a}function x(t,e){return void 0===e&&(e=g()),e.r=255*t.r,e.g=255*t.g,e.b=255*t.b,e.a=255*t.a,e}function _(t,e){void 0===e&&(e=g());var r=S.ArgbRegex.exec(t);return e.a=parseInt(r[1],16),e.r=parseInt(r[2],16),e.g=parseInt(r[3],16),e.b=parseInt(r[4],16),e}function P(t){var e=S.pad(t.r.toString(16)),r=S.pad(t.g.toString(16)),n=S.pad(t.b.toString(16)),o=S.pad(t.a.toString(16));return"#"+o+e+r+n}function w(t,e){void 0===e&&(e=g()),e.r=t>>24&255,e.g=t>>16&255,e.b=t>>8&255,e.a=t>>0&255}function T(t){var e=t.r<<24,r=t.g<<16,n=t.b<<8,o=t.a<<0;return(e|r|n|o)>>>0}function M(t,e,r){void 0===r&&(r=g());var n=t.a+1,o=256-t.a;return r.r=n*t.r+o*e.r>>8,r.g=n*t.g+o*e.g>>8,r.b=n*t.b+o*e.b>>8,r}function E(t,e){var r=e<<2,n=t[r++]<<24,o=t[r++]<<16,i=t[r++]<<8,a=t[r++]<<0;return(n|o|i|a)>>>0}function O(t,e,r){var n=e<<2;t[n++]=r>>24&255,t[n++]=r>>16&255,t[n++]=r>>8&255,t[n++]=r>>0&255}Object.defineProperty(r,"__esModule",{value:!0});var S=t("../math");r.create=n,r.copy=o,r.add=i,r.subtract=a,r.mulScalar=c,r.divScalar=s,r.equals=u,r.equalsScalar=f,r.epsilonEquals=h,r.epsilonEqualsScalar=p,r.stringify=l,r.rgba=d,r.black=g,r.white=v,r.random=b,r.isOpaque=m,r.isTransparent=y,r.fromColorF=x,r.fromArgbString=_,r.toArgbString=P,r.fromRgbaInt=w,r.toRgbaInt=T,r.blend=M,r.getRgba=E,r.setRgba=O},{"../math":15}],17:[function(t,e,r){"use strict";function n(t,e,r,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),{r:t,g:e,b:r,a:n}}function o(t,e){return void 0===e&&(e=n()),e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a,e}function i(t,e,r){return void 0===r&&(r=n()),r.r=t.r+e.r,r.g=t.g+e.g,r.b=t.b+e.b,r.a=t.a+e.a,r}function a(t,e,r){return void 0===r&&(r=n()),r.r=t.r-e.r,r.g=t.g-e.g,r.b=t.b-e.b,r.a=t.a-e.a,r}function c(t,e){t.r*=e,t.g*=e,t.b*=e,t.a*=e}function s(t,e){t.r/=e,t.g/=e,t.b/=e,t.a/=e}function u(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a}function f(t,e){return t.r===e&&t.g===e&&t.b===e&&t.a===e}function h(t,e,r){return Math.abs(t.r-e.r)<=r&&Math.abs(t.g-e.g)<=r&&Math.abs(t.b-e.b)<=r&&Math.abs(t.a-e.a)<=r}function p(t,e,r){return Math.abs(t.r-e)<=r&&Math.abs(t.g-e)<=r&&Math.abs(t.b-e)<=r&&Math.abs(t.a-e)<=r}function l(t){return"{ r: "+t.r+", g: "+t.g+", b: "+t.b+", a: "+t.a+" }"}function d(){return{r:0,g:0,b:0,a:1}}function g(){return{r:1,g:1,b:1,a:1}}function v(t){return void 0===t&&(t=d()),t.r=Math.random(),t.g=Math.random(),t.b=Math.random(),t}function b(t){return 1===t.a}function m(t){return 1===t.a}function y(t,e){return void 0===e&&(e=d()),e.r=t.r/255,e.g=t.g/255,e.b=t.b/255,e.a=t.a/255,e}function x(t,e){void 0===e&&(e=d());var r=M.ArgbRegex.exec(t);return e.a=parseInt(r[1],16)/255,e.r=parseInt(r[2],16)/255,e.g=parseInt(r[3],16)/255,e.b=parseInt(r[4],16)/255,e}function _(t){var e=M.pad((255*t.r).toString(16)),r=M.pad((255*t.g).toString(16)),n=M.pad((255*t.b).toString(16)),o=M.pad((255*t.a).toString(16));return"#"+o+e+r+n}function P(t,e){return void 0===e&&(e=d()),e.r=(t>>24&255)/255,e.g=(t>>16&255)/255,e.b=(t>>8&255)/255,e.a=(t>>0&255)/255,e}function w(t){var e=255*t.r<<24,r=255*t.g<<16,n=255*t.b<<8,o=255*t.a<<0;return(e|r|n|o)>>>0}function T(t){var e=t.a;t.r*=e,t.g*=e,t.b*=e}Object.defineProperty(r,"__esModule",{value:!0});var M=t("../math"),E=function(){function t(){}return t}();r.ColorF=E,r.create=n,r.copy=o,r.add=i,r.subtract=a,r.mulScalar=c,r.divScalar=s,r.equals=u,r.equalsScalar=f,r.epsilonEquals=h,r.epsilonEqualsScalar=p,r.stringify=l,r.black=d,r.white=g,r.random=v,r.isOpaque=b,r.isTransparent=m,r.fromColor=y,r.fromArgbString=x,r.toArgbString=_,r.fromRgbaInt=P,r.toRgbaInt=w,r.premultiplyAlpha=T},{"../math":15}],18:[function(t,e,r){"use strict";function n(t,e,r,n){return{rx:t,ry:e,cx:r,cy:n}}function o(t){var e=s.width(t)/2,r=s.height(t)/2,o=s.centerX(t),i=s.centerY(t);return n(e,r,o,i)}function i(t,e){return void 0===e?n(t.rx,t.ry,t.cx,t.cy):(e.rx=t.rx,e.ry=t.ry,e.cx=t.cx,e.cy=t.cy,e)}function a(t,e,r){var n=t.cx-e,o=t.cy-r,i=n/t.rx,a=o/t.ry;return 1>=i*i+a*a}function c(t,e){return a(t,e.x,e.y)}Object.defineProperty(r,"__esModule",{value:!0});var s=t("./rect");r.create=n,r.createWithBoundaries=o,r.copy=i,r.containsXY=a,r.containsPoint=c},{"./rect":23}],19:[function(t,e,r){"use strict";function n(t,e,r,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),{x1:t,y1:e,x2:r,y2:n}}function o(t,e){return void 0===e&&(e=n()),e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}function i(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}function a(t,e){return t.x1===e&&t.y1===e&&t.x2===e&&t.y2===e}function c(t,e,r){return Math.abs(t.x1-e.x1)<=r&&Math.abs(t.y1-e.y1)<=r&&Math.abs(t.x2-e.x2)<=r&&Math.abs(t.y2-e.y2)<=r}function s(t,e,r){return Math.abs(t.x1-e)<=r&&Math.abs(t.y1-e)<=r&&Math.abs(t.x2-e)<=r&&Math.abs(t.y2-e)<=r}function u(t){return"{ x1: "+t.x1+", y1: "+t.y1+", x2: "+t.x2+", y2: "+t.y2+" }"}function f(t,e,r){return r?(r.x1=t.x,r.y1=t.y,r.x2=e.x,r.y2=e.y,r):{x1:t.x,y1:t.y,x2:e.x,y2:e.y}}function h(t,e,r,n){var o=t.x1,i=t.y1,a=t.x2-o,c=t.y2-i,s=-1,u=e-o,f=r-i,h=a*u+c*f,p=a*a+c*c;if(0!=p&&(s=h/p),0>s||s>1)return!1;var l=o+s*a,d=i+s*c,g=e-l,v=r-d,b=g*g+v*v;return n*n>b}function p(t,e,r){return h(t,e.x,e.y,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.copy=o,r.equals=i,r.equalsScalar=a,r.epsilonEquals=c,r.epsilonEqualsScalar=s,r.stringify=u,r.through=f,r.containsXY=h,r.containsPoint=p},{}],20:[function(t,e,r){"use strict";function n(t,e){return void 0===e&&(e=l()),e.c1r1=t.c1r1,e.c1r2=t.c1r2,e.c2r1=t.c2r1,e.c2r2=t.c2r2,e.c3r1=t.c3r1,e.c3r2=t.c3r2,e}function o(t,e,r){return void 0===r&&(r=l()),r.c1r1=t.c1r1+e.c1r1,r.c1r2=t.c1r2+e.c1r2,r.c2r1=t.c2r1+e.c2r1,r.c2r2=t.c2r2+e.c2r2,r.c3r1=t.c3r1+e.c3r1,r.c3r2=t.c3r2+e.c3r2,r}function i(t,e,r){return void 0===r&&(r=l()),r.c1r1=t.c1r1-e.c1r1,r.c1r2=t.c1r2-e.c1r2,r.c2r1=t.c2r1-e.c2r1,r.c2r2=t.c2r2-e.c2r2,r.c3r1=t.c3r1-e.c3r1,r.c3r2=t.c3r2-e.c3r2,r}function a(t,e){t.c1r1*=e,t.c1r2*=e,t.c2r1*=e,t.c2r2*=e,t.c3r1*=e,t.c3r2*=e}function c(t,e){t.c1r1/=e,t.c1r2/=e,t.c2r1/=e,t.c2r2/=e,t.c3r1/=e,t.c3r2/=e}function s(t,e){return t.c1r1===e.c1r1&&t.c1r2===e.c1r2&&t.c2r1===e.c2r1&&t.c2r2===e.c2r2&&t.c3r1===e.c3r1&&t.c3r2===e.c3r2}function u(t,e){return t.c1r1===e&&t.c1r2===e&&t.c2r1===e&&t.c2r2===e&&t.c3r1===e&&t.c3r2===e}function f(t,e,r){return Math.abs(t.c1r1-e.c1r1)<=r&&Math.abs(t.c1r2-e.c1r2)<=r&&Math.abs(t.c2r1-e.c2r1)<=r&&Math.abs(t.c2r2-e.c2r2)<=r&&Math.abs(t.c3r1-e.c3r1)<=r&&Math.abs(t.c3r2-e.c3r2)<=r}function h(t,e,r){return Math.abs(t.c1r1-e)<=r&&Math.abs(t.c1r2-e)<=r&&Math.abs(t.c2r1-e)<=r&&Math.abs(t.c2r2-e)<=r&&Math.abs(t.c3r1-e)<=r&&Math.abs(t.c3r2-e)<=r}function p(t){return"{ c1r1: "+t.c1r1+", c1r2: "+t.c1r2+", c2r1: "+t.c2r1+", c2r2: "+t.c2r2+", c3r1: "+t.c3r1+", c3r2: "+t.c3r2+" }"}function l(){return{c1r1:0,c2r1:0,c3r1:0,c1r2:0,c2r2:0,c3r2:0}}function d(t){return t.c1r1*t.c2r2-t.c2r1*t.c1r2}function g(t,e,r){void 0===r&&(r=l());var n=t.c1r1*e.c1r1+t.c2r1*e.c1r2,o=t.c1r1*e.c2r1+t.c2r1*e.c2r2,i=t.c1r1*e.c3r1+t.c2r1*e.c3r2+t.c3r1,a=t.c1r2*e.c1r1+t.c2r2*e.c1r2,c=t.c1r2*e.c2r1+t.c2r2*e.c2r2,s=t.c1r2*e.c3r1+t.c2r2*e.c3r2+t.c3r2;return r.c1r1=n,r.c2r1=o,r.c3r1=i,r.c1r2=a,r.c2r2=c,r.c3r2=s,r}function v(t){return void 0===t&&(t=l()),t.c1r1=1,t.c2r1=0,t.c3r1=0,t.c1r2=0,t.c2r2=1,t.c3r2=0,t}function b(t,e,r,n){void 0===t&&(t=l());var o,i;switch(n){case 0:o=X.center(e),i=X.center(r);break;case 1:o=X.bottomRight(e),i=X.bottomRight(r);break;default:o=X.topLeft(e),i=X.topLeft(r)}var a=X.width(r)/X.width(e),c=X.height(r)/X.height(e);return E(t,-o.x,-o.y),2===n?j(t,a,c):B(t,Math.min(a,c)),F(t,i.x,i.y),t}function m(t,e,r){void 0===t&&(t=l());var n=Math.sin(e),o=Math.cos(e);return x(t,n,o,r)}function y(t,e,r,n){void 0===t&&(t=l());var o=n?Y.subtract(e,n):Y.copy(e),i=n?Y.subtract(r,n):Y.copy(r);Y.normalize(o),Y.normalize(i);var a=Y.cross(o,i),c=Y.dot(o,i);return x(t,a,c,n)}function x(t,e,r,n){return void 0===t&&(t=l()),t.c1r1=r,t.c2r1=-e,t.c3r1=0,t.c1r2=e,t.c2r2=r,t.c3r2=0,n&&S(t,n.x,n.y),t}function _(t,e,r,n){return void 0===t&&(t=l()),t.c1r1=e,t.c2r1=0,t.c3r1=0,t.c1r2=0,t.c2r2=r,t.c3r2=0,n&&S(t,n.x,n.y),t}function P(t,e,r,n){void 0===t&&(t=l());var o=n?(r.x-n.x)/(e.x-n.x):r.x/e.x,i=n?(r.y-n.y)/(e.y-n.y):r.y/e.y;return _(t,o,i,n)}function w(t,e,r){return void 0===t&&(t=l()),_(t,e,e,r)}function T(t,e,r,n){void 0===t&&(t=l());var o=V.distance(e,n),i=V.distance(r,n),a=i/o;return w(t,a,n)}function M(t,e,r,n){void 0===t&&(t=l());var o=n?Y.subtract(e,n):Y.copy(e),i=n?Y.subtract(r,n):Y.copy(r),a=Y.length(o),c=Y.length(i),s=c/a;Y.divScalar(o,a),Y.divScalar(i,c);var u=Y.cross(o,i),f=Y.dot(o,i);return x(t,u,f),B(t,s),n&&S(t,n.x,n.y),t}function E(t,e,r){return void 0===t&&(t=l()),t.c1r1=1,t.c2r1=0,t.c3r1=e,t.c1r2=0,t.c2r2=1,t.c3r2=r,t}function O(t,e,r){void 0===t&&(t=l()),E(t,r.x-e.x,r.y-e.y)}function S(t,e,r){H(t,-e,-r),F(t,e,r)}function A(t,e){void 0===e&&(e=l());var r=1/d(t),n=t.c1r1,o=t.c2r1,i=t.c3r1,a=t.c1r2,c=t.c2r2,s=t.c3r2;return e.c1r1=c*r,e.c2r1=-o*r,e.c3r1=(o*s-i*c)*r,e.c1r2=-a*r,e.c2r2=n*r,e.c3r2=(a*i-n*s)*r,e}function R(t,e){var r=Math.cos(e),n=Math.sin(e),o=t.c1r1,i=t.c2r1,a=t.c3r1;t.c1r1=n*o-r*t.c1r2,t.c2r1=n*i-r*t.c2r2,t.c3r1=n*a-r*t.c3r2,t.c1r2=r*o+n*t.c1r2,t.c2r2=r*i+n*t.c2r2,t.c3r2=r*a+r*t.c3r2}function C(t,e){var r=Math.cos(e),n=Math.sin(e),o=t.c1r1,i=t.c1r2;t.c1r1=o*n+t.c2r1*r,t.c1r2=i*n+t.c2r2*r,t.c2r1=o*-r+t.c2r1*n,t.c2r2=i*-r+t.c2r2*n}function j(t,e,r){t.c1r1*=e,t.c2r1*=e,t.c3r1*=e,t.c1r2*=r,t.c2r2*=r,t.c3r2*=r}function I(t,e,r){t.c1r1*=e,t.c1r2*=e,t.c2r1*=r,t.c2r2*=r}function B(t,e){j(t,e,e)}function L(t,e){I(t,e,e)}function F(t,e,r){t.c3r1+=e,t.c3r2+=r}function H(t,e,r){t.c3r1+=t.c1r1*e+t.c2r1*r,t.c3r2+=t.c1r2*e+t.c2r2*r}function q(t,e,r){return t.c1r1*e+t.c2r1*r+t.c3r1}function D(t,e,r){return t.c1r2*e+t.c2r2*r+t.c3r2}function U(t,e,r,n){return void 0===n&&(n=V.create()),n.x=q(t,e,r),n.y=D(t,e,r),n}function k(t,e,r){return void 0===r&&(r=V.create()),U(t,e.x,e.y,r)}function G(t,e,r,n,o,i){for(void 0===o&&(o=e),
void 0===i&&(i=r);n--;){var a=e[r++],c=e[r++];o[i++]=q(t,a,c),o[i++]=D(t,a,c)}}function N(t,e,r){void 0===r&&(r=X.create());var n=U(t,e.left,e.top),o=U(t,e.left,e.bottom),i=U(t,e.right,e.bottom),a=U(t,e.right,e.top);return r.left=r.right=n.x,r.top=r.bottom=n.y,X.unionPoint(r,o),X.unionPoint(r,i),X.unionPoint(r,a),r}Object.defineProperty(r,"__esModule",{value:!0});var V=t("./point"),Y=t("./vec2"),X=t("./rect");r.copy=n,r.add=o,r.subtract=i,r.mulScalar=a,r.divScalar=c,r.equals=s,r.equalsScalar=u,r.epsilonEquals=f,r.epsilonEqualsScalar=h,r.stringify=p,r.create=l,r.determinant=d,r.concat=g,r.identity=v,r.rectToRect=b,r.rotate=m,r.rotateToPoint=y,r.sinCos=x,r.scale=_,r.scaleToPoint=P,r.stretch=w,r.stretchToPoint=T,r.stretchRotateToPoint=M,r.translate=E,r.translateToPoint=O,r.conjugateByTranslation=S,r.invert=A,r.postRotate=R,r.preRotate=C,r.postScale=j,r.preScale=I,r.postStretch=B,r.preStretch=L,r.postTranslate=F,r.preTranslate=H,r.mapX=q,r.mapY=D,r.mapXY=U,r.mapPoint=k,r.mapPoints=G,r.mapRect=N},{"./point":22,"./rect":23,"./vec2":24}],21:[function(t,e,r){"use strict";function n(){return{c1r1:0,c1r2:0,c1r3:0,c1r4:0,c2r1:0,c2r2:0,c2r3:0,c2r4:0,c3r1:0,c3r2:0,c3r3:0,c3r4:0,c4r1:0,c4r2:0,c4r3:0,c4r4:0}}function o(t,e){return void 0===e&&(e=n()),e.c1r1=t.c1r1,e.c1r2=t.c1r2,e.c1r3=t.c1r3,e.c1r4=t.c1r4,e.c2r1=t.c2r1,e.c2r2=t.c2r2,e.c2r3=t.c2r3,e.c2r4=t.c2r4,e.c3r1=t.c3r1,e.c3r2=t.c3r2,e.c3r3=t.c3r3,e.c3r4=t.c3r4,e.c4r1=t.c4r1,e.c4r2=t.c4r2,e.c4r3=t.c4r3,e.c4r4=t.c4r4,e}function i(t,e,r){return void 0===r&&(r=n()),r.c1r1=t.c1r1+e.c1r1,r.c1r2=t.c1r2+e.c1r2,r.c1r3=t.c1r3+e.c1r3,r.c1r4=t.c1r4+e.c1r4,r.c2r1=t.c2r1+e.c2r1,r.c2r2=t.c2r2+e.c2r2,r.c2r3=t.c2r3+e.c2r3,r.c2r4=t.c2r4+e.c2r4,r.c3r1=t.c3r1+e.c3r1,r.c3r2=t.c3r2+e.c3r2,r.c3r3=t.c3r3+e.c3r3,r.c3r4=t.c3r4+e.c3r4,r.c4r1=t.c4r1+e.c4r1,r.c4r2=t.c4r2+e.c4r2,r.c4r3=t.c4r3+e.c4r3,r.c4r4=t.c4r4+e.c4r4,r}function a(t,e,r){return void 0===r&&(r=n()),r.c1r1=t.c1r1-e.c1r1,r.c1r2=t.c1r2-e.c1r2,r.c1r3=t.c1r3-e.c1r3,r.c1r4=t.c1r4-e.c1r4,r.c2r1=t.c2r1-e.c2r1,r.c2r2=t.c2r2-e.c2r2,r.c2r3=t.c2r3-e.c2r3,r.c2r4=t.c2r4-e.c2r4,r.c3r1=t.c3r1-e.c3r1,r.c3r2=t.c3r2-e.c3r2,r.c3r3=t.c3r3-e.c3r3,r.c3r4=t.c3r4-e.c3r4,r.c4r1=t.c4r1-e.c4r1,r.c4r2=t.c4r2-e.c4r2,r.c4r3=t.c4r3-e.c4r3,r.c4r4=t.c4r4-e.c4r4,r}function c(t,e){t.c1r1*=e,t.c1r2*=e,t.c1r3*=e,t.c1r4*=e,t.c2r1*=e,t.c2r2*=e,t.c2r3*=e,t.c2r4*=e,t.c3r1*=e,t.c3r2*=e,t.c3r3*=e,t.c3r4*=e,t.c4r1*=e,t.c4r2*=e,t.c4r3*=e,t.c4r4*=e}function s(t,e){t.c1r1/=e,t.c1r2/=e,t.c1r3/=e,t.c1r4/=e,t.c2r1/=e,t.c2r2/=e,t.c2r3/=e,t.c2r4/=e,t.c3r1/=e,t.c3r2/=e,t.c3r3/=e,t.c3r4/=e,t.c4r1/=e,t.c4r2/=e,t.c4r3/=e,t.c4r4/=e}function u(t,e){return t.c1r1===e.c1r1&&t.c1r2===e.c1r2&&t.c1r3===e.c1r3&&t.c1r4===e.c1r4&&t.c2r1===e.c2r1&&t.c2r2===e.c2r2&&t.c2r3===e.c2r3&&t.c2r4===e.c2r4&&t.c3r1===e.c3r1&&t.c3r2===e.c3r2&&t.c3r3===e.c3r3&&t.c3r4===e.c3r4&&t.c4r1===e.c4r1&&t.c4r2===e.c4r2&&t.c4r3===e.c4r3&&t.c4r4===e.c4r4}function f(t,e){return t.c1r1===e&&t.c1r2===e&&t.c1r3===e&&t.c1r4===e&&t.c2r1===e&&t.c2r2===e&&t.c2r3===e&&t.c2r4===e&&t.c3r1===e&&t.c3r2===e&&t.c3r3===e&&t.c3r4===e&&t.c4r1===e&&t.c4r2===e&&t.c4r3===e&&t.c4r4===e}function h(t,e,r){return Math.abs(t.c1r1-e.c1r1)<=r&&Math.abs(t.c1r2-e.c1r2)<=r&&Math.abs(t.c1r3-e.c1r3)<=r&&Math.abs(t.c1r4-e.c1r4)<=r&&Math.abs(t.c2r1-e.c2r1)<=r&&Math.abs(t.c2r2-e.c2r2)<=r&&Math.abs(t.c2r3-e.c2r3)<=r&&Math.abs(t.c2r4-e.c2r4)<=r&&Math.abs(t.c3r1-e.c3r1)<=r&&Math.abs(t.c3r2-e.c3r2)<=r&&Math.abs(t.c3r3-e.c3r3)<=r&&Math.abs(t.c3r4-e.c3r4)<=r&&Math.abs(t.c4r1-e.c4r1)<=r&&Math.abs(t.c4r2-e.c4r2)<=r&&Math.abs(t.c4r3-e.c4r3)<=r&&Math.abs(t.c4r4-e.c4r4)<=r}function p(t,e,r){return Math.abs(t.c1r1-e)<=r&&Math.abs(t.c1r2-e)<=r&&Math.abs(t.c1r3-e)<=r&&Math.abs(t.c1r4-e)<=r&&Math.abs(t.c2r1-e)<=r&&Math.abs(t.c2r2-e)<=r&&Math.abs(t.c2r3-e)<=r&&Math.abs(t.c2r4-e)<=r&&Math.abs(t.c3r1-e)<=r&&Math.abs(t.c3r2-e)<=r&&Math.abs(t.c3r3-e)<=r&&Math.abs(t.c3r4-e)<=r&&Math.abs(t.c4r1-e)<=r&&Math.abs(t.c4r2-e)<=r&&Math.abs(t.c4r3-e)<=r&&Math.abs(t.c4r4-e)<=r}function l(t){return"{ c1r1: "+t.c1r1+", c1r2: "+t.c1r2+", c1r3: "+t.c1r3+", c1r4: "+t.c1r4+", c2r1: "+t.c2r1+", c2r2: "+t.c2r2+", c2r3: "+t.c2r3+", c2r4: "+t.c2r4+", c3r1: "+t.c3r1+", c3r2: "+t.c3r2+", c3r3: "+t.c3r3+", c3r4: "+t.c3r4+", c4r1: "+t.c4r1+", c4r2: "+t.c4r2+", c4r3: "+t.c4r3+", c4r4: "+t.c4r4+" }"}function d(t,e,r,o,i,a,c){void 0===t&&(t=n());var s=r-e,u=i-o,f=a-c;return t.c1r1=2/s,t.c1r2=0,t.c1r3=0,t.c1r4=0,t.c2r1=0,t.c2r2=2/u,t.c2r3=0,t.c2r4=0,t.c3r1=0,t.c3r2=0,t.c3r3=1/f,t.c3r4=0,t.c4r1=-(r+e)/s,t.c4r2=-(i+o)/u,t.c4r3=-a/f,t.c4r4=1,t}Object.defineProperty(r,"__esModule",{value:!0});var g=function(){function t(){}return t}();r.Mat4=g,r.create=n,r.copy=o,r.add=i,r.subtract=a,r.mulScalar=c,r.divScalar=s,r.equals=u,r.equalsScalar=f,r.epsilonEquals=h,r.epsilonEqualsScalar=p,r.stringify=l,r.ortho=d},{}],22:[function(t,e,r){"use strict";function n(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),{x:t,y:e}}function o(t){return{x:t.x,y:t.y}}function i(t,e,r){return void 0===r&&(r=n()),r.x=t.x+e.x,r.y=t.y+e.y,r}function a(t,e,r){return void 0===r&&(r=n()),r.x=t.x-e.x,r.y=t.y-e.y,r}function c(t,e,r){return void 0===r&&(r=n()),r.x=.5*(t.x+e.x),r.y=.5*(t.y+e.y),r}function s(t,e){return Math.sqrt(u(t,e))}function u(t,e){var r=e?e.x-t.x:t.x,n=e?e.y-t.y:t.y;return r*r+n*n}Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.copy=o,r.add=i,r.subtract=a,r.midpoint=c,r.distance=s,r.distance2=u},{}],23:[function(t,e,r){"use strict";function n(t,e){return void 0===e&&(e=l()),e.left=t.left,e.top=t.top,e.right=t.right,e.bottom=t.bottom,e}function o(t,e,r){return void 0===r&&(r=l()),r.left=t.left+e.left,r.top=t.top+e.top,r.right=t.right+e.right,r.bottom=t.bottom+e.bottom,r}function i(t,e,r){return void 0===r&&(r=l()),r.left=t.left-e.left,r.top=t.top-e.top,r.right=t.right-e.right,r.bottom=t.bottom-e.bottom,r}function a(t,e){t.left*=e,t.top*=e,t.right*=e,t.bottom*=e}function c(t,e){t.left/=e,t.top/=e,t.right/=e,t.bottom/=e}function s(t,e){return t.left===e.left&&t.top===e.top&&t.right===e.right&&t.bottom===e.bottom}function u(t,e){return t.left===e&&t.top===e&&t.right===e&&t.bottom===e}function f(t,e,r){return Math.abs(t.left-e.left)<=r&&Math.abs(t.top-e.top)<=r&&Math.abs(t.right-e.right)<=r&&Math.abs(t.bottom-e.bottom)<=r}function h(t,e,r){return Math.abs(t.left-e)<=r&&Math.abs(t.top-e)<=r&&Math.abs(t.right-e)<=r&&Math.abs(t.bottom-e)<=r}function p(t){return"{ left: "+t.left+", top: "+t.top+", right: "+t.right+", bottom: "+t.bottom+" }"}function l(){return{left:0,top:0,right:0,bottom:0}}function d(t,e,r,n,o){return void 0===t&&(t=l()),t.left=e,t.top=r,t.right=n,t.bottom=o,t}function g(t,e,r,n,o){return void 0===t&&(t=l()),t.left=e,t.top=o,t.right=n,t.bottom=r,t}function v(t,e,r,n,o){return void 0===t&&(t=l()),t.left=e,t.top=o,t.right=r,t.bottom=n,t}function b(t,e,r,n,o){return void 0===t&&(t=l()),t.left=e,t.top=r,t.right=e+n,t.bottom=r-o,t}function m(t,e,r,n,o){return void 0===t&&(t=l()),t.left=e,t.top=r+o,t.right=e+n,t.bottom=r,t}function y(t){return t.left>=t.right||t.bottom>=t.top}function x(t){return t.right>=t.left&&t.top>=t.bottom}function _(t){return t.right-t.left}function P(t){return t.top-t.bottom}function w(t){return _(t)*P(t)}function T(t){return.5*(t.left+t.right)}function M(t){return.5*(t.bottom+t.top)}function E(t){return tt.create(T(t),M(t))}function O(t){return tt.create(T(t),t.top)}function S(t){return tt.create(T(t),t.bottom)}function A(t){return tt.create(t.left,M(t))}function R(t){return tt.create(t.left,M(t))}function C(t){return tt.create(t.left,t.bottom)}function j(t){return tt.create(t.right,t.bottom)}function I(t){return tt.create(t.left,t.top)}function B(t){return tt.create(t.right,t.top)}function L(t){t.left=0,t.top=0,t.right=0,t.bottom=0}function F(t,e,r){return void 0===t&&(t=l()),t.left=t.right=e.x,t.top=t.bottom=e.y,N(t,r),t}function H(t,e,r,n){return void 0===t&&(t=l()),t.left=t.right=e[r++],t.top=t.bottom=e[r++],Y(t,e,r,n-1),t}function q(t,e){return t.left<=e.left&&e.right<=t.right&&t.bottom<=e.bottom&&e.top<=t.top}function D(t,e,r){return t.left<=e&&e<=t.right&&t.bottom<=r&&r<=t.top}function U(t,e){return t.right>=e.left&&e.right>=t.left&&t.top>=e.bottom&&e.top>=t.bottom}function k(t,e,r){return void 0===r&&(r=l()),r.left=Math.max(t.left,e.left),r.right=Math.min(t.right,e.right),r.bottom=Math.max(t.bottom,e.bottom),r.top=Math.min(t.top,e.top),r}function G(t,e,r){return void 0===r&&(r=l()),r.left=Math.max(t.left,e.left),r.right=Math.min(t.right,e.right),r.bottom=Math.max(t.bottom,e.bottom),r.top=Math.min(t.top,e.top),r}function N(t,e){V(t,e.x,e.y)}function V(t,e,r){t.left=Math.min(e,t.left),t.top=Math.max(r,t.top),t.right=Math.max(e,t.right),t.bottom=Math.min(r,t.bottom)}function Y(t,e,r,n){for(;n--;)V(t,e[r++],e[r++])}function X(t,e,r){t.left+=e,t.top-=r,t.right-=e,t.bottom+=r}function W(t,e,r){t.left+=e,t.top+=r,t.right+=e,t.bottom+=r}function $(t,e,r){var n=T(t),o=M(t);W(t,-n,-o),t.left*=e,t.right*=e,t.bottom*=r,t.top*=r,W(t,n,o)}function z(t,e){$(t,e,e)}function Z(t){var e=_(t),r=P(t);r>e?$(t,1,e/r):e>r&&$(t,r/e,1)}function K(t){var e=_(t),r=P(t);r>e?$(t,r/e,1):e>r&&$(t,1,e/r)}function J(t){if(t.bottom>t.top){var e=t.top;t.top=t.bottom,t.bottom=e}if(t.left>t.right){var r=t.right;t.right=t.left,t.left=r}}function Q(t){return"{ left: "+t.left+", top: "+t.top+", right: "+t.right+", bottom: "+t.bottom+" }"}Object.defineProperty(r,"__esModule",{value:!0});var tt=t("./point");r.copy=n,r.add=o,r.subtract=i,r.mulScalar=a,r.divScalar=c,r.equals=s,r.equalsScalar=u,r.epsilonEquals=f,r.epsilonEqualsScalar=h,r.stringify=p,r.create=l,r.ltrb=d,r.lbrt=g,r.lrbt=v,r.ltwh=b,r.createLBWH=m,r.isEmpty=y,r.isValid=x,r.width=_,r.height=P,r.area=w,r.centerX=T,r.centerY=M,r.center=E,r.centerTop=O,r.centerBottom=S,r.centerLeft=A,r.centerRight=R,r.bottomLeft=C,r.bottomRight=j,r.topLeft=I,r.topRight=B,r.empty=L,r.unionOfTwoPoints=F,r.unionOfPoints=H,r.contains=q,r.containsXY=D,r.intersects=U,r.intersect=k,r.union=G,r.unionPoint=N,r.unionXY=V,r.unionPoints=Y,r.inset=X,r.offset=W,r.scale=$,r.stretch=z,r.shrinkToSquare=Z,r.expandToSquare=K,r.sort=J,r.toString=Q},{"./point":22}],24:[function(t,e,r){"use strict";function n(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),{x:t,y:e}}function o(t,e){return void 0===e&&(e=n()),e.x=t.x,e.y=t.y,e}function i(t,e,r){return void 0===r&&(r=n()),r.x=t.x+e.x,r.y=t.y+e.y,r}function a(t,e,r){return void 0===r&&(r=n()),r.x=t.x-e.x,r.y=t.y-e.y,r}function c(t,e){t.x*=e,t.y*=e}function s(t,e){t.x/=e,t.y/=e}function u(t,e){return t.x===e.x&&t.y===e.y}function f(t,e){return t.x===e&&t.y===e}function h(t,e,r){return Math.abs(t.x-e.x)<=r&&Math.abs(t.y-e.y)<=r}function p(t,e,r){return Math.abs(t.x-e)<=r&&Math.abs(t.y-e)<=r}function l(t){return"{ x: "+t.x+", y: "+t.y+" }"}function d(t){return Math.sqrt(g(t))}function g(t){return t.x*t.x+t.y*t.y}function v(t,e){return t.x*e.x+t.y*e.y}function b(t,e){return t.x*e.y-e.x*t.y}function m(t){s(t,d(t))}function y(t){var e=t.x;t.x=-t.y,t.y=e}function x(t){var e=t.x;t.x=t.y,t.y=-e}Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.copy=o,r.add=i,r.subtract=a,r.mulScalar=c,r.divScalar=s,r.equals=u,r.equalsScalar=f,r.epsilonEquals=h,r.epsilonEqualsScalar=p,r.stringify=l,r.length=d,r.length2=g,r.dot=v,r.cross=b,r.normalize=m,r.rotateLeft=y,r.rotateRight=x},{}],25:[function(t,e,r){"use strict";function n(t){return new u.VertexBuffer(new Float32Array([t.left,t.top,t.left,t.bottom,t.right,t.bottom,t.right,t.top]))}function o(t,e){void 0===e&&(e=1);var r=u.VertexBuffer.create(t),n=f.Vec2.create();n.y=e,r.putItem(n);for(var o=h.rotate(void 0,2*Math.PI/t);r.hasValidPosition();)h.mapPoint(o,n,n),r.putItem(n);return r}function i(t){for(var e=s.TriangleIndicesBuffer.create(t-2),r=1,n=2;e.hasValidPosition();)e.put(0,r,n),r=n++;return e}function a(t,e,r){var n=u.VertexBuffer.create(t+t),o=2*Math.PI/t,i=h.create(),a=f.Vec2.create();a.y=r;var c=f.Vec2.create();for(c.y=e,h.rotate(i,.5*o),h.mapPoint(i,c,c),n.putItem(a),n.putItem(c),h.rotate(i,o);n.hasValidPosition();)h.mapPoint(i,a,a),h.mapPoint(i,c,c),n.putItem(a),n.putItem(c);return n}function c(t){for(var e=t-2,r=t,n=s.TriangleIndicesBuffer.create(e+r),o=1,i=3,a=5;e--;)n.put(o,i,a),i=a++,a++;for(o=2*t-1,i=0,a=1;r--;)n.put(o,i,a),o=a++,i=a++;return n}Object.defineProperty(r,"__esModule",{value:!0});var s=t("./buffer/triangleIndices"),u=t("./buffer/vertices"),f=t("./buffered/vec2"),h=t("./math/mat2d"),p=t("./math/rect"),l=function(){function t(t,e,r,n,o){void 0===r&&(r=t.calculateBounds()),void 0===n&&(n=p.centerTop(r)),void 0===o&&(o=p.centerBottom(r)),this.elementBufferOffset=0,this.vertexBufferOffset=0,this.vertices=t,this.indices=e,this.fixedPoint=n,this.controlPoint=o,this.bounds=r}return t.fromSource=function(e){var r=new u.VertexBuffer(e.vertices),n=e.indices?new s.TriangleIndicesBuffer(e.indices):i(r.capacity());return new t(r,n)},t.polygon=function(e){var r=o(e),n=i(e);return new t(r,n)},t.star=function(e,r,n){var o=a(e,r,n),i=c(e);return new t(o,i)},t.diamond=function(){return t.star(2,.5,1)},t.square=function(){return t.rectangle(p.ltrb(void 0,0,1,1,0))},t.rectangle=function(e){var r=n(e),o=i(4);return new t(r,o,e)},t.star5=function(){return t.star(5,.4,1)},t.prototype.containsXY=function(t,e){return p.containsXY(this.bounds,t,e)&&this.vertices.contains(t,e)},t.prototype.containsPoint=function(t){return this.containsXY(t.x,t.y)},t}();r.Model=l,r.rectVertices=n,r.polygonVertices=o,r.polygonIndices=i,r.starVertices=a,r.starIndices=c},{"./buffer/triangleIndices":4,"./buffer/vertices":6,"./buffered/vec2":14,"./math/mat2d":20,"./math/rect":23}],26:[function(t,e,r){"use strict";function n(t,e){return o(t,i(t,e))}function o(t,e){for(var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o={},i=0;r>i;i++){var a=t.getActiveUniform(e,i).name;o[a]=t.getUniformLocation(e,a)}for(var c={},i=0;n>i;i++){var s=t.getActiveAttrib(e,i).name;c[s]=t.getAttribLocation(e,s)}return{location:e,uniforms:o,attribs:c}}function i(t,e){var r=c(t,e.vs,t.VERTEX_SHADER),n=c(t,e.fs,t.FRAGMENT_SHADER);return a(t,r,n)}function a(t,e,r){var n=t.createProgram();t.attachShader(n,e),t.attachShader(n,r),t.linkProgram(n);var o=t.getProgramParameter(n,t.LINK_STATUS);if(!o)throw"program filed to link:"+t.getProgramInfoLog(n);return n}function c(t,e,r){var n=t.createShader(r);t.shaderSource(n,e),t.compileShader(n);var o=t.getShaderParameter(n,t.COMPILE_STATUS);if(!o)throw"could not compile shader:"+t.getShaderInfoLog(n);return n}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){this.location=t.location,this.uniforms=t.uniforms,this.attribs=t.attribs,this.bindings=e}return t}();r.Program=s,r.createProgramInfo=n,r.extractProgramInfo=o,r.createProgramFromSourceCode=i,r.createProgramFromShaders=a,r.compileShader=c},{}],27:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../math/vec2"),o=t("../math/rect"),i=t("../buffered/mat4"),a=t("../math/mat4"),c=function(){function t(t,e,r){this.region=o.create(),this.matrix=i.Mat4.create(),this.zoom=1,this.pan=n.create(),this.bounds=t,this.minZoom=e,this.maxZoom=r}return t.prototype.fillViewport=function(t,e){var r=this,n=r.bounds,i=r.region,a=r.zoom,c=r.pan;o.copy(n,i);var s=o.width(n),u=o.height(n),f=t/e,h=s/u;f>h?o.scale(i,f/h,1):o.scale(i,1,h/f),o.stretch(i,1/a),o.offset(i,c.x,c.y),this.applyChangesToMatrix()},t.prototype.panByVector=function(t){this.applyChangeInPan(t),this.applyChangesToMatrix()},t.prototype.zoomToPoint=function(t,e){var r=this.region,i=(e.x-r.left)/o.width(r),a=(e.y-r.bottom)/o.height(r);this.applyChangeInZoom(t);var c=n.create();c.x=r.left+i*o.width(r),c.y=r.bottom+a*o.height(r);var s=n.subtract(e,c);this.applyChangeInPan(s),this.applyChangesToMatrix()},t.prototype.applyChangeInZoom=function(t){var e=this.zoom*t;return e<this.minZoom?(t=this.minZoom/this.zoom,this.zoom=this.minZoom):e>this.maxZoom?(t=this.maxZoom/this.zoom,this.zoom=this.maxZoom):this.zoom=e,o.stretch(this.region,1/t),t},t.prototype.applyChangeInPan=function(t){var e=n.add(this.pan,t),r=o.copy(this.bounds);return o.mulScalar(r,(this.zoom-this.minZoom)/this.zoom),o.offset(r,-o.centerX(r),-o.centerY(r)),e.x<r.left?t.x=r.left-this.pan.x:e.x>r.right&&(t.x=r.right-this.pan.x),e.y<r.bottom?t.y=r.bottom-this.pan.y:e.y>r.top&&(t.y=r.top-this.pan.y),o.offset(this.region,t.x,t.y),n.add(this.pan,t,this.pan),t},t.prototype.applyChangesToMatrix=function(){var t=this,e=t.matrix,r=t.region;a.ortho(e,r.left,r.right,r.bottom,r.top,.1,10)},t}();r.Projection=c},{"../buffered/mat4":12,"../math/mat4":21,"../math/rect":23,"../math/vec2":24}],28:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function t(t,e,r,n){this.needToRender=!1,this.gl=t,this.projection=e,this.programs=r,this.drawables=n}return t.prototype.onSurfaceChanged=function(t,e){this.gl.viewport(0,0,t,e),this.projection.fillViewport(t,e),this.needToRender=!0},t.prototype.useProgram=function(t){this.currentProgram!==t&&(t.bind(this.gl),this.currentProgram=t)},t}();r.Renderer=n},{}],29:[function(t,e,r){"use strict";function n(t,e,r,n){function o(t,r){return{src:t,status:r,pointers:[e.screenToWorld(t)]}}function i(t,e){return{src:t,status:e,pointers:a(t)}}function a(t){for(var r=[],n=t.touches,o=0;o<n.length;o++)r[o]=e.screenToWorld(n[o]);return r}var c=!1;t.addEventListener("mousedown",function(t){t.target===e.canvas&&(c=!0,t.preventDefault(),t.stopPropagation(),r(o(t,0)))},!1),t.addEventListener("mousemove",function(t){c&&(t.preventDefault(),t.stopPropagation(),r(o(t,1)))},!1),t.addEventListener("mouseout",function(t){c&&(t.preventDefault(),t.stopPropagation(),r(o(t,3)))},!1),t.addEventListener("mouseup",function(t){c&&(t.preventDefault(),t.stopPropagation(),c=!1,r(o(t,2)))},!1),t.addEventListener("touchstart",function(t){t.target===e.canvas&&(c=!0,t.preventDefault(),t.stopPropagation(),n(i(t,0)))},!1),t.addEventListener("touchmove",function(t){c&&(t.preventDefault(),t.stopPropagation(),n(i(t,1)))},!1),t.addEventListener("touchleave",function(t){c&&(t.preventDefault(),t.stopPropagation(),n(i(t,3)))},!1),t.addEventListener("touchend",function(t){c&&(t.preventDefault(),t.stopPropagation(),c=!1,n(i(t,2)))},!1)}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../math/rect"),i=t("../math/point"),a=function(){function t(t,e){this.canvas=t,this.renderer=e,this.renderer.onSurfaceCreated()}return t.prototype.requestRender=function(){this.renderer.needToRender=!0},t.prototype.resize=function(t,e){return this.canvas.width!==t||this.canvas.height!==e?(this.canvas.width=t,this.canvas.height=e,this.bb=this.canvas.getBoundingClientRect(),this.renderer.onSurfaceChanged(t,e),!0):!1},t.prototype.screenToCanvas=function(t,e){return void 0===e&&(e=i.create()),e.x=t.clientX-this.bb.left,e.y=t.clientY-this.bb.top,e},t.prototype.screenToNdc=function(t,e){return void 0===e&&(e=i.create()),this.screenToCanvas(t,e),this.canvasToNdc(e,e),e},t.prototype.screenToWorld=function(t,e){return void 0===e&&(e=i.create()),this.screenToCanvas(t,e),this.canvasToNdc(e,e),this.ndcToWorld(e,e),e},t.prototype.canvasToNdc=function(t,e){void 0===e&&(e=i.create());var r=this.bb.width,n=this.bb.height;return e.x=t.x/r,e.y=(n-t.y)/n,e},t.prototype.ndcToWorld=function(t,e){void 0===e&&(e=i.create());var r=this.renderer.projection.region;return e.x=r.left+t.x*o.width(r),e.y=r.bottom+t.y*o.height(r),e},t}();r.Surface=a,r.addSurfaceListener=n},{"../math/point":22,"../math/rect":23}],30:[function(t,e,r){"use strict";function n(t,e,r){void 0===r&&(r=t.STATIC_DRAW);var n=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,e,r),n}function o(t,e,r){void 0===r&&(r=t.STATIC_DRAW);var n=t.createBuffer();return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,r),n}Object.defineProperty(r,"__esModule",{value:!0}),r.createArrayBuffer=n,r.createElementBuffer=o},{}],31:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./buffered/mat3"),o=t("./math/vec2"),i=t("./math/mat2d"),a=function(){function t(t,e){this.model=t,e?(this.matrix=e,this.inverse=n.Mat3.create(),i.invert(this.matrix,this.inverse)):(this.matrix=n.Mat3.create(),this.inverse=n.Mat3.create(),i.identity(this.matrix),i.identity(this.inverse))}return t.prototype.containsXY=function(t,e){var r=i.mapXY(this.inverse,t,e);return this.model.containsPoint(r)},t.prototype.containsPoint=function(t){return this.containsXY(t.x,t.y)},t.prototype.offset=function(t,e){i.postTranslate(this.matrix,t,e),i.postTranslate(this.inverse,-t,-e)},t.prototype.transform=function(t){i.concat(t,this.matrix,this.matrix),i.invert(this.matrix,this.inverse)},t.prototype.fitInRect=function(t,e){i.rectToRect(this.matrix,this.model.bounds,t,e),i.invert(this.matrix,this.inverse)},t.prototype.stretchAcrossLine=function(t,e){var r=this.model,n=r.fixedPoint,a=r.controlPoint,c=o.subtract(t,n),s=o.add(c,a),u=e,f=t;i.stretchRotateToPoint(this.matrix,s,u,f),i.preTranslate(this.matrix,c.x,c.y),i.invert(this.matrix,this.inverse)},t}();r.Shape=a},{"./buffered/mat3":11,"./math/mat2d":20,"./math/vec2":24}],32:[function(t,e,r){"use strict";function n(t,e,r){var n=e.getImageData(0,0,r.cols,r.rows).data,o=new c.ColorBuffer(n),i=r.hexels;i.moveToFirst();do s.isTransparent(o)||s.blend(o,i,i);while(o.moveToNext()&&i.moveToNext())}function o(t,e,r,n){var o=t.hexels;o.moveToFirst();for(var i=o.capacity(),a=c.ColorBuffer.create(i);i--;)s.equals(o,e)?(o.moveToNext(),a.moveToNext()):a.putBuffer(o,1);var u=new Uint8ClampedArray(a.data.buffer),f=new ImageData(u,t.cols,t.rows);n.clearRect(0,0,r.width,r.height),n.putImageData(f,0,0)}Object.defineProperty(r,"__esModule",{value:!0});var i=t("./hex"),a=t("../graphics/buffer/bit"),c=t("../graphics/buffer/color"),s=t("../graphics/math/color"),u=t("../graphics/math/line"),f=t("../graphics/math/point"),h=t("../graphics/math/rect"),p=t("../graphics/math/ellipse");r.H_WIDTH=Math.sqrt(3),r.H_HEIGHT=2,r.H_RIGHT=r.H_WIDTH/2,r.H_UP=r.H_HEIGHT/4;var l=function(){function t(t,e,n){void 0===n&&(n=c.ColorBuffer.create(t*e)),this.hasGradient=!0,this.cols=t,this.rows=e,this.hexels=n;var o=r.H_WIDTH*(this.cols+.5),i=r.H_HEIGHT*(.75*this.rows+.25),a=-r.H_WIDTH/2,s=i+r.H_HEIGHT/2;this.bounds=h.ltwh(void 0,a,s,o,i)}return t.prototype.cubeAt=function(t){var e=t/this.cols>>0,r=t%this.cols-(e>>1);return new i.Hex(r,e)},t.prototype.offsetAt=function(t){var e=t/this.cols>>0,r=t%this.cols;return f.create(r,e)},t.prototype.indexOfHexel=function(t){var e=this.pointToHex(t).round();return this.indexOfCube(e)},t.prototype.indexOfCube=function(t){if(0<=t.r&&t.r<this.rows){var e=t.r>>1;if(-e<=t.q&&t.q<this.cols-e)return this.cols*t.r+t.q+e}return-1},t.prototype.indexOfOffset=function(t){return 0<=t.x&&t.x<this.cols&&0<=t.y&&t.y<this.rows?this.cols*t.y+t.x:-1},t.prototype.hexToPoint=function(t){var e=r.H_WIDTH*(t.q+t.r/2),n=.75*r.H_HEIGHT*t.r;return f.create(e,h.height(this.bounds)-n)},t.prototype.pointToHex=function(t){var e=t.x,n=h.height(this.bounds)-t.y,o=(r.H_WIDTH*e-n)/3,a=r.H_HEIGHT*n/3;return new i.Hex(o,a)},t.prototype.forEachCenterVertex=function(t,e){void 0===e&&(e=this.rows);for(var n=0,o=h.height(this.bounds),i=0;e>i;i++)for(var a=o-r.H_HEIGHT*i*.75,c=i/2-(i>>1),s=c+this.cols,u=c;s>u;u++){var f=r.H_WIDTH*u;t(f,a,n++)}},t.prototype.forEachCubicCoordinate=function(t){for(var e=0;e<this.rows;e++)for(var r=e>>1,n=-r;n<this.cols-r;n++)t(new i.Hex(n,e))},t.prototype.forEachOffsetCoordinate=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.cols;r++)t(f.create(r,e))},t.prototype.clear=function(t){this.hexels.setEachItem(t)},t.prototype.addBinaryImage=function(t){var e=this;s.isOpaque(t.color)?t.forEachSetBit(this.cols,function(r){e.hexels.setItem(r,t.color)}):t.forEachSetBit(this.cols,function(r){e.hexels.moveToPosition(r)&&s.blend(t.color,e.hexels,e.hexels)})},t.prototype.addLine=function(t,e,r,n){var o=this;void 0===n&&(n=this.bitArray());var i=.5*e;return this.forEachCenterVertex(function(e,a,c){u.containsXY(t,e,a,i)&&o.hexels.moveToPosition(c)&&(s.blend(r,o.hexels,o.hexels),n.set(c))}),n},t.prototype.addEllipse=function(t,e,r){var n=this;return void 0===r&&(r=this.bitArray()),this.forEachCenterVertex(function(o,i,a){p.containsXY(t,o,i)&&n.hexels.moveToPosition(a)&&(s.blend(e,n.hexels,n.hexels),r.set(a))}),r},t.prototype.addShape=function(t,e,r){var n=this;return void 0===r&&(r=this.bitArray()),this.forEachCenterVertex(function(o,i,a){t.containsXY(o,i)&&n.hexels.moveToPosition(a)&&(s.blend(e,n.hexels,n.hexels),r.set(a))}),r},t.prototype.beginStroke=function(t,e,r,n){var o=this;return void 0===n&&(n=this.bitArray()),this.forEachHexelInRange(t,e,function(t){o.hexels.moveToPosition(t)&&(s.blend(r,o.hexels,o.hexels),n.set(t))}),n},t.prototype.continueStroke=function(t,e,r,n,o){var i=this;void 0===o&&(o=this.bitArray());var a=t;return this.forEachCubeInLine(t,e,function(t){i.appendHexagon(a,t,r,n,o),a=t}),o},t.prototype.appendHexagon=function(t,e,r,n,o){if(void 0===o&&(o=this.bitArray()),0===r){var a=this.indexOfCube(e);-1!==a&&!o.get(a)&&this.hexels.moveToPosition(a)&&(s.blend(n,this.hexels,this.hexels),o.set(a))}else{var c=t.directionToNeighbor(e);if(-1===c)return;var u=new i.Hex;u.add(i.Directions[c>0?c-1:5]),u.mulScalar(r),u.add(e);var a=this.indexOfCube(u);-1!==a&&!o.get(a)&&this.hexels.moveToPosition(a)&&(s.blend(n,this.hexels,this.hexels),o.set(a));for(var f=c+1;c+3>f;f++)for(var h=0;r>h;h++){u.neighbor(f%6,u);var p=this.indexOfCube(u);-1!==p&&!o.get(p)&&this.hexels.moveToPosition(p)&&(s.blend(n,this.hexels,this.hexels),o.set(p))}}},t.prototype.forEachHexelInRange=function(t,e,r){for(var n=new i.Hex,o=-e;e>=o;o++){var a=Math.max(-e,-o-e),c=Math.min(e,-o+e);n.q=t.q+o;for(var s=a;c>=s;s++){n.r=t.r+s;var u=this.indexOfCube(n);-1!==u&&r(u)}}},t.prototype.forEachHexelInRing=function(t,e,r){if(0===e){var n=this.indexOfCube(t);-1!==n&&r(n)}else{var o=new i.Hex;o.add(i.Directions[4]),o.mulScalar(e),o.add(t);for(var a=0;6>a;a++)for(var c=0;e>c;c++){var n=this.indexOfCube(o);-1!==n&&r(n),o.neighbor(a,o)}}},t.prototype.forEachCubeInLine=function(t,e,r){for(var n=new i.Hex(e.q-t.q,e.r-t.r),o=n.distanceToOrigin(),a=1/Math.max(o,1),c=0;o>=c;c++){var s=a*c,u=new i.Hex;u.q=t.q+n.q*s,u.r=t.r+n.r*s,u.s=t.s+n.s*s,r(u.round())}},t.prototype.floodFill=function(t,e,r){if(void 0===r&&(r=this.bitArray()),this.hexels.moveToPosition(t)){var n=this.hexels,o=s.blend(e,n);if(!s.equals(o,n))return this.floodFillScanLine(t,s.toRgbaInt(o),s.toRgbaInt(n),r)}return r},t.prototype.floodFillScanLine=function(t,e,r,n){void 0===n&&(n=this.bitArray());var o,i,a,c,u,h,p,l=this.cols,d=this.rows,g=this.hexels.data,v=[],b=this.offsetAt(t);for(v.push(b);v.length>0;){for(b=v.pop(),h=b.x,p=b.y,o=p*l,i=o-l,a=o+l,c=!1,u=!1;h>=0&&s.getRgba(g,h+o)===r;)h--;for(0==(1&p)&&h>=0&&(p>0&&s.getRgba(g,h+i)===r&&(v.push(f.create(h,p-1)),c=!0),d-1>p&&s.getRgba(g,h+a)===r&&(v.push(f.create(h,p+1)),u=!0)),h++;l>h&&s.getRgba(g,h+o)===r;h++){var m=h+o;s.setRgba(g,m,e),n.set(m),p>0&&(c||s.getRgba(g,h+i)!==r?c&&s.getRgba(g,h+i)!==r&&(c=!1):(v.push(f.create(h,p-1)),c=!0)),d-1>p&&(u||s.getRgba(g,h+a)!==r?u&&s.getRgba(g,h+a)!==r&&(u=!1):(v.push(f.create(h,p+1)),u=!0))}1&p&&l>h&&(!c&&p>0&&s.getRgba(g,h+i)===r&&v.push(f.create(h,p-1)),!u&&d-1>p&&s.getRgba(g,h+a)===r&&v.push(f.create(h,p+1)))}return n},t.prototype.bitArray=function(){return a.createBitArray(this.hexels.capacity())},t}();r.Grid=l,r.copyPixelsToGrid=n,r.copyHexelsToCanvas=o},{"../graphics/buffer/bit":1,"../graphics/buffer/color":2,"../graphics/math/color":16,"../graphics/math/ellipse":18,"../graphics/math/line":19,"../graphics/math/point":22,"../graphics/math/rect":23,"./hex":33}],33:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=-t-e),this.q=t,this.r=e,this.s=r}return t.fromCube=function(e){return new t(e.q,e.r,e.s)},t.prototype.set=function(t,e,r){void 0===r&&(r=-t-e),this.q=t,this.r=e,this.s=r},t.prototype.distanceToCube=function(t){return Math.max(Math.abs(this.q-t.q),Math.abs(this.r-t.r),Math.abs(this.s-t.s))},t.prototype.distanceToOrigin=function(){return Math.max(Math.abs(this.q),Math.abs(this.r),Math.abs(this.s))},t.prototype.neighbor=function(e,n){return void 0===n&&(n=new t),this.add(r.Directions[e],n)},t.prototype.directionToNeighbor=function(e){for(var n=e.subtract(this,new t),o=0;o<r.Directions.length;o++)if(r.Directions[o].equals(n))return o;return-1},t.prototype.forEachNeighbor=function(t){for(var e=0;e<r.Directions.length;e++)t(this.neighbor(e))},t.prototype.add=function(t,e){return void 0===e&&(e=this),e.q=this.q+t.q,e.r=this.r+t.r,e.s=this.s+t.s,e},t.prototype.subtract=function(t,e){return void 0===e&&(e=this),e.q=this.q-t.q,e.r=this.r-t.r,e.s=this.s-t.s,e},t.prototype.mulScalar=function(t,e){return void 0===e&&(e=this),e.q=this.q*t,e.r=this.r*t,e.s=this.s*t,e},t.prototype.divScalar=function(t,e){return void 0===e&&(e=this),e.q=this.q/t,e.r=this.r/t,e.s=this.s/t,e},t.prototype.round=function(t){void 0===t&&(t=this);var e=this.q,r=this.r,n=this.s;t.q=Math.round(e),t.r=Math.round(r),t.s=Math.round(n);var o=Math.abs(t.q-e),i=Math.abs(t.r-r),a=Math.abs(t.s-n);return o>i&&o>a?t.q=-t.r-t.s:i>a?t.r=-t.q-t.s:t.s=-t.q-t.r,t},t.prototype.equals=function(t){return this.q===t.q&&this.r===t.r&&this.s===t.s},t}();r.Hex=n,r.Directions=[new n(1,-1,0),new n(1,0,-1),new n(0,1,-1),new n(-1,1,0),new n(-1,0,1),new n(0,-1,1)]},{}],34:[function(t,e,r){"use strict";function n(){Z.length=0,z.length=0,J=0}function o(t){function e(t){0===t.button&&t.altKey&&(k.random(ut.val),M(ut.val))}if(2!==t.src.button){var r=1===t.src.button?tt:yt;switch(t.status){case 0:s(),e(t.src),r.onStart&&r.onStart(t);break;case 1:r.onMove&&r.onMove(t);break;case 3:r.onLeave&&r.onLeave(t);break;case 2:r.onEnd&&r.onEnd(t)}}}function i(t){var e=yt;switch(t.pointers.length>1?e=Q:Q.onEnd(t),t.status){case 0:s(),e.onStart&&e.onStart(t);break;case 1:e.onMove&&e.onMove(t);break;case 3:e.onLeave&&e.onLeave(t);break;case 2:e.onEnd&&e.onEnd(t)}}function a(t){var e=U.Color.create();k.copy(ut.val,e);var r=N.BinaryImage.make(t,Tt.cols,Tt.rows,e);if(r){z.push(r),Z.length=0,J+=r.data.data.length;for(var n=function(){var t=z.shift();k.isOpaque(t.color)?t.forEachSetBit(Tt.cols,function(e){Mt.setItem(e,t.color)}):t.forEachSetBit(Tt.cols,function(e){Mt.moveToPosition(e)&&k.blend(t.color,Mt,Mt)}),J-=t.data.data.length};J>K;)n()}}function c(t,e){t.addEventListener("DOMMouseScroll",e,!1),t.addEventListener("mousewheel",e,!1)}function s(){X&&(Mt.moveToFirst(),Tt.hexels.moveToFirst(),Mt.putBuffer(Tt.hexels),n(),X=!1)}function u(){function t(){var n=e.outerWidth(),o=e.innerHeight()-r.innerHeight();o>0&&(Ot.resize(n,o)||Et.needToRender)&&(Et.needToRender=!1,Et.onDrawFrame()),requestAnimationFrame(t)}var e=$("body"),r=$("#toolbar");t()}function f(t,e){t!=yt&&($(xt).children("i").addClass("md-inactive").removeClass("md-active"),$(e).children("i").addClass("md-active").removeClass("md-inactive"),yt=t,xt=e)}function h(){p(),l(),d(),g(),v(),P(),w(),b(),m(),y(),E()}function p(){$("#color-picker").spectrum({color:ut.unparsed.val,flat:!1,showInput:!1,showInitial:!1,allowEmpty:!1,showAlpha:!0,disabled:!1,showPalette:!0,showPaletteOnly:!0,togglePaletteOnly:!0,showSelectionPalette:!1,clickoutFiresChange:!0,hideAfterPaletteSelect:!0,preferredFormat:"rgb",palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(t){if(t){t.setAlpha(mt);var e=t.toHex8String();$(this).spectrum("set",e),k.fromArgbString(e,ut.val),ut.unparsed.val=e,Et.color=ut.val}},hide:function(t){mt=ut.val.a/255}}),$("#color-picker").on("dragstop.spectrum",function(t,e){
mt=e.getAlpha()})}function l(){$("#brush").click(function(){f(et,"#brush")});var t=new Slider("input[name=brushRadius]",{min:1,max:50,step:1,value:ft.unlerped.val,tooltip:"show"});t.on("slideStop",function(e){f(et,"#brush"),ft.val=t.getValue()})}function d(){$("#line").click(function(){f(ot,"#line")});var t=new Slider("input[name=lineThickness]",{min:1,max:100,step:1,value:ht.unlerped.val,tooltip:"show"});t.on("slideStop",function(e){f(ot,"#line"),ht.val=t.getValue(),Et.lineThickness=ht.val})}function g(){function t(t){e!=t&&($("#shape").children("i").removeClass(e).addClass(t),e=t)}var e="icon-circle";$("#shape").click(function(){"icon-circle"==e?f(it,"#shape"):f(at,"#shape")}),$("input[name=maintainAspect]").prop("checked",pt.val).change(function(){pt.val=this.checked?!0:!1}),$("#circle").click(function(){f(it,"#shape"),t("icon-circle")});for(var r=["triangle","square","diamond","pentagon","hexagon","star","heart","flower","bat"],n=function(e){$("#"+r[e]).click(function(){_t=W[e],f(at,"#shape"),t("icon-"+r[e])})},o=0;o<r.length;o++)n(o)}function v(){function t(t,n){r!=n&&($("#other").children("i").removeClass(r).addClass(n),r=n,e=t)}var e=rt,r="icon-bucket";$("#other").click(function(){f(e,"#other")}),$("#color-sampler").click(function(){f(nt,"#other"),t(nt,"icon-eyedropper")}),$("#paint-bucket").click(function(){f(rt,"#other"),t(rt,"icon-bucket")}),$("#pan-tool").click(function(){f(tt,"#other"),t(tt,"icon-pan")})}function b(){function t(){var t='<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n        <label for="enableShadows">Enable shadows:</label>\n        <input name="enableShadows" type="checkbox" '+(lt.val?"checked":"")+'/>\n    </div>\n</div>\n<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n        <label for="zoomSpeed">Zoom speed:</label>\n        <input name="zoomSpeed" type="number" min="1" max="1000" />\n    </div>\n</div>\n<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n          <label for="gridWidth">Grid width:</label>\n          <input name="gridWidth" type="number" min="5" max="10" />\n    </div>\n</div>\n<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n          <label for="gridHeight">Grid height:</label>\n          <input name="gridHeight" type="number" min="5" max="10" />\n    </div>\n</div>';vex.dialog.open({message:"Options",input:t,callback:e}),r()}function e(t){if(t&&(t.enableShadows?lt.val||(Tt.hasGradient=lt.val=!0,Et.applyGradientChanges()):lt.val&&(Tt.hasGradient=lt.val=!1,Et.applyGradientChanges()),t.zoomSpeed&&(dt.val=parseInt(t.zoomSpeed)),t.gridWidth!=gt.uninterpolated.val||t.gridHeight!=vt.uninterpolated.val)){gt.val=parseInt(t.gridWidth),vt.val=parseInt(t.gridHeight);var e=St.width=gt.val,r=St.height=vt.val,o=Tt;Tt=new q.Grid(e,r),Tt.clear(ct),Tt.hasGradient=o.hasGradient;for(var i=new Uint32Array(o.hexels.data.buffer),a=new Uint32Array(Tt.hexels.data.buffer),c=Math.min(r,o.rows),s=Math.min(e,o.cols),u=0;c>u;u++)for(var f=0;s>f;f++)a[u*e+f]=i[u*o.cols+f];Et.programs.hexel.setLayout(wt,Tt),Et.projection=new F.Projection(Tt.bounds,1,Math.max(Tt.rows,Tt.cols)),Et.projection.fillViewport(Pt.clientWidth,Pt.clientHeight),Et.needToRender=!0,n(),Mt=D.ColorBuffer.create(Tt.hexels.capacity()),Tt.hexels.moveToFirst(),Mt.putBuffer(Tt.hexels)}}function r(){$("input[name=zoomSpeed]").slider({min:1,max:1e3,step:1,value:dt.unlerped.val,tooltip:"hide"}),$("input[name=gridWidth]").slider({ticks:[5,6,7,8,9],ticks_labels:["32","64","128","256","512"],min:5,max:9,step:1,value:gt.uninterpolated.val,tooltip:"hide"}),$("input[name=gridHeight]").slider({ticks:[5,6,7,8,9],ticks_labels:["32","64","128","256","512"],min:5,max:9,step:1,value:vt.uninterpolated.val,tooltip:"hide"})}$("#options").click(t)}function m(){function t(){var t="Upload image onto this "+Tt.cols+"x"+Tt.rows+" grid.",r='<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n        <label for="imagefile">Image:</label>\n        <input name="imagefile" type="file" accept="image/*" required>\n    </div>\n    <div class="vex-custom-input-wrapper">\n        <label for="x">X (hexels from left):</label>\n        <input name="x" type="number" min="0" max="'+Tt.cols+'">\n    </div>\n    <div class="vex-custom-input-wrapper">\n        <label for="y">Y (hexels from top):</label>\n        <input name="y" type="number" min="0" max="'+Tt.rows+'">\n    </div>\n    <div class="vex-custom-input-wrapper">\n        <label for="width">Width (in hexels):</label>\n        <input name="width" type="number" min="0">\n    </div>\n    <div class="vex-custom-input-wrapper">\n        <label for="height">Height (in hexels):</label>\n        <input name="height" type="number" min="0">\n    </div>\n</div>';vex.dialog.open({message:t,input:r,callback:e}),$("input[name=imagefile]").change(function(t){if(t.target.files[0]){var e=t.target.files[0];n(e,function(t){var e=St.width/t.width,r=St.height/t.height,n=Math.min(e,r),i=Math.round(t.width*n),a=Math.round(t.height*n),c=Math.round((St.width-i)/2),s=Math.round((St.height-a)/2);$("input[name=x]").val(c),$("input[name=y]").val(s),$("input[name=width]").val(i),$("input[name=height]").val(a),o=t})}})}function e(t){if(o&&t){var e=t.x,n=t.y,i=t.width,a=t.height;r(St,At,o,e,n,i,a),q.copyPixelsToGrid(St,At,Tt),Et.applyColorChanges(),X=!0}}function r(t,e,r,n,o,i,a){void 0===n&&(n=0),void 0===o&&(o=0),void 0===i&&(i=Tt.cols),void 0===a&&(a=Tt.rows),e.clearRect(0,0,t.width,t.height),e.drawImage(r,0,0,r.width,r.height,n,o,i,a)}function n(t,e){var r=new FileReader;r.onload=function(t){var r=new Image;r.onload=function(){e(r)},r.src=t.target.result},r.readAsDataURL(t)}var o;$("#upload").click(t)}function y(){function t(){var t="Download hexel art as a "+Tt.cols+"x"+Tt.rows+" image file.",r='<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n        <label for="transparentColor">Transparent color:</label>\n        <input name="transparentColor" type="text" style="display: none" />\n    </div>\n    <br/>\n    <div class="vex-custom-input-wrapper">\n        <label for="filename">Filename:</label>\n        <input name="filename" type="text" value="'+bt.val+'"/>\n    </div>\n</div>\n<p> Note: an image viewer will interpret the file as pixel art, but if you reupload the file to this app, you will be able to view and modify the original hexel art.</p>';vex.dialog.open({message:t,input:r,callback:e}),$("input[name=transparentColor]").spectrum({color:k.equalsScalar(st,0)?null:k.toArgbString(st),flat:!1,showInput:!0,showInitial:!1,allowEmpty:!0,disabled:!1,showPalette:!0,showPaletteOnly:!0,togglePaletteOnly:!0,showSelectionPalette:!1,clickoutFiresChange:!0,hideAfterPaletteSelect:!0,preferredFormat:"rgb",palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(t){t?k.fromArgbString(t.toHex8String(),st):k.rgba(st,0,0,0,0)}})}function e(t){t&&t.filename&&(bt.val=t.filename,q.copyHexelsToCanvas(Tt,st,St,At),St.toBlob(function(t){saveAs(t,bt.val,!0)},"image/png"))}$("#download").click(t)}function x(){if(z.length>0){if(X)X=!1;else{var t=z.pop();Z.push(t),J-=t.data.data.length}Tt.hexels.moveToFirst(),Mt.moveToFirst(),Tt.hexels.putBuffer(Mt);for(var e=0,r=z;e<r.length;e++){var n=r[e];Tt.addBinaryImage(n)}Et.applyColorChanges()}}function _(){if(Z.length>0){var t=Z.pop();z.push(t),J+=t.data.data.length,Tt.addBinaryImage(t),Et.applyColorChanges()}}function P(){$("#undo").click(x)}function w(){$("#redo").click(_)}function T(t){return 1<<t}function M(t){k.copy(t,ut.val),ut.unparsed.val=k.toArgbString(t),$("#color-picker").spectrum("set",ut.unparsed.val),Et.color=ut.val}function E(){var t=-1,e=!1;$(document).on("keydown",function(e){t=e.which}).on("keyup",function(r){t=-1,e=!1}).on("keypress",function(r){if(!e){var n=String.fromCharCode(t).toLowerCase();(r.metaKey||r.ctrlKey)&&("z"===n?(r.shiftKey?_():x(),e=!0):"y"===n&&(_(),e=!0))}})}Object.defineProperty(r,"__esModule",{value:!0});var O=t("./graphics/math/ellipse"),S=t("./graphics/model"),A=t("./graphics/math/point"),R=t("./graphics/buffered/rect"),C=t("./graphics/math/rect"),j=t("./graphics/math/line"),I=t("./graphics/math/vec2"),B=t("./graphics/buffered/line"),L=t("./graphics/shape"),F=t("./graphics/rendering/projection"),H=t("./graphics/rendering/surface"),q=t("./hexel/grid"),D=t("./graphics/buffer/color"),U=t("./graphics/buffered/color"),k=t("./graphics/math/color"),G=t("./renderer"),N=t("./graphics/buffer/bit"),V=t("./polygons"),Y=t("./options");vex.defaultOptions.className="vex-theme-wireframe";var X,W=[S.Model.polygon(3),S.Model.square(),S.Model.diamond(),S.Model.polygon(5),S.Model.polygon(6),S.Model.star5(),S.Model.fromSource(V.heart),S.Model.fromSource(V.flower),S.Model.fromSource(V.bat)],z=[],Z=[],K=15e4,J=0,Q={onStart:function(t){var e=t.pointers[0],r=t.pointers[1];this.previousSpan=A.distance(e,r),this.previousFocus=A.midpoint(e,r)},onMove:function(t){if(!this.previousFocus)return void this.onStart(t);var e=Et.projection,r=t.pointers[0],n=t.pointers[1],o=A.distance(r,n),i=e.applyChangeInZoom(o/this.previousSpan);this.previousSpan=o/i;var a=A.midpoint(r,n),c=I.subtract(this.previousFocus,a);I.divScalar(c,i),c=e.applyChangeInPan(c),this.previousFocus.x=a.x+c.x,this.previousFocus.y=a.y+c.y,e.applyChangesToMatrix(),Et.needToRender=!0},onEnd:function(t){this.previousFocus=null}},tt={onStart:function(t){this.previous=t.pointers[0]},onMove:function(t){if(!this.previous)return void this.onStart(t);var e=t.pointers[0],r=I.subtract(this.previous,e);Et.projection.panByVector(r),Et.needToRender=!0,this.previous.x=e.x+r.x,this.previous.y=e.y+r.y},onEnd:function(t){this.previous=null}},et={onStart:function(t){var e=Tt.pointToHex(t.pointers[0]).round(),r=Tt.indexOfCube(e);-1!==r&&(this.record=Tt.beginStroke(e,ft.val,ut.val),Et.applyColorChanges(),this.previous=e)},onMove:function(t){if(this.previous){var e=Tt.pointToHex(t.pointers[0]).round();e.equals(this.previous)||(Tt.continueStroke(this.previous,e,ft.val,ut.val,this.record),Et.applyColorChanges(),this.previous=e)}else this.onStart(t)},onEnd:function(t){this.record&&a(this.record),this.previous=null,this.record=null}},rt={onStart:function(t){if(!Et.needToRender){var e=t.pointers[0],r=Tt.indexOfHexel(e);if(-1!==r){var n=Tt.floodFill(r,ut.val);a(n),Et.applyColorChanges()}}}},nt={onStart:function(t){this.onMove(t)},onMove:function(t){var e=t.pointers[0],r=Tt.indexOfHexel(e);Tt.hexels.moveToPosition(r)&&(M(Tt.hexels),mt=ut.val.a/255)}},ot={onStart:function(t){this.start=t.pointers[0]},onMove:function(t){if(this.start){var e=t.pointers[0],r=Et.drawables;r.line||(r.line=B.Line.create()),j.through(this.start,e,r.line),Et.needToRender=!0}},onEnd:function(t){if(this.start=null,Et.drawables.line){var e=Tt.addLine(Et.drawables.line,ht.val,ut.val);a(e),Et.drawables.line=null,Et.applyColorChanges()}}},it={onStart:function(t){this.start=t.pointers[0]},onMove:function(t){if(this.start){var e=t.pointers[0],r=Et.drawables;r.ellipse||(r.ellipse=R.Rect.create()),C.unionOfTwoPoints(r.ellipse,this.start,e),pt.val&&C.expandToSquare(r.ellipse),Et.needToRender=!0}},onLeave:function(t){this.onMove(t)},onEnd:function(t){this.start=null;var e=Et.drawables;if(e.ellipse){var r=Tt.addEllipse(O.createWithBoundaries(e.ellipse),ut.val);a(r),Et.drawables.ellipse=null,Et.applyColorChanges()}}},at={onStart:function(t){this.start=t.pointers[0]},onMove:function(t){if(this.start){var e=t.pointers[0],r=Et.drawables;if(r.shape||(r.shape=new L.Shape(_t)),pt.val)r.shape.stretchAcrossLine(this.start,e);else{var n=C.unionOfTwoPoints(void 0,this.start,e);r.shape.fitInRect(n,2)}Et.needToRender=!0}},onEnd:function(t){this.start=null;var e=Et.drawables;if(e.shape){var r=Tt.addShape(e.shape,ut.val);a(r),e.shape=null,Et.applyColorChanges()}}},ct=k.rgba(U.Color.create(),205,205,205,255),st=k.rgba(U.Color.create(),205,205,205,255),ut=Y.ColorOption.create("drawColor",k.rgba(U.Color.create(),39,78,19,255)),ft=Y.LerpedOption.create(new Y.Lerper(-1,1),Y.Option.num("brushRadius",2,1,50)),ht=Y.LerpedOption.create(new Y.Lerper(0,q.H_WIDTH),Y.Option.num("lineThickness",2,1,100)),pt=Y.Option.bool("maintainAspect",!0),lt=Y.Option.bool("shadowsEnabled",!0),dt=Y.LerpedOption.create(Y.Lerper.fromRange(1,2,1e3),Y.Option.num("zoomSpeed",500,1,1e3)),gt=Y.InterpolatedOption.create(T,Y.Option.num("log2cols",7,5,9)),vt=Y.InterpolatedOption.create(T,Y.Option.num("log2rows",7,5,9)),bt=Y.Option.str("filename","My Hexel Art"),mt=ut.val.a/255,yt=et,xt="#brush",_t=W[0],Pt=document.getElementById("onscreen-canvas"),wt=Pt.getContext("webgl"),Tt=new q.Grid(gt.val,vt.val);Tt.clear(ct),Tt.hasGradient=lt.val;var Mt=D.ColorBuffer.create(Tt.hexels.capacity());Tt.hexels.moveToFirst(),Mt.putBuffer(Tt.hexels);var Et=G.HexelRenderer.create(wt,Tt,W);Et.lineThickness=ht.val,Et.color=ut.val;var Ot=new H.Surface(Pt,Et),St=document.getElementById("offscreen-canvas"),At=St.getContext("2d");St.width=Tt.cols,St.height=Tt.rows,h(),c(Pt,function(t){t.preventDefault(),t.stopPropagation();var e=t.detail<0||t.wheelDelta>0,r=e?dt.val:1/dt.val,n=Ot.screenToWorld(t);Et.projection.zoomToPoint(r,n),Et.needToRender=!0}),H.addSurfaceListener(window,Ot,o,i),u()},{"./graphics/buffer/bit":1,"./graphics/buffer/color":2,"./graphics/buffered/color":7,"./graphics/buffered/line":10,"./graphics/buffered/rect":13,"./graphics/math/color":16,"./graphics/math/ellipse":18,"./graphics/math/line":19,"./graphics/math/point":22,"./graphics/math/rect":23,"./graphics/math/vec2":24,"./graphics/model":25,"./graphics/rendering/projection":27,"./graphics/rendering/surface":29,"./graphics/shape":31,"./hexel/grid":32,"./options":35,"./polygons":36,"./renderer":42}],35:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./graphics/math"),o=t("./graphics/buffered/color"),i=t("./graphics/math/color"),a=function(){function t(t,e){this.key=t,this.value=e}return t.get=function(t){return localStorage?localStorage.getItem(t):null},t.bool=function(e,r){var n,o=t.get(e);return n="true"===o?!0:"false"===o?!1:r,new t(e,n)},t.num=function(e,r,n,o){var i=parseInt(t.get(e));return(isNaN(i)||n>i||i>o)&&(i=r),new t(e,i)},t.str=function(e,r){var n=t.get(e),o=n?n:r;return new t(e,o)},Object.defineProperty(t.prototype,"val",{get:function(){return this.value},set:function(t){this.value=t,localStorage&&localStorage.setItem(this.key,t.toString())},enumerable:!0,configurable:!0}),t}();r.Option=a;var c=function(){function t(t,e){this.unparsed=t,this.value=e}return t.create=function(e,r){var c,s=a.str(e,null);return s.val&&n.ArgbRegex.test(s.val)?(c=o.Color.create(),i.fromArgbString(s.val,c)):(c=r,s.val=i.toArgbString(r)),new t(s,c)},Object.defineProperty(t.prototype,"val",{get:function(){return this.value},set:function(t){this.value=t,this.unparsed.val=i.toArgbString(t)},enumerable:!0,configurable:!0}),t}();r.ColorOption=c;var s=function(){function t(t,e,r){this.interpolator=t,this.uninterpolated=e,this.value=r}return t.create=function(e,r){var n=e(r.val);return new t(e,r,n)},Object.defineProperty(t.prototype,"val",{get:function(){return this.value},set:function(t){this.uninterpolated.val=t,this.value=this.interpolator(t)},enumerable:!0,configurable:!0}),t}();r.InterpolatedOption=s;var u=function(){function t(t,e,r){this.unlerped=e,this.lerper=t,this.value=r}return t.create=function(e,r){var n=e.lerp(r.val);return new t(e,r,n)},Object.defineProperty(t.prototype,"val",{get:function(){return this.value},set:function(t){this.unlerped.val=t,this.value=this.lerper.lerp(t)},enumerable:!0,configurable:!0}),t}();r.LerpedOption=u;var f=function(){function t(t,e){this.a=t,this.b=e}return t.fromRange=function(e,r,n){return new t(e,(r-e)/n)},t.prototype.lerp=function(t){return this.a+this.b*t},t.prototype.unlerp=function(t){return(t-this.a)/this.b},t}();r.Lerper=f},{"./graphics/buffered/color":7,"./graphics/math":15,"./graphics/math/color":16}],36:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.bat={vertices:new Float32Array([0,3,-2,5,-3,2,-5,0,-8,3,-10,7,-17,10,-13,5,-12,-1,-3,-7,0,-10,3,-7,12,-1,13,5,17,10,10,7,8,3,5,0,3,2,2,5]),indices:new Uint16Array([0,1,2,0,2,3,0,3,9,0,9,10,0,10,11,0,11,17,0,17,18,0,18,19,4,5,6,4,6,7,4,7,8,4,8,9,4,9,3,16,14,15,16,13,14,16,12,13,16,11,12,16,17,11])},r.flower={vertices:new Float32Array([0,-2,-1,-1,-2,-1,-2,-2,-3,-3,-1,-3,-2,-4,-2,-5,-1,-5,0,-6,0,-4,1,-5,2,-5,2,-4,3,-3,1,-3,2,-2,2,-1,1,-1,0,0]),indices:new Uint16Array([5,0,1,5,1,2,5,2,3,5,3,4,5,6,7,5,7,8,5,8,9,5,9,10,5,10,0,15,0,10,15,10,11,15,11,12,15,12,13,15,13,14,15,16,17,15,17,18,15,18,19,15,19,0])},r.heart={vertices:new Float32Array([0,12,-3,16,-5,16,-8,12,-8,8,0,0,8,8,8,12,5,16,3,16])}},{}],37:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("../graphics/model"),i=t("../graphics/rendering/util"),a=t("../graphics/rendering/program"),c=t("./shaders"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t){var r=a.createProgramInfo(t,c.EllipseProgramSource),n=i.createArrayBuffer(t,new Float32Array([0,1,0,0,1,0,1,1])),s=i.createElementBuffer(t,o.polygonIndices(4).data);return new e(r,{texCoordBuffer:n,elementBuffer:s})},e.prototype.bind=function(t){t.useProgram(this.location),t.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.texCoordBuffer),t.vertexAttribPointer(this.attribs.a_texCoord,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.attribs.a_texCoord),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bindings.elementBuffer)},e.prototype.setProjection=function(t,e){t.uniformMatrix4fv(this.uniforms.u_projection,!1,e.data)},e.prototype.setColor=function(t,e){t.uniform4fv(this.uniforms.u_color,e.data)},e.prototype.setEllipse=function(t,e){t.uniform4fv(this.uniforms.u_rect,e.data)},e.prototype.draw=function(t){t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)},e}(a.Program);r.EllipseProgram=s},{"../graphics/model":25,"../graphics/rendering/program":26,"../graphics/rendering/util":30,"./shaders":40}],38:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("../hexel/grid"),i=t("../graphics/buffered/vec2"),a=t("../graphics/math/point"),c=t("../graphics/rendering/program"),s=t("../graphics/buffer/triangleIndices"),u=t("../graphics/buffer/vec2"),f=t("../graphics/buffer/vertices"),h=t("./shaders"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.basePosition=i.Vec2.create(),e.baseTexCoord=i.Vec2.create(),e}return n(e,t),e.create=function(t,r){var n=c.createProgramInfo(t,h.HexelProgramSource),o=new e(n,{positionBuffer:t.createBuffer(),texCoordBuffer:t.createBuffer(),gradientBuffer:t.createBuffer(),elementBuffer:t.createBuffer(),texture:t.createTexture()});return o.setLayout(t,r),o},e.prototype.bind=function(t){t.useProgram(this.location),t.disable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.positionBuffer),t.vertexAttribPointer(this.attribs.a_position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.attribs.a_position),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.texCoordBuffer),t.vertexAttribPointer(this.attribs.a_texCoord,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.attribs.a_texCoord),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.gradientBuffer),t.vertexAttribPointer(this.attribs.a_gradient,1,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.attribs.a_gradient),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bindings.elementBuffer),t.bindTexture(t.TEXTURE_2D,this.bindings.texture)},e.prototype.setProjection=function(t,e){t.uniformMatrix4fv(this.uniforms.u_projection,!1,e.data)},e.prototype.setColors=function(t,e){t.bindTexture(t.TEXTURE_2D,this.bindings.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.grid.cols,this.grid.rows,0,t.RGBA,t.UNSIGNED_BYTE,e)},e.prototype.updateColors=function(t,e){t.bindTexture(t.TEXTURE_2D,this.bindings.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.grid.cols,this.grid.rows,t.RGBA,t.UNSIGNED_BYTE,e)},e.prototype.setGradient=function(t,e){t.bindBuffer(t.ARRAY_BUFFER,this.bindings.gradientBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)},e.prototype.setTexCoords=function(t,e){t.bindBuffer(t.ARRAY_BUFFER,this.bindings.texCoordBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)},e.prototype.setPositions=function(t,e){t.bindBuffer(t.ARRAY_BUFFER,this.bindings.positionBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)},e.prototype.setIndices=function(t,e){this.elementCount=e.length,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bindings.elementBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)},e.prototype.setLayout=function(t,e){this.grid=e;var r=this.grid,n=r.hexels.capacity();this.hexelsPerSection=Math.min(n,8192),this.sectionsPerGrid=n/this.hexelsPerSection,this.rowsPerSection=this.hexelsPerSection/r.cols,this.sectionHeight=1.5*this.rowsPerSection,this.setPositions(t,this.generateVertices()),this.setTexCoords(t,this.generateTexCoords()),this.setGradient(t,this.generateGradient()),this.setIndices(t,this.generateIndices()),this.setColors(t,e.hexels.data)},e.prototype.applyColorChanges=function(t){this.updateColors(t,this.grid.hexels.data)},e.prototype.applyGradientChanges=function(t){this.setGradient(t,this.generateGradient())},e.prototype.draw=function(t,e){var r=e.region,n=this.grid,o=n.pointToHex(a.create(0,r.top)).r-1,i=n.pointToHex(a.create(0,r.bottom)).r+1,c=Math.max(0,Math.floor(o/this.rowsPerSection)),s=Math.min(this.sectionsPerGrid,Math.ceil(i/this.rowsPerSection)),u=-this.sectionHeight,f=1/this.sectionsPerGrid;this.basePosition.x=0,this.basePosition.y=u*c,this.baseTexCoord.x=0,this.baseTexCoord.y=f*c;for(var h=c;s>h;h++)t.uniform2fv(this.uniforms.u_basePosition,this.basePosition.data),t.uniform2fv(this.uniforms.u_baseTexCoord,this.baseTexCoord.data),t.drawElements(t.TRIANGLES,this.elementCount,t.UNSIGNED_SHORT,0),this.basePosition.y+=u,this.baseTexCoord.y+=f},e.prototype.generateVertices=function(){var t=f.VertexBuffer.create(6*this.hexelsPerSection);return this.grid.forEachCenterVertex(function(e,r,n){t.put(e,r+1),t.put(e-o.H_RIGHT,r+o.H_UP),t.put(e-o.H_RIGHT,r-o.H_UP),t.put(e,r-1),t.put(e+o.H_RIGHT,r-o.H_UP),t.put(e+o.H_RIGHT,r+o.H_UP)},this.rowsPerSection),t.data},e.prototype.generateTexCoords=function(){for(var t=u.Vec2Buffer.create(6*this.hexelsPerSection),e=this.grid.rows,r=this.grid.cols,n=0;n<this.rowsPerSection;n++)for(var o=(n+.5)/e,i=0;r>i;i++)for(var a=(i+.5)/r,c=0;6>c;c++)t.put(a,o);return t.data},e.prototype.generateIndices=function(){for(var t=s.TriangleIndicesBuffer.create(4*this.hexelsPerSection),e=0;t.hasValidPosition();e+=6)t.put(e,e+1,e+2),t.put(e,e+2,e+3),t.put(e,e+3,e+4),t.put(e,e+4,e+5);return t.data},e.prototype.generateGradient=function(){var t=this.hexelsPerSection,e=new Float32Array(6*t),r=0;if(!this.grid.hasGradient)return e;for(var n=18/256,o=.125,i=50/256,a=0;t>a;a++)e[r++]=n,e[r++]=o,e[r++]=i,e[r++]=-n,e[r++]=-o,e[r++]=-i;return e},e}(c.Program);r.HexelProgram=p},{"../graphics/buffer/triangleIndices":4,"../graphics/buffer/vec2":5,"../graphics/buffer/vertices":6,"../graphics/buffered/vec2":14,"../graphics/math/point":22,"../graphics/rendering/program":26,"../hexel/grid":32,"./shaders":40}],39:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("../graphics/model"),i=t("../graphics/rendering/util"),a=t("../graphics/rendering/program"),c=t("./shaders"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t){var r=a.createProgramInfo(t,c.LineProgramSource),n=i.createArrayBuffer(t,new Float32Array([0,.5,0,-.5,1,-.5,1,.5])),s=i.createElementBuffer(t,o.polygonIndices(4).data);return new e(r,{positionBuffer:n,elementBuffer:s})},e.prototype.bind=function(t){t.useProgram(this.location),t.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.positionBuffer),t.vertexAttribPointer(this.attribs.a_position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.attribs.a_position),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bindings.elementBuffer)},e.prototype.setProjection=function(t,e){t.uniformMatrix4fv(this.uniforms.u_projection,!1,e.data)},e.prototype.setColor=function(t,e){t.uniform4fv(this.uniforms.u_color,e.data)},e.prototype.setThickness=function(t,e){t.uniform1f(this.uniforms.u_thickness,e)},e.prototype.setLine=function(t,e){t.uniform4fv(this.uniforms.u_line,e.data)},e.prototype.draw=function(t){t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)},e}(a.Program);r.LineProgram=s},{"../graphics/model":25,"../graphics/rendering/program":26,"../graphics/rendering/util":30,"./shaders":40}],40:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EllipseProgramSource={vs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform mat4 u_projection;uniform vec4 u_rect;attribute vec2 a_texCoord;varying vec2 v_texCoord;void main(){float left = u_rect[0]; float top = u_rect[1]; float right = u_rect[2]; float bottom = u_rect[3]; float width = right - left; float height = top - bottom; float posX = width * a_texCoord.x + left; float posY = height * a_texCoord.y + bottom; gl_Position = u_projection * vec4(posX, posY, 1.0, 1.0); v_texCoord = a_texCoord;}",fs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform vec4 u_color;varying vec2 v_texCoord;void main(){float dx = v_texCoord.x * 2.0 - 1.0; float dy = v_texCoord.y * 2.0 - 1.0; float dist2 = dx * dx + dy * dy; gl_FragColor = u_color * float(dist2 <= 1.0);}"},r.HexelProgramSource={vs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform sampler2D u_tex;uniform mat4 u_projection;uniform vec2 u_basePosition;uniform vec2 u_baseTexCoord;attribute vec2 a_position;attribute vec2 a_texCoord;attribute float a_gradient;varying vec4 v_color;void main(){gl_Position.xy = u_basePosition + a_position; gl_Position.z = 1.0; gl_Position.w = 1.0; gl_Position = u_projection * gl_Position; v_color = texture2D(u_tex, u_baseTexCoord + a_texCoord); v_color.r += a_gradient; v_color.g += a_gradient; v_color.b += a_gradient; v_color.a = 1.0;}",fs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec4 v_color;void main(){gl_FragColor = v_color;}"},r.LineProgramSource={vs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform mat4 u_projection;uniform vec4 u_line;uniform float u_thickness;attribute vec2 a_position;void main(){vec2 p1 = vec2(u_line[0], u_line[1]); vec2 p2 = vec2(u_line[2], u_line[3]); float width = distance(p1, p2); float height = u_thickness; float sx = width * a_position.x; float sy = height * a_position.y; float hypotenuse = width; float adjacent = p2.x - p1.x; float opposite = p2.y - p1.y; float sin = opposite / hypotenuse; float cos = adjacent / hypotenuse; float rx = cos * sx - sin * sy; float ry = sin * sx + cos * sy; float tx = rx + p1.x; float ty = ry + p1.y; gl_Position = u_projection * vec4(tx, ty, 1.0, 1.0);}",fs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform vec4 u_color;void main(){gl_FragColor = u_color;}"},r.ShapeProgramSource={vs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform mat4 u_projection;uniform mat3 u_model;attribute vec2 a_position;void main(){gl_Position.xy = a_position; gl_Position.z = 1.0; gl_Position.xyz = u_model * gl_Position.xyz; gl_Position.w = 1.0; gl_Position = u_projection * gl_Position;}",fs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform vec4 u_color;void main(){gl_FragColor = u_color;}"}},{}],41:[function(t,e,r){"use strict";function n(t){for(var e=0,r=0,n=0;n<t.length;n++)e+=t[n].vertices.capacity(),r+=t[n].indices.capacity();for(var o=i.VertexBuffer.create(e),c=a.TriangleIndicesBuffer.create(r),s=o.itemLength()*o.data.BYTES_PER_ELEMENT,u=c.itemLength()*c.data.BYTES_PER_ELEMENT,f=0,h=t;f<h.length;f++){var p=h[f];p.vertexBufferOffset=o.position()*s,p.elementBufferOffset=c.position()*u,p.vertices.moveToFirst(),o.putBuffer(p.vertices),p.indices.moveToFirst(),c.putBuffer(p.indices)}return{vertices:o.data,indices:c.data}}var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=t("../graphics/buffer/vertices"),a=t("../graphics/buffer/triangleIndices"),c=t("../graphics/rendering/util"),s=t("../graphics/rendering/program"),u=t("./shaders"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.elementCount=0,e.elementOffset=0,e}return o(e,t),e.create=function(t,r){var o=s.createProgramInfo(t,u.ShapeProgramSource),i=n(r),a=c.createArrayBuffer(t,i.vertices),f=c.createElementBuffer(t,i.indices);return new e(o,{positionBuffer:a,elementBuffer:f})},e.prototype.bind=function(t){t.useProgram(this.location),t.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.positionBuffer),t.enableVertexAttribArray(this.attribs.a_position),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bindings.elementBuffer)},e.prototype.setProjection=function(t,e){t.uniformMatrix4fv(this.uniforms.u_projection,!1,e.data)},e.prototype.setColor=function(t,e){t.uniform4fv(this.uniforms.u_color,e.data)},e.prototype.setModel=function(t,e){t.vertexAttribPointer(this.attribs.a_position,2,t.FLOAT,!1,0,e.vertexBufferOffset),this.elementCount=e.indices.data.length,this.elementOffset=e.elementBufferOffset},e.prototype.setModelMatrix=function(t,e){t.uniformMatrix3fv(this.uniforms.u_model,!1,e.data)},e.prototype.draw=function(t){t.drawElements(t.TRIANGLES,this.elementCount,t.UNSIGNED_SHORT,this.elementOffset)},e}(s.Program);r.ShapeProgram=f},{"../graphics/buffer/triangleIndices":4,"../graphics/buffer/vertices":6,"../graphics/rendering/program":26,"../graphics/rendering/util":30,"./shaders":40}],42:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,
new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./graphics/rendering/renderer"),i=t("./graphics/rendering/projection"),a=t("./program/ellipse"),c=t("./program/line"),s=t("./program/shape"),u=t("./program/hexel"),f=t("./hexel/grid"),h=t("./graphics/buffered/colorF"),p=t("./graphics/math/colorF"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rgba=h.ColorF.create(),e.lineThickness=f.H_WIDTH,e}return n(e,t),e.create=function(t,r,n){var o=Math.max(r.rows,r.cols),f=new i.Projection(r.bounds,1,o),h={ellipse:a.EllipseProgram.create(t),line:c.LineProgram.create(t),shape:s.ShapeProgram.create(t,n),hexel:u.HexelProgram.create(t,r)},p={ellipse:null,line:null,shape:null};return new e(t,f,h,p)},Object.defineProperty(e.prototype,"color",{set:function(t){p.fromColor(t,this.rgba)},enumerable:!0,configurable:!0}),e.prototype.onSurfaceCreated=function(){var t=this.gl;t.clearColor(0,0,0,0),t.enable(t.CULL_FACE),t.cullFace(t.BACK),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)},e.prototype.onDrawFrame=function(){var t=this,e=t.gl,r=t.projection,n=t.programs,o=t.drawables,i=t.lineThickness,a=t.rgba,c=n.hexel,s=n.shape,u=n.line,f=n.ellipse,h=o.shape,p=o.line,l=o.ellipse,d=r.matrix;this.useProgram(c),c.setProjection(e,d),c.draw(e,r),h?(this.useProgram(s),s.setProjection(e,d),s.setColor(e,a),s.setModel(e,h.model),s.setModelMatrix(e,h.matrix),s.draw(e)):l?(this.useProgram(f),f.setProjection(e,d),f.setColor(e,a),f.setEllipse(e,l),f.draw(e)):p&&(this.useProgram(u),u.setProjection(e,d),u.setColor(e,a),u.setThickness(e,i),u.setLine(e,p),u.draw(e))},e.prototype.applyGradientChanges=function(){this.programs.hexel.applyGradientChanges(this.gl),this.needToRender=!0},e.prototype.applyColorChanges=function(){this.programs.hexel.applyColorChanges(this.gl),this.needToRender=!0},e}(o.Renderer);r.HexelRenderer=l},{"./graphics/buffered/colorF":8,"./graphics/math/colorF":17,"./graphics/rendering/projection":27,"./graphics/rendering/renderer":28,"./hexel/grid":32,"./program/ellipse":37,"./program/hexel":38,"./program/line":39,"./program/shape":41}]},{},[34]);