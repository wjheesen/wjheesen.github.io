!function t(e,r,n){function o(a,s){if(!r[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var p=r[a]={exports:{}};e[a][0].call(p.exports,function(t){var r=e[a][1][t];return o(r?r:t)},p,p.exports,t,e,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./util"),o=function(){function t(t){this.data=t}return t.prototype.setFromAttrib=function(t){n.copy(t.data,this.data)},t.prototype.setFromArray=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.copy(t,this.data)},t.prototype.add=function(t,e){void 0===e&&(e=this),n.add(this.data,t.data,e.data)},t.prototype.subtract=function(t,e){void 0===e&&(e=this),n.subtract(this.data,t.data,e.data)},t.prototype.multiply=function(t,e){void 0===e&&(e=this),n.multiply(this.data,t.data,e.data)},t.prototype.divide=function(t,e){void 0===e&&(e=this),n.divide(this.data,t.data,e.data)},t.prototype.mulScalar=function(t,e){void 0===e&&(e=this),n.mulScalar(this.data,t,e.data)},t.prototype.divScalar=function(t,e){void 0===e&&(e=this),n.divScalar(this.data,t,e.data)},t.prototype.pow=function(t,e){void 0===e&&(e=this),n.pow(this.data,t,e.data)},t.prototype.negate=function(t){void 0===t&&(t=this),n.negate(this.data,t.data)},t.prototype.abs=function(t){void 0===t&&(t=this),n.abs(this.data,t.data)},t.prototype.round=function(t){void 0===t&&(t=this),n.round(this.data,t.data)},t.prototype.floor=function(t){void 0===t&&(t=this),n.floor(this.data,t.data)},t.prototype.ceil=function(t){void 0===t&&(t=this),n.ceil(this.data,t.data)},t.prototype.clamp=function(t,e,r){void 0===r&&(r=this),n.clamp(this.data,t,e,r.data)},t.prototype.equals=function(t){return n.equals(this.data,t.data)},t.prototype.epsilonEquals=function(t,e){return n.epsilonEquals(this.data,t.data,e)},t.prototype.equalsConstant=function(t){return n.equalsConstant(this.data,t)},t.prototype.isZero=function(){return n.isZero(this.data)},t}();r.Attrib=o;var i=function(){function t(t,e){void 0===e&&(e=0),this.data=t,this.size=e,this.capacity=t.length/this.attribLength()}return t.prototype.setFromAttrib=function(t,e){for(var r=t*this.attribLength(),n=0;n<e.data.length;n++)this.data[r++]=e.data[n]},t.prototype.setFromArray=function(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=e.capacity-r),this.setFromArrayData(t,e.data,r*this.attribLength(),n)},t.prototype.setFromArrayData=function(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=(e.length-r)/this.attribLength());for(var o=this.attribLength(),i=t*o,a=0;n>a;a++)for(var s=0;o>s;s++)this.data[i++]=e[r++]},t.prototype.setEachAttrib=function(t){for(var e=0;e<this.capacity;e++)this.setFromAttrib(e,t)},t.prototype.appendAttrib=function(t){this.setFromAttrib(this.size++,t)},t.prototype.appendArray=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=t.capacity-e),this.appendArrayData(t.data,e,r)},t.prototype.appendArrayData=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=(t.length-e)/this.attribLength()),this.setFromArrayData(this.size,t,e,r),this.size+=r},t.prototype.forEachAttrib=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=this.size);for(var n=0;r>n;n++,e++)t(this.get(e),e)},t.prototype.equals=function(t){return n.equals(this.data,t.data)},t.prototype.epsilonEquals=function(t,e){return n.epsilonEquals(this.data,t.data,e)},t}();r.AttribArray=i},{"./util":7}],2:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../math/rect"),o=function(){function t(t){this.data=new Uint8Array(t),this.length=t.byteLength<<3}return t.withCapacity=function(e){var r=e>>3;return 7&e&&r++,new t(new ArrayBuffer(r))},t.prototype.get=function(t){var e=t>>3,r=7&t,n=this.data[e];return n>>r&1},t.prototype.set=function(t){var e=t>>3,r=7&t;this.data[e]|=1<<r},t.prototype.clear=function(t){var e=t>>3,r=7&t;this.data[e]&=~(1<<r)},t.prototype.forEach=function(t){for(var e=0;e<this.data.length;e++)for(var r=this.data[e],n=0;8>n;n++)t(r>>n&1)},t.prototype.toString=function(){var t="";return this.forEach(function(e){t+=e}),t},t}();r.BitArray=o;var i=function(){function t(t,e,r){this.data=t,this.color=r,this.bounds=e}return t.make=function(e,r,i,a){for(var s,c=0,u=0;i>c;c++)for(var p=0;r>p;p++)e.get(u++)&&(s?s.union(p,c):s=n.Rect.withLRBT(p,p,c,c));if(!s)return null;for(var h=s.width()+1,f=s.height()+1,d=o.withCapacity(h*f),c=s.bottom,u=0;c<=s.top;c++)for(var p=s.left;p<=s.right;p++,u++)e.get(c*r+p)&&d.set(u);return new t(d,s,a)},t.prototype.forEachSetBit=function(t,e){var r=this,n=this.bounds.left,o=this.bounds.bottom*t;this.data.forEach(function(i){i&&e(o+n),++n>r.bounds.right&&(n=r.bounds.left,o+=t)})},t}();r.BinaryImage=i},{"../math/rect":13}],3:[function(t,e,r){"use strict";function n(t,e,r,n){var o=new v;return o.set(t,e,r,n),o}function o(t,e,r,n){var o=new y;return o.set(t,e,r,n),o}function i(t,e,r){void 0===r&&(r=new v);var n=t.a+1,o=256-t.a;return r.r=n*t.r+o*e.r>>8,r.g=n*t.g+o*e.g>>8,r.b=n*t.b+o*e.b>>8,r.a=255,r}function a(t){void 0===t&&(t=255);var e=d.randomInt(0,255)<<24,r=d.randomInt(0,255)<<16,n=d.randomInt(0,255)<<8;return(e|r|n|t)>>>0}function s(t){return 1==t.length?"0"+t:t}function c(t){var e=s((t>>24&255).toString(16)),r=s((t>>16&255).toString(16)),n=s((t>>8&255).toString(16)),o=s((255&t).toString(16));return"#"+o+e+r+n}function u(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),r=parseInt(e[2],16)<<24,n=parseInt(e[3],16)<<16,o=parseInt(e[4],16)<<8,i=parseInt(e[1],16);return(r|n|o|i)>>>0}function p(t,e){var r=t>>24&255,n=t>>16&255,o=t>>8&255,i=t>>0&255,a=e>>24&255,s=e>>16&255,c=e>>8&255,u=i+1,p=256-i,h=u*r+p*a>>8,f=u*n+p*s>>8,d=u*o+p*c>>8;return(h<<24|f<<16|d<<8|255)>>>0}function h(t){var e=t>>24&255,r=t>>16&255,n=t>>8&255,o=t>>0&255;console.log("{r: "+e+", g: "+r+", b: "+n+", a: "+o+"}")}var f=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var d=t("../math/util"),l=t("./attrib");r.ArgbRegex=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;var v=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(4)),void 0===n&&(n=0),t.call(this,new Uint8Array(r,n,e.LENGTH))||this}return f(e,t),Object.defineProperty(e.prototype,"r",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),e.fromColor=function(t){var r=new e;return r.setFromAttrib(t),r},e.fromArgbString=function(t){var r=new e;return r.setFromArgbString(t),r},e.fromRgbaInt=function(t){var r=new e;return r.setFromRgbaInt(t),r},e.random=function(t){void 0===t&&(t=255);var r=new e;return r.setRandom(t),r},e.prototype.isOpaque=function(){return 255===this.a},e.prototype.set=function(t,e,r,n){this.r=t,this.g=e,this.b=r,this.a=n},e.prototype.setRandom=function(t){this.r=d.randomInt(0,255),this.g=d.randomInt(0,255),this.b=d.randomInt(0,255),this.a=t},e.prototype.setFromArgbString=function(t){var e=r.ArgbRegex.exec(t);this.a=parseInt(e[1],16),this.r=parseInt(e[2],16),this.g=parseInt(e[3],16),this.b=parseInt(e[4],16)},e.prototype.setFromRgbaInt=function(t){this.r=t>>24&255,this.g=t>>16&255,this.b=t>>8&255,this.a=t>>0&255},e.prototype.toArgbString=function(){var t=s(this.r.toString(16)),e=s(this.g.toString(16)),r=s(this.b.toString(16)),n=s(this.a.toString(16));return"#"+n+t+e+r},e.prototype.toRgbaInt=function(){var t=this.r<<24,e=this.g<<16,r=this.b<<8,n=this.a<<0;return(t|e|r|n)>>>0},e.prototype.blend=function(t,e){void 0===e&&(e=this),i(this,t,e)},e.prototype.toString=function(){return"{r: "+this.r+", g: "+this.g+", b: "+this.g+", a: "+this.a+"}"},e}(l.Attrib);v.LENGTH=4,r.Color=v;var y=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(16)),void 0===n&&(n=0),t.call(this,new Float32Array(r,n,e.LENGTH))||this}return f(e,t),Object.defineProperty(e.prototype,"r",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),e.fromColor=function(t){var r=new e;return r.setFromColor(t),r},e.fromColorF=function(t){var r=new e;return r.setFromAttrib(t),r},e.prototype.set=function(t,e,r,n){this.r=t,this.g=e,this.b=r,this.a=n},e.prototype.setFromColor=function(t){this.r=t.r/255,this.g=t.g/255,this.b=t.b/255,this.a=t.a/255},e.prototype.setFromArgbString=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);this.a=parseInt(e[1],16)/255,this.r=parseInt(e[2],16)/255,this.g=parseInt(e[3],16)/255,this.b=parseInt(e[4],16)/255},e.prototype.setFromRgbaInt=function(t){this.r=(t>>24&255)/255,this.g=(t>>16&255)/255,this.b=(t>>8&255)/255,this.a=(t>>0&255)/255},e.prototype.premultiplyAlpha=function(){var t=this.a;this.r*=t,this.g*=t,this.b*=t},e}(l.Attrib);y.LENGTH=4,r.ColorF=y;var g=function(t){function e(e,r){return void 0===r&&(r=0),t.call(this,e,r)||this}return f(e,t),e.withCapacity=function(t){return new e(new Uint8Array(t*v.LENGTH))},e.fromColorArray=function(t){var r=e.withCapacity(t.capacity);return r.appendArray(t),r},e.prototype.attribLength=function(){return v.LENGTH},e.prototype.get=function(t){return new v(this.data.buffer,t*v.LENGTH)},e.prototype.getRgba=function(t){var e=t*v.LENGTH,r=this.data[e++]<<24,n=this.data[e++]<<16,o=this.data[e++]<<8,i=this.data[e];return(r|n|o|i)>>>0},e.prototype.set=function(t,e,r,n,o){var i=t*this.attribLength();this.data[i++]=e,this.data[i++]=r,this.data[i++]=n,this.data[i++]=o},e.prototype.setFromRgbaInt=function(t,e){var r=t*v.LENGTH;this.data[r++]=e>>24&255,this.data[r++]=e>>16&255,this.data[r++]=e>>8&255,this.data[r++]=e>>0&255},e.prototype.mix=function(t,e){var r=e.a+1,n=256-e.a,o=t*v.LENGTH,i=this.data[o],a=this.data[o+1],s=this.data[o+2];this.data[o++]=r*e.r+n*i>>8,this.data[o++]=r*e.g+n*a>>8,this.data[o++]=r*e.b+n*s>>8,this.data[o]=255},e.prototype.mixRgba=function(t,e){var r=e>>24&255,n=e>>16&255,o=e>>8&255,i=e>>0&255,a=t*v.LENGTH,s=this.data[a],c=this.data[a+1],u=this.data[a+2],p=i+1,h=256-i;this.data[a++]=p*r+h*s>>8,this.data[a++]=p*n+h*c>>8,this.data[a++]=p*o+h*u>>8,this.data[a]=255},e.prototype.append=function(t,e,r,n){this.set(this.size++,t,e,r,n)},e}(l.AttribArray);r.ColorArray=g,r.color=n,r.colorF=o,r.blend=i,r.randomRgba=a,r.rgbaToString=c,r.stringToRgba=u,r.blendRgba=p,r.logRgba=h},{"../math/util":14,"./attrib":1}],4:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./attrib"),i=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(6)),void 0===n&&(n=0),t.call(this,new Uint16Array(r,n,e.LENGTH))||this}return n(e,t),e.prototype.set=function(t,e,r){this.data[0]=t,this.data[1]=e,this.data[2]=r},e}(o.Attrib);i.LENGTH=3,r.IndexTuple=i;var a=function(t){function e(e,r){return void 0===r&&(r=0),t.call(this,e,r)||this}return n(e,t),e.withCapacity=function(t){return new e(new Uint16Array(t*i.LENGTH))},e.fromIndexTupleArray=function(t){var r=e.withCapacity(t.capacity);return r.appendArray(t),r},e.polygonIndices=function(t){for(var r=e.withCapacity(t-2),n=1,o=2;r.size<r.capacity;n=o++)r.append(0,n,o);return r},e.starIndices=function(t){for(var r=t-2,n=t,o=e.withCapacity(r+n),i=3,a=5;o.size<r;i=a++,a++)o.append(1,i,a);for(var s=2*t-1,i=0,a=1;o.size<o.capacity;s=a++,i=a++)o.append(s,i,a);return o},e.prototype.attribLength=function(){return i.LENGTH},e.prototype.get=function(t){return new i(this.data.buffer,t*i.LENGTH*Uint16Array.BYTES_PER_ELEMENT)},e.prototype.set=function(t,e,r,n){var o=t*this.attribLength();this.data[o++]=e,this.data[o++]=r,this.data[o]=n},e.prototype.append=function(t,e,r){this.set(this.size++,t,e,r)},e}(o.AttribArray);r.IndexTupleArray=a},{"./attrib":1}],5:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../data/indices"),o=t("../data/vertices"),i=t("../math/rect"),a=function(){function t(t,e,r,n,o){void 0===r&&(r=t.calculateBounds()),void 0===n&&(n=r.centerTop()),void 0===o&&(o=r.centerBottom()),this.elementBufferOffset=0,this.vertexBufferOffset=0,this.vertices=t,this.indices=e,this.fixedPoint=n,this.controlPoint=o,this.bounds=r}return t.polygon=function(e){var r=o.VertexArray.polygonVertices(e),i=n.IndexTupleArray.polygonIndices(e);return new t(r,i)},t.star=function(e,r,i){var a=o.VertexArray.starVertices(e,r,i),s=n.IndexTupleArray.starIndices(e);return new t(a,s)},t.diamond=function(){return t.star(2,.5,1)},t.square=function(){return t.rectangle(i.Rect.withLRBT(0,1,0,1))},t.rectangle=function(e){var r=o.VertexArray.fromRect(e),i=n.IndexTupleArray.polygonIndices(4);return new t(r,i,e)},t.star5=function(){return t.star(5,.4,1)},t.bat=function(){var e=o.VertexArray.withCapacity(20);e.append(0,3),e.append(-2,5),e.append(-3,2),e.append(-5,0),e.append(-8,3),e.append(-10,7),e.append(-17,10),e.append(-13,5),e.append(-12,-1),e.append(-3,-7),e.append(0,-10),e.append(3,-7),e.append(12,-1),e.append(13,5),e.append(17,10),e.append(10,7),e.append(8,3),e.append(5,0),e.append(3,2),e.append(2,5);var r=n.IndexTupleArray.withCapacity(18);return r.append(0,1,2),r.append(0,2,3),r.append(0,3,9),r.append(0,9,10),r.append(0,10,11),r.append(0,11,17),r.append(0,17,18),r.append(0,18,19),r.append(4,5,6),r.append(4,6,7),r.append(4,7,8),r.append(4,8,9),r.append(4,9,3),r.append(16,14,15),r.append(16,13,14),r.append(16,12,13),r.append(16,11,12),r.append(16,17,11),new t(e,r)},t.heart=function(){var e=o.VertexArray.withCapacity(10);e.append(0,12),e.append(-3,16),e.append(-5,16),e.append(-8,12),e.append(-8,8),e.append(0,0),e.append(8,8),e.append(8,12),e.append(5,16),e.append(3,16);var r=n.IndexTupleArray.polygonIndices(10);return new t(e,r)},t.flower=function(){var e=o.VertexArray.withCapacity(20);e.append(0,-2),e.append(-1,-1),e.append(-2,-1),e.append(-2,-2),e.append(-3,-3),e.append(-1,-3),e.append(-2,-4),e.append(-2,-5),e.append(-1,-5),e.append(0,-6),e.append(0,-4),e.append(1,-5),e.append(2,-5),e.append(2,-4),e.append(3,-3),e.append(1,-3),e.append(2,-2),e.append(2,-1),e.append(1,-1),e.append(0,0);var r=n.IndexTupleArray.withCapacity(18);r.append(5,0,1),r.append(5,1,2),r.append(5,2,3),r.append(5,3,4),r.append(5,6,7),r.append(5,7,8),r.append(5,8,9),r.append(5,9,10),r.append(5,10,0),r.append(15,0,10),r.append(15,10,11),r.append(15,11,12),r.append(15,12,13),r.append(15,13,14),r.append(15,16,17),r.append(15,17,18),r.append(15,18,19),r.append(15,19,0);var i=e.calculateBounds(),a=e.get(19),s=e.get(9);return new t(e,r,i,a,s)},t.prototype.contains=function(t,e){return this.bounds.contains(t,e)&&this.vertices.contains(t,e)},t.prototype.containsPoint=function(t){return this.contains(t.x,t.y)},t}();r.Model=a},{"../data/indices":4,"../data/vertices":8,"../math/rect":13}],6:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../math/point"),o=t("../math/vector"),i=t("../math/matrix"),a=function(){function t(t,e){void 0===e&&(e=i.Mat2d.identity()),this.model=t,this.matrix=e,this.inverse=e.inverse()}return t.prototype.contains=function(t,e){var r=this.inverse.map(t,e);return this.model.containsPoint(r)},t.prototype.containsPoint=function(t){return this.contains(t.x,t.y)},t.prototype.offset=function(t,e){this.matrix.postTranslate(t,e),this.inverse.postTranslate(-t,-e)},t.prototype.transform=function(t){this.matrix.postConcat(t),this.matrix.invert(this.inverse)},t.prototype.fitInRect=function(t,e){this.matrix.setRectToRect(this.model.bounds,t,e),this.matrix.invert(this.inverse)},t.prototype.stretchAcrossLine=function(t,e){var r=o.Vec2.fromPointToPoint(this.model.fixedPoint,t),a=n.add(this.model.controlPoint,r),s=e,c=t;this.matrix=i.Mat2d.stretchRotateFromPointToPoint(a,s,c),this.matrix.preTranslate(r.x,r.y),this.matrix.invert(this.inverse)},t}();r.Shape=a},{"../math/matrix":11,"../math/point":12,"../math/vector":15}],7:[function(t,e,r){"use strict";function n(t,e){for(var r=0;r<t.length;r++)e[r]=t[r]}function o(t){return Math.sqrt(i(t))}function i(t){for(var e=0,r=0;r<t.length;r++)e+=t[r]*t[r];return e}function a(t,e){for(var r=0,n=0;n<t.length;n++)r+=t[n]*e[n];return r}function s(t,e,r){for(var n=0;n<t.length;n++)r[n]=t[n]+e[n]}function c(t,e,r){for(var n=0;n<t.length;n++)r[n]=t[n]-e[n]}function u(t,e,r){for(var n=0;n<t.length;n++)r[n]=t[n]*e[n]}function p(t,e,r){for(var n=0;n<t.length;n++)r[n]=t[n]/e[n]}function h(t,e,r){for(var n=0;n<t.length;n++)r[n]=t[n]*e}function f(t,e,r){for(var n=0;n<t.length;n++)r[n]=t[n]/e}function d(t,e,r){for(var n=0;n<t.length;n++)r[n]=Math.pow(t[n],e)}function l(t,e){for(var r=0;r<t.length;r++)e[r]=-t[r]}function v(t,e){f(t,o(t),e)}function y(t,e,r,n){for(var o=0;o<t.length;o++)n[o]=t[o]+e[o]*r}function g(t,e){for(var r=0;r<t.length;r++)e[r]=Math.abs(t[r])}function m(t,e){for(var r=0;r<t.length;r++)e[r]=Math.round(t[r])}function b(t,e){for(var r=0;r<t.length;r++)e[r]=t[r]>>0}function x(t,e){for(var r=0;r<t.length;r++)e[r]=Math.ceil(t[r])}function _(t,e){for(var r=0;r<t.length;r++)e[r]=t[r]-(t[r]>>0)}function w(t,e,r){for(var n=0;n<t.length;n++)r[n]=t[n]-e*(t[n]/e>>0)}function P(t,e,r,n){for(var o=0;o<t.length;o++)n[o]=t[o]<e?e:t[o]>r?r:t[o]}function T(t,e){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function A(t,e,r){for(var n=0;n<t.length;n++)if(Math.abs(t[n]-e[n])>r)return!1;return!0}function E(t,e){for(var r=0;r<t.length;r++)if(t[r]!==e)return!1;return!0}function R(t){return E(t,0)}Object.defineProperty(r,"__esModule",{value:!0}),r.copy=n,r.length=o,r.length2=i,r.dot=a,r.add=s,r.subtract=c,r.multiply=u,r.divide=p,r.mulScalar=h,r.divScalar=f,r.pow=d,r.negate=l,r.normalize=v,r.lerp=y,r.abs=g,r.round=m,r.floor=b,r.ceil=x,r.fract=_,r.mod=w,r.clamp=P,r.equals=T,r.epsilonEquals=A,r.equalsConstant=E,r.isZero=R},{}],8:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("../math/vector"),i=t("../math/rect"),a=t("../math/matrix"),s=function(t){function e(e,r){return void 0===r&&(r=0),t.call(this,e,r)||this}return n(e,t),e.withCapacity=function(t){return new e(new Float32Array(t*o.Vec2.LENGTH))},e.fromVertexArray=function(t){var r=e.withCapacity(t.capacity);return r.appendArray(t),r},e.fromRect=function(t){var r=e.withCapacity(4);return r.append(t.left,t.top),r.append(t.left,t.bottom),r.append(t.right,t.bottom),r.append(t.right,t.top),r},e.polygonVertices=function(t,r){void 0===r&&(r=1);var n=e.withCapacity(t),i=o.vec2(0,r);n.appendAttrib(i);for(var s=a.Mat2d.rotateByAngle(2*Math.PI/t);n.size<n.capacity;)s.mapPoint(i,i),n.appendAttrib(i);return n},e.starVertices=function(t,r,n){var i=e.withCapacity(t+t),s=2*Math.PI/t,c=new a.Mat2d,u=o.vec2(0,n),p=o.vec2(0,r);for(c.setRotate(.5*s),c.mapPoint(p,p),i.appendAttrib(u),i.appendAttrib(p),c.setRotate(s);i.size<i.capacity;)c.mapPoint(u,u),c.mapPoint(p,p),i.appendAttrib(u),i.appendAttrib(p);return i},e.prototype.calculateBounds=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.size),i.Rect.fromUnion(this.data,t*o.Vec2.LENGTH,e)},e.prototype.contains=function(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=this.size);var o=!1;return this.forEachEdge(function(r,n,i,a){n>e!=a>e&&(i-r)*(e-n)/(a-n)+r>t&&(o=!o)},r,n),o},e.prototype.containsPoint=function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=this.size),this.contains(t.x,t.y,e,r)},e.prototype.offset=function(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=this.size);for(var o=r*this.attribLength(),i=0;n>=i;i++)this.data[o++]+=t,this.data[o++]+=e},e.prototype.transform=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=this.size);var n=e*this.attribLength();t.mapPoints(this.data,n,r,this.data,n)},e.prototype.forEachEdge=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=this.size);for(var n=this.data,o=this.attribLength(),i=o*e,a=o*(e+r),s=n[a-2],c=n[a-1],u=0,p=0;a>i;)u=n[i++],p=n[i++],t(s,c,u,p),s=u,c=p},e}(o.Vec2Array);r.VertexArray=s},{"../math/matrix":11,"../math/rect":13,"../math/vector":15}],9:[function(t,e,r){"use strict";function n(t,e,r,n){var o=new a;return o.rx=t,o.ry=e,o.cx=r,o.cy=n,o}var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=t("../data/attrib"),a=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(16)),void 0===n&&(n=0),t.call(this,new Float32Array(r,n,e.LENGTH))||this}return o(e,t),Object.defineProperty(e.prototype,"rx",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ry",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cx",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cy",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),e.fromRect=function(t){var e=t.width()/2,r=t.height()/2,o=t.centerX(),i=t.centerY();return n(e,r,o,i)},e.fromEllipse=function(t){var r=new e;return r.setFromAttrib(t),r},e.prototype.contains=function(t,e){var r=this.cx-t,n=this.cy-e,o=r/this.rx,i=n/this.ry;return 1>=o*o+i*i},e.prototype.containsPoint=function(t){return this.contains(t.x,t.y)},e}(i.Attrib);a.LENGTH=4,r.Ellipse=a},{"../data/attrib":1}],10:[function(t,e,r){"use strict";function n(t,e,r,n){var o=new a;return o.x1=t,o.y1=e,o.x2=r,o.y2=n,o}var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=t("../data/attrib"),a=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(16)),void 0===n&&(n=0),t.call(this,new Float32Array(r,n,e.LENGTH))||this}return o(e,t),Object.defineProperty(e.prototype,"x1",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x2",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y2",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),e.fromLine=function(t){var r=new e;return r.setFromAttrib(t),r},e.fromPointToPoint=function(t,e){return n(t.x,t.y,e.x,e.y)},e.prototype.contains=function(t,e,r){var n=this.x1,o=this.y1,i=this.x2-n,a=this.y2-o,s=-1,c=t-n,u=e-o,p=i*c+a*u,h=i*i+a*a;if(0!=h&&(s=p/h),0>s||s>1)return!1;var f=n+s*i,d=o+s*a,l=t-f,v=e-d,y=l*l+v*v;return r*r>y},e.prototype.containsPoint=function(t,e){return this.contains(t.x,t.y,e)},e}(i.Attrib);a.LENGTH=4,r.Line=a,r.line=n},{"../data/attrib":1}],11:[function(t,e,r){"use strict";function n(t,e,r,n,o,i,a){void 0===a&&(a=new Float32Array(16));var s=e-t,c=n-r,u=o-i;return a[0]=2/s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2/c,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1/u,a[11]=0,a[12]=-(e+t)/s,a[13]=-(n+r)/c,a[14]=-o/u,a[15]=1,a}var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=t("./point"),a=t("./vector"),s=t("./rect"),c=t("../data/attrib"),u=function(t){function e(e,r,n){return t.call(this,new Float32Array(e,r,n))||this}return o(e,t),e}(c.Attrib);r.Mat=u;var p=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(16)),void 0===n&&(n=0),t.call(this,r,n,e.LENGTH)||this}return o(e,t),Object.defineProperty(e.prototype,"c1r1",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c1r2",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c2r1",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c2r2",{get:function(){return this.data[4]},set:function(t){this.data[4]=t},enumerable:!0,configurable:!0}),e.fromCR=function(t,e,r,n){var o=new h;return o.c1r1=t,o.c2r1=r,o.c1r2=e,o.c2r2=n,o},e.fromRC=function(t,e,r,n){var o=new h;return o.c1r1=t,o.c2r1=e,o.c1r2=r,o.c2r2=n,o},e.identity=function(){return e.fromRC(1,0,0,1)},e.rotateByAngle=function(t){var r=Math.sin(t),n=Math.cos(t);return e.rotateBySinCos(r,n)},e.rotateBySinCos=function(t,r){var n=new e;return n.setSinCos(t,r),n},e.rotateFromPointToPoint=function(t,r){var n=a.Vec2.fromOriginToPoint(t);n.normalize();var o=a.Vec2.fromOriginToPoint(r);o.normalize();var i=n.cross(o),s=n.dot(o);return e.rotateBySinCos(i,s)},e.scale=function(t,r){var n=new e;return n.setScale(t,r),n},e.scaleFromPointToPoint=function(t,r){var n=r.x/t.x,o=r.y/t.y;return e.scale(n,o)},e.stretch=function(t){return e.scale(t,t)},e.stretchFromPointToPoint=function(t,r){return e.stretch(i.distance(r)/i.distance(t))},e.stretchRotateFromPointToPoint=function(t,r){var n=a.Vec2.fromOriginToPoint(t),o=a.Vec2.fromOriginToPoint(r),i=n.length(),s=o.length(),c=s/i;n.divScalar(i),o.divScalar(s);var u=n.cross(o),p=n.dot(o),h=new e;return h.setSinCos(u,p),h.postStretch(c),h},e.concat=function(t,r){var n=new e;return n.setConcat(t,r),n},e.prototype.determinant=function(){return this.c1r1*this.c2r2-this.c2r1*this.c1r2},e.prototype.inverse=function(){var t=new e;return this.invert(t),t},e.prototype.invert=function(t){void 0===t&&(t=this);var e=1/this.determinant(),r=this.c1r1,n=this.c2r1,o=this.c1r2,i=this.c2r2;t.c1r1=i*e,t.c2r1=-n*e,t.c1r2=-o*e,t.c2r2=r*e},e.prototype.postConcat=function(t,e){void 0===e&&(e=this),e.setConcat(t,this)},e.prototype.preConcat=function(t,e){void 0===e&&(e=this),this.setConcat(this,t)},e.prototype.postRotate=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.c1r1,o=this.c2r1;this.c1r1=r*n-e*this.c1r2,this.c2r1=r*o-e*this.c2r2,this.c1r2=e*n+r*this.c1r2,this.c2r2=e*o+r*this.c2r2},e.prototype.preRotate=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.c1r1,o=this.c1r2;this.c1r1=n*r+this.c2r1*e,this.c1r2=o*r+this.c2r2*e,this.c2r1=n*-e+this.c2r1*r,this.c2r2=o*-e+this.c2r2*r},e.prototype.postScale=function(t,e){this.c1r1*=t,this.c2r1*=t,this.c1r2*=e,this.c2r2*=e},e.prototype.preScale=function(t,e){this.c1r1*=t,this.c1r2*=t,this.c2r1*=e,this.c2r2*=e},e.prototype.postStretch=function(t){this.postScale(t,t)},e.prototype.preStretch=function(t){this.preScale(t,t)},e.prototype.setConcat=function(t,e){var r=t.c1r1*e.c1r1+t.c2r1*e.c1r2,n=t.c1r1*e.c2r1+t.c2r1*e.c2r2,o=t.c1r2*e.c1r1+t.c2r2*e.c1r2,i=t.c1r2*e.c2r1+t.c2r2*e.c2r2;this.c1r1=r,this.c2r1=n,this.c1r2=o,this.c2r2=i},e.prototype.setIdentity=function(){this.c1r1=1,this.c2r1=0,this.c1r2=0,this.c2r2=1},e.prototype.setRotate=function(t){var e=Math.sin(t),r=Math.cos(t);this.setSinCos(e,r)},e.prototype.setSinCos=function(t,e){this.c1r1=e,this.c2r1=-t,this.c1r2=t,this.c2r2=e},e.prototype.setScale=function(t,e){this.c1r1=t,this.c2r1=0,this.c1r2=0,this.c2r2=e},e.prototype.setStretch=function(t){this.setScale(t,t)},e.prototype.mapX=function(t,e){return this.c1r1*t+this.c2r1*e},e.prototype.mapY=function(t,e){return this.c1r2*t+this.c2r2*e},e.prototype.map=function(t,e,r){return void 0===r&&(r=i.point()),r.x=this.mapX(t,e),r.y=this.mapY(t,e),r},e.prototype.mapPoint=function(t,e){return void 0===e&&(e=i.point()),this.map(t.x,t.y,e)},e.prototype.mapPoints=function(t,e,r,n,o){void 0===n&&(n=t),void 0===o&&(o=e);for(var i=0;r>i;i++){var a=t[e++],s=t[e++];n[o++]=this.mapX(a,s),n[o++]=this.mapY(a,s)}},e.prototype.mapRect=function(t,e){void 0===e&&(e=new s.Rect);var r=t.topLeft(),n=t.bottomLeft(),o=t.bottomRight(),i=t.topRight();return this.mapPoint(r,r),this.mapPoint(n,n),this.mapPoint(o,o),this.mapPoint(i,i),e.left=e.right=r.x,e.top=e.bottom=r.y,e.unionPoint(n),e.unionPoint(o),e.unionPoint(i),e},e}(u);p.LENGTH=4,r.Mat2=p;var h=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(36)),void 0===n&&(n=0),t.call(this,r,n,e.LENGTH)||this}return o(e,t),Object.defineProperty(e.prototype,"c1r1",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c1r2",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c2r1",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c2r2",{get:function(){return this.data[4]},set:function(t){this.data[4]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c3r1",{get:function(){return this.data[6]},set:function(t){this.data[6]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c3r2",{get:function(){return this.data[7]},set:function(t){this.data[7]=t},enumerable:!0,configurable:!0}),e.fromCR=function(t,r,n,o,i,a){var s=new e;return s.c1r1=t,s.c2r1=n,s.c3r1=i,s.c1r2=r,s.c2r2=o,s.c3r2=a,s},e.fromRC=function(t,r,n,o,i,a){var s=new e;return s.c1r1=t,s.c2r1=r,s.c3r1=n,s.c1r2=o,s.c2r2=i,s.c3r2=a,s},e.identity=function(){return e.fromRC(1,0,0,0,1,0)},e.rectToRect=function(t,r,n){var o=new e;return o.setRectToRect(t,r,n),o},e.rotateByAngle=function(t,r){var n=Math.sin(t),o=Math.cos(t);return e.rotateBySinCos(n,o,r)},e.rotateBySinCos=function(t,r,n){var o=new e;return o.setSinCos(t,r,n),o},e.rotateFromPointToPoint=function(t,r,n){var o=n?a.Vec2.fromPointToPoint(n,t):a.Vec2.fromOriginToPoint(t),i=n?a.Vec2.fromPointToPoint(n,r):a.Vec2.fromOriginToPoint(r);o.normalize(),i.normalize();var s=o.cross(i),c=o.dot(i);return e.rotateBySinCos(s,c,n)},e.scale=function(t,r,n){var o=new e;return o.setScale(t,r,n),o},e.scaleFromPointToPoint=function(t,r,n){var o=n?(r.x-n.x)/(t.x-n.x):r.x/t.x,i=n?(r.y-n.y)/(t.y-n.y):r.y/t.y;

return e.scale(o,i,n)},e.stretch=function(t,r){return e.scale(t,t,r)},e.stretchFromPointToPoint=function(t,r,n){var o=i.distance(t,n),a=i.distance(r,n),s=a/o;return e.stretch(s,n)},e.stretchRotateFromPointToPoint=function(t,r,n){var o=n?a.Vec2.fromPointToPoint(n,t):a.Vec2.fromOriginToPoint(t),i=n?a.Vec2.fromPointToPoint(n,r):a.Vec2.fromOriginToPoint(r),s=o.length(),c=i.length(),u=c/s;o.divScalar(s),i.divScalar(c);var p=o.cross(i),h=o.dot(i),f=new e;return f.setSinCos(p,h),f.postStretch(u),n&&f.conjugateByTranslation(n.x,n.y),f},e.translate=function(t,r){return e.fromRC(1,0,t,0,1,r)},e.translateFromPointToPoint=function(t,r){return e.translate(r.x-t.x,r.y-t.y)},e.concat=function(t,r){var n=new e;return n.setConcat(t,r),n},e.prototype.determinant=function(){return this.c1r1*this.c2r2-this.c2r1*this.c1r2},e.prototype.inverse=function(){var t=new e;return this.invert(t),t},e.prototype.invert=function(t){void 0===t&&(t=this);var e=1/this.determinant(),r=this.c1r1,n=this.c2r1,o=this.c3r1,i=this.c1r2,a=this.c2r2,s=this.c3r2;t.c1r1=a*e,t.c2r1=-n*e,t.c3r1=(n*s-o*a)*e,t.c1r2=-i*e,t.c2r2=r*e,t.c3r2=(i*o-r*s)*e},e.prototype.postConcat=function(t,e){void 0===e&&(e=this),e.setConcat(t,this)},e.prototype.preConcat=function(t,e){void 0===e&&(e=this),this.setConcat(this,t)},e.prototype.postRotate=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.c1r1,o=this.c2r1,i=this.c3r1;this.c1r1=r*n-e*this.c1r2,this.c2r1=r*o-e*this.c2r2,this.c3r1=r*i-e*this.c3r2,this.c1r2=e*n+r*this.c1r2,this.c2r2=e*o+r*this.c2r2,this.c3r2=e*i+e*this.c3r2},e.prototype.preRotate=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.c1r1,o=this.c1r2;this.c1r1=n*r+this.c2r1*e,this.c1r2=o*r+this.c2r2*e,this.c2r1=n*-e+this.c2r1*r,this.c2r2=o*-e+this.c2r2*r},e.prototype.postScale=function(t,e){this.c1r1*=t,this.c2r1*=t,this.c3r1*=t,this.c1r2*=e,this.c2r2*=e,this.c3r2*=e},e.prototype.preScale=function(t,e){this.c1r1*=t,this.c1r2*=t,this.c2r1*=e,this.c2r2*=e},e.prototype.postStretch=function(t){this.postScale(t,t)},e.prototype.preStretch=function(t){this.preScale(t,t)},e.prototype.postTranslate=function(t,e){this.c3r1+=t,this.c3r2+=e},e.prototype.preTranslate=function(t,e){this.c3r1+=this.c1r1*t+this.c2r1*e,this.c3r2+=this.c1r2*t+this.c2r2*e},e.prototype.conjugateByTranslation=function(t,e){this.preTranslate(-t,-e),this.postTranslate(t,e)},e.prototype.setConcat=function(t,e){var r=t.c1r1*e.c1r1+t.c2r1*e.c1r2,n=t.c1r1*e.c2r1+t.c2r1*e.c2r2,o=t.c1r1*e.c3r1+t.c2r1*e.c3r2+t.c3r1,i=t.c1r2*e.c1r1+t.c2r2*e.c1r2,a=t.c1r2*e.c2r1+t.c2r2*e.c2r2,s=t.c1r2*e.c3r1+t.c2r2*e.c3r2+t.c3r2;this.c1r1=r,this.c2r1=n,this.c3r1=o,this.c1r2=i,this.c2r2=a,this.c3r2=s},e.prototype.setIdentity=function(){this.c1r1=1,this.c2r1=0,this.c3r1=0,this.c1r2=0,this.c2r2=1,this.c3r2=0},e.prototype.setRectToNdc=function(t){var e=2/t.width(),r=2/t.height(),n=t.centerX(),o=t.centerY();this.c1r1=e,this.c2r1=0,this.c3r1=-n*e,this.c1r2=0,this.c2r2=r,this.c3r2=-o*r},e.prototype.setRectToRect=function(t,e,r){var n,o;switch(r){case 0:n=t.center(),o=e.center();break;case 1:n=t.bottomRight(),o=e.bottomRight();break;default:n=t.topLeft(),o=e.topLeft()}var i=e.width()/t.width(),a=e.height()/t.height();this.setTranslate(-n.x,-n.y),2===r?this.postScale(i,a):this.postStretch(Math.min(i,a)),this.postTranslate(o.x,o.y)},e.prototype.setRotate=function(t,e){var r=Math.sin(t),n=Math.cos(t);this.setSinCos(r,n,e)},e.prototype.setSinCos=function(t,e,r){this.c1r1=e,this.c2r1=-t,this.c3r1=0,this.c1r2=t,this.c2r2=e,this.c3r2=0,r&&this.conjugateByTranslation(r.x,r.y)},e.prototype.setScale=function(t,e,r){this.c1r1=t,this.c2r1=0,this.c3r1=0,this.c1r2=0,this.c2r2=e,this.c3r2=0,r&&this.conjugateByTranslation(r.x,r.y)},e.prototype.setStretch=function(t,e){this.setScale(t,t,e)},e.prototype.setTranslate=function(t,e){this.c1r1=1,this.c2r1=0,this.c3r1=t,this.c1r2=0,this.c2r2=1,this.c3r2=e},e.prototype.mapX=function(t,e){return this.c1r1*t+this.c2r1*e+this.c3r1},e.prototype.mapY=function(t,e){return this.c1r2*t+this.c2r2*e+this.c3r2},e.prototype.map=function(t,e,r){return void 0===r&&(r=i.point()),r.x=this.mapX(t,e),r.y=this.mapY(t,e),r},e.prototype.mapPoint=function(t,e){return void 0===e&&(e=i.point()),this.map(t.x,t.y,e)},e.prototype.mapPoints=function(t,e,r,n,o){void 0===n&&(n=t),void 0===o&&(o=e);for(var i=0;r>i;i++){var a=t[e++],s=t[e++];n[o++]=this.mapX(a,s),n[o++]=this.mapY(a,s)}},e.prototype.mapRect=function(t,e){void 0===e&&(e=new s.Rect);var r=t.topLeft(),n=t.bottomLeft(),o=t.bottomRight(),i=t.topRight();return this.mapPoint(r,r),this.mapPoint(n,n),this.mapPoint(o,o),this.mapPoint(i,i),e.left=e.right=r.x,e.top=e.bottom=r.y,e.unionPoint(n),e.unionPoint(o),e.unionPoint(i),e},e}(u);h.LENGTH=9,r.Mat2d=h;var f=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(64)),void 0===n&&(n=0),t.call(this,r,n,e.LENGTH)||this}return o(e,t),e.prototype.setOrtho=function(t,e,r){n(t.left,t.right,t.bottom,t.top,e,r,this.data)},e}(u);f.LENGTH=16,r.Mat4=f},{"../data/attrib":1,"./point":12,"./rect":13,"./vector":15}],12:[function(t,e,r){"use strict";function n(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),{x:t,y:e}}function o(t){return{x:t.x,y:t.y}}function i(t,e,r){return void 0===r&&(r=n()),r.x=t.x+e.x,r.y=t.y+e.y,r}function a(t,e,r){return void 0===r&&(r=n()),r.x=t.x-e.x,r.y=t.y-e.y,r}function s(t,e,r){return void 0===r&&(r=n()),r.x=.5*(t.x+e.x),r.y=.5*(t.y+e.y),r}function c(t,e){return Math.sqrt(u(t,e))}function u(t,e){var r=e?e.x-t.x:t.x,n=e?e.y-t.y:t.y;return r*r+n*n}Object.defineProperty(r,"__esModule",{value:!0}),r.point=n,r.copy=o,r.add=i,r.subtract=a,r.midpoint=s,r.distance=c,r.distance2=u},{}],13:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./point"),i=t("../data/attrib"),a=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(16)),void 0===n&&(n=0),t.call(this,new Float32Array(r,n,e.LENGTH))||this}return n(e,t),Object.defineProperty(e.prototype,"left",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),e.withLTRB=function(t,r,n,o){var i=new e;return i.left=t,i.top=r,i.right=n,i.bottom=o,i},e.withLBRT=function(t,r,n,o){return e.withLTRB(t,o,n,r)},e.withLRBT=function(t,r,n,o){return e.withLTRB(t,o,r,n)},e.withLTWH=function(t,r,n,o){return e.withLTRB(t,r,t+n,r-o)},e.withLBWH=function(t,r,n,o){return e.withLBRT(t,r,t+n,r+o)},e.fromRect=function(t){var r=new e;return r.setFromAttrib(t),r},e.fromPointToPoint=function(t,r){var n=e.withLTRB(t.x,t.y,t.x,t.y);return n.unionPoint(r),n},e.fromUnion=function(t,r,n){var o=new e;return o.setUnion(t,r,n),o},e.fromIntersection=function(t,r){var n=e.fromRect(t);return n.intersectRect(r),n},e.prototype.isEmpty=function(){this.left>=this.right||this.bottom>=this.top},e.prototype.isValid=function(){return this.right>=this.left&&this.top>=this.bottom},e.prototype.width=function(){return this.right-this.left},e.prototype.height=function(){return this.top-this.bottom},e.prototype.area=function(){return this.width()*this.height()},e.prototype.centerX=function(){return.5*(this.left+this.right)},e.prototype.centerY=function(){return.5*(this.bottom+this.top)},e.prototype.center=function(){return o.point(this.centerX(),this.centerY())},e.prototype.centerTop=function(){return o.point(this.centerX(),this.top)},e.prototype.centerBottom=function(){return o.point(this.centerX(),this.bottom)},e.prototype.centerLeft=function(){return o.point(this.left,this.centerY())},e.prototype.centerRight=function(){return o.point(this.left,this.centerY())},e.prototype.bottomLeft=function(){return o.point(this.left,this.bottom)},e.prototype.bottomRight=function(){return o.point(this.right,this.bottom)},e.prototype.topLeft=function(){return o.point(this.left,this.top)},e.prototype.topRight=function(){return o.point(this.right,this.top)},e.prototype.setEmpty=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},e.prototype.setUnion=function(t,e,r){this.left=this.right=t[e++],this.top=this.bottom=t[e++],this.unionPoints(t,e,r-1)},e.prototype.contains=function(t,e){return this.left<=t&&t<=this.right&&this.bottom<=e&&e<=this.top},e.prototype.containsPoint=function(t){return this.contains(t.x,t.y)},e.prototype.containsRect=function(t){return this.left<=t.left&&t.right<=this.right&&this.bottom<=t.bottom&&t.top<=this.top},e.prototype.intersectRect=function(t){this.left=Math.max(this.left,t.left),this.right=Math.min(this.right,t.right),this.bottom=Math.max(this.bottom,t.bottom),this.top=Math.min(this.top,t.top)},e.prototype.intersectsRect=function(t){return this.right>=t.left&&t.right>=this.left&&this.top>=t.bottom&&t.top>=this.bottom},e.prototype.intersectsRectByPercent=function(t,r){var n=e.fromIntersection(this,t);return n.isValid()&&n.area()/t.area()>=r},e.prototype.union=function(t,e){this.left=Math.min(t,this.left),this.top=Math.max(e,this.top),this.right=Math.max(t,this.right),this.bottom=Math.min(e,this.bottom)},e.prototype.unionPoint=function(t){this.union(t.x,t.y)},e.prototype.unionPoints=function(t,e,r){for(var n=0;r>n;n++)this.union(t[e++],t[e++])},e.prototype.unionRect=function(t){this.left=Math.min(this.left,t.left),this.right=Math.max(this.right,t.right),this.bottom=Math.min(this.bottom,t.bottom),this.top=Math.max(this.top,t.top)},e.prototype.inset=function(t,e){this.left+=t,this.top-=e,this.right-=t,this.bottom+=e},e.prototype.offset=function(t,e){this.left+=t,this.top+=e,this.right+=t,this.bottom+=e},e.prototype.scale=function(t,e){var r=this.centerX(),n=this.centerY();this.offset(-r,-n),this.left*=t,this.right*=t,this.bottom*=e,this.top*=e,this.offset(r,n)},e.prototype.stretch=function(t){this.scale(t,t)},e.prototype.shrinkToSquare=function(){var t=this.width(),e=this.height();e>t?this.scale(1,t/e):t>e&&this.scale(e/t,1)},e.prototype.expandToSquare=function(){var t=this.width(),e=this.height();e>t?this.scale(e/t,1):t>e&&this.scale(1,t/e)},e.prototype.sort=function(){if(this.bottom>this.top){var t=this.top;this.top=this.bottom,this.bottom=t}if(this.left>this.right){var e=this.right;this.right=this.left,this.left=e}},e.prototype.toString=function(){return"{left: "+this.left+", right: "+this.right+", bottom: "+this.bottom+", top: "+this.top+", width: "+this.width()+", height: "+this.height()+"}"},e}(i.Attrib);a.LENGTH=4,r.Rect=a},{"../data/attrib":1,"./point":12}],14:[function(t,e,r){"use strict";function n(t,e,r){return t>r?t:r>e?e:r}function o(t,e){return Math.floor(Math.random()*(e-t+1))+t}Object.defineProperty(r,"__esModule",{value:!0}),r.clamp=n,r.randomInt=o},{}],15:[function(t,e,r){"use strict";function n(t,e){var r=new p;return r.x=t,r.y=e,r}function o(t,e,r){var n=new h;return n.x=t,n.y=e,n.z=r,n}function i(t,e,r,n){var o=new f;return o.x=t,o.y=e,o.z=r,o.w=n,o}var a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var s=t("../data/attrib"),c=t("../data/util"),u=function(t){function e(e,r,n){return t.call(this,new Float32Array(e,r,n))||this}return a(e,t),e.prototype.length=function(){return c.length(this.data)},e.prototype.length2=function(){return c.length2(this.data)},e.prototype.dot=function(t){return c.dot(this.data,t.data)},e.prototype.normalize=function(t){void 0===t&&(t=this),c.normalize(this.data,t.data)},e.prototype.lerp=function(t,e,r){void 0===r&&(r=this),c.lerp(this.data,t.data,e,r.data)},e.prototype.fract=function(t){void 0===t&&(t=this),c.fract(this.data,t.data)},e.prototype.mod=function(t,e){void 0===e&&(e=this),c.mod(this.data,t,e.data)},e}(s.Attrib);r.Vec=u;var p=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(8)),void 0===n&&(n=0),t.call(this,r,n,e.LENGTH)||this}return a(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),e.fromVec2=function(t){return n(t.x,t.y)},e.fromOriginToPoint=function(t){return n(t.x,t.y)},e.fromPointToPoint=function(t,e){return n(e.x-t.x,e.y-t.y)},e.prototype.set=function(t,e){this.x=t,this.y=e},e.prototype.cross=function(t){return this.x*t.y-this.y*t.x},e.prototype.rotateLeft=function(t){void 0===t&&(t=this),t.set(-t.y,t.x)},e.prototype.rotateRight=function(t){void 0===t&&(t=this),t.set(t.y,-t.x)},e.prototype.toString=function(){return"{x: "+this.x+", y: "+this.y+"}"},e}(u);p.LENGTH=2,r.Vec2=p;var h=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(12)),void 0===n&&(n=0),t.call(this,r,n,e.LENGTH)||this}return a(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),e.fromVec3=function(t){return o(t.x,t.y,t.z)},e.prototype.set=function(t,e,r){this.x=t,this.y=e,this.z=r},e.prototype.toString=function(){return"{x: "+this.x+", y: "+this.y+", z: "+this.z+"}"},e}(u);h.LENGTH=3,r.Vec3=h;var f=function(t){function e(r,n){return void 0===r&&(r=new ArrayBuffer(16)),void 0===n&&(n=0),t.call(this,r,n,e.LENGTH)||this}return a(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),e.fromVec4=function(t){return i(t.x,t.y,t.z,t.w)},e.prototype.set=function(t,e,r){this.x=t,this.y=e,this.z=r},e.prototype.toString=function(){return"{x: "+this.x+", y: "+this.y+", z: "+this.z+", w: "+this.w+"}"},e}(u);f.LENGTH=4,r.Vec4=f,r.vec2=n,r.vec3=o,r.vec4=i;var d=function(t){function e(e,r){return void 0===r&&(r=0),t.call(this,e,r)||this}return a(e,t),e.withCapacity=function(t){return new e(new Float32Array(t*p.LENGTH))},e.prototype.attribLength=function(){return p.LENGTH},e.prototype.get=function(t){return new p(this.data.buffer,t*p.LENGTH*Float32Array.BYTES_PER_ELEMENT)},e.prototype.set=function(t,e,r){var n=t*this.attribLength();this.data[n++]=e,this.data[n]=r},e.prototype.append=function(t,e){this.set(this.size++,t,e)},e.prototype.forEach=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=this.size);for(var n=p.LENGTH*e,o=0;r>o;o++)t(this.data[n++],this.data[n++],e++)},e}(s.AttribArray);r.Vec2Array=d},{"../data/attrib":1,"../data/util":7}],16:[function(t,e,r){"use strict";function n(t,e){for(var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o={},i=0;r>i;i++){var a=t.getActiveUniform(e,i).name;o[a]=t.getUniformLocation(e,a)}for(var s={},i=0;n>i;i++){var c=t.getActiveAttrib(e,i).name;s[c]=t.getAttribLocation(e,c)}return{location:e,uniforms:o,attribs:s}}function o(t,e){return n(t,i.createProgramFromShaderSources(t,e.vs,e.fs))}Object.defineProperty(r,"__esModule",{value:!0});var i=t("./util");r.extractProgramInfo=n,r.createProgramInfo=o;var a=function(){function t(t,e){this.location=t.location,this.uniforms=t.uniforms,this.attribs=t.attribs,this.bindings=e}return t}();r.Program=a},{"./util":20}],17:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../math/point"),o=t("../math/vector"),i=t("../math/rect"),a=t("../math/matrix"),s=function(){function t(t,e,r){this.region=new i.Rect,this.matrix=new a.Mat4,this.zoom=1,this.pan=new o.Vec2,this.bounds=t,this.minZoom=e,this.maxZoom=r}return t.prototype.fillViewport=function(t,e){this.region.setFromAttrib(this.bounds);var r=this.bounds.width(),n=this.bounds.height(),o=t/e,i=r/n;o>i?this.region.scale(o/i,1):this.region.scale(1,i/o),this.region.stretch(1/this.zoom),this.region.offset(this.pan.x,this.pan.y),this.applyChangesToMatrix()},t.prototype.panByVector=function(t){this.applyChangeInPan(t),this.applyChangesToMatrix()},t.prototype.zoomToPoint=function(t,e){var r=this.region,i=(e.x-r.left)/r.width(),a=(e.y-r.bottom)/r.height();this.applyChangeInZoom(t);var s=n.point();s.x=r.left+i*r.width(),s.y=r.bottom+a*r.height();var c=o.Vec2.fromPointToPoint(s,e);this.applyChangeInPan(c),this.applyChangesToMatrix()},t.prototype.applyChangeInZoom=function(t){var e=this.zoom*t;return e<this.minZoom?(t=this.minZoom/this.zoom,this.zoom=this.minZoom):e>this.maxZoom?(t=this.maxZoom/this.zoom,this.zoom=this.maxZoom):this.zoom=e,this.region.stretch(1/t),t},t.prototype.applyChangeInPan=function(t){var e=new o.Vec2;e.add(this.pan),e.add(t);var r=i.Rect.fromRect(this.bounds);return r.mulScalar((this.zoom-this.minZoom)/this.zoom),r.offset(-r.centerX(),-r.centerY()),e.x<r.left?t.x=r.left-this.pan.x:e.x>r.right&&(t.x=r.right-this.pan.x),e.y<r.bottom?t.y=r.bottom-this.pan.y:e.y>r.top&&(t.y=r.top-this.pan.y),this.region.offset(t.x,t.y),this.pan.add(t),t},t.prototype.applyChangesToMatrix=function(){this.matrix.setOrtho(this.region,.1,10)},t}();r.Projection=s},{"../math/matrix":11,"../math/point":12,"../math/rect":13,"../math/vector":15}],18:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function t(t,e,r,n){this.needToRender=!1,this.gl=t,this.projection=e,this.programs=r,this.drawables=n}return t.prototype.onSurfaceChanged=function(t,e){this.gl.viewport(0,0,t,e),this.projection.fillViewport(t,e),this.needToRender=!0},t.prototype.useProgram=function(t){this.currentProgram!==t&&(t.bind(this.gl),this.currentProgram=t)},t}();r.Renderer=n},{}],19:[function(t,e,r){"use strict";function n(t,e,r,n){function o(t,r){return{src:t,status:r,pointers:[e.screenToWorld(t)]}}function i(t,e){return{src:t,status:e,pointers:a(t)}}function a(t){for(var r=[],n=t.touches,o=0;o<n.length;o++)r[o]=e.screenToWorld(n[o]);return r}var s=!1;t.addEventListener("mousedown",function(t){t.target===e.canvas&&(s=!0,t.preventDefault(),t.stopPropagation(),r(o(t,0)))},!1),t.addEventListener("mousemove",function(t){s&&(t.preventDefault(),t.stopPropagation(),r(o(t,1)))},!1),t.addEventListener("mouseout",function(t){s&&(t.preventDefault(),t.stopPropagation(),r(o(t,3)))},!1),t.addEventListener("mouseup",function(t){s&&(t.preventDefault(),t.stopPropagation(),s=!1,r(o(t,2)))},!1),t.addEventListener("touchstart",function(t){t.target===e.canvas&&(s=!0,t.preventDefault(),t.stopPropagation(),n(i(t,0)))},!1),t.addEventListener("touchmove",function(t){s&&(t.preventDefault(),t.stopPropagation(),n(i(t,1)))},!1),t.addEventListener("touchleave",function(t){s&&(t.preventDefault(),t.stopPropagation(),n(i(t,3)))},!1),t.addEventListener("touchend",function(t){s&&(t.preventDefault(),t.stopPropagation(),s=!1,n(i(t,2)))},!1)}Object.defineProperty(r,"__esModule",{value:!0});var o=t("../math/point"),i=function(){function t(t,e){this.canvas=t,this.renderer=e,this.renderer.onSurfaceCreated()}return t.prototype.requestRender=function(){this.renderer.needToRender=!0},t.prototype.resize=function(t,e){return this.canvas.width!==t||this.canvas.height!==e?(this.canvas.width=t,this.canvas.height=e,this.bb=this.canvas.getBoundingClientRect(),this.renderer.onSurfaceChanged(t,e),!0):!1},t.prototype.screenToCanvas=function(t,e){return void 0===e&&(e=o.point()),e.x=t.clientX-this.bb.left,e.y=t.clientY-this.bb.top,e},t.prototype.screenToNdc=function(t,e){return void 0===e&&(e=o.point()),this.screenToCanvas(t,e),this.canvasToNdc(e,e),e},t.prototype.screenToWorld=function(t,e){return void 0===e&&(e=o.point()),this.screenToCanvas(t,e),this.canvasToNdc(e,e),this.ndcToWorld(e,e),e},t.prototype.canvasToNdc=function(t,e){void 0===e&&(e=o.point());var r=this.bb.width,n=this.bb.height;return e.x=t.x/r,e.y=(n-t.y)/n,e},t.prototype.ndcToWorld=function(t,e){void 0===e&&(e=o.point());var r=this.renderer.projection.region;return e.x=r.left+t.x*r.width(),e.y=r.bottom+t.y*r.height(),e},t}();r.Surface=i,r.addSurfaceListener=n},{"../math/point":12}],20:[function(t,e,r){"use strict";function n(t,e,r){void 0===r&&(r=t.STATIC_DRAW);var n=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,e,r),n}function o(t,e,r){void 0===r&&(r=t.STATIC_DRAW);var n=t.createBuffer();return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,r),n}function i(t,e,r){var n=t.createShader(r);t.shaderSource(n,e),t.compileShader(n);var o=t.getShaderParameter(n,t.COMPILE_STATUS);if(!o)throw"could not compile shader:"+t.getShaderInfoLog(n);return n}function a(t,e,r){var n=t.createProgram();t.attachShader(n,e),t.attachShader(n,r),t.linkProgram(n);var o=t.getProgramParameter(n,t.LINK_STATUS);if(!o)throw"program filed to link:"+t.getProgramInfoLog(n);return n}function s(t,e,r){var n=i(t,e,t.VERTEX_SHADER),o=i(t,r,t.FRAGMENT_SHADER);return a(t,n,o)}Object.defineProperty(r,"__esModule",{value:!0}),r.createArrayBuffer=n,r.createElementBuffer=o,r.compileShader=i,r.createProgramFromShaders=a,r.createProgramFromShaderSources=s},{}],21:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=-t-e),this.q=t,this.r=e,this.s=r}return t.fromCube=function(e){return new t(e.q,e.r,e.s)},t.prototype.set=function(t,e,r){void 0===r&&(r=-t-e),this.q=t,this.r=e,this.s=r},t.prototype.distanceToCube=function(t){return Math.max(Math.abs(this.q-t.q),Math.abs(this.r-t.r),Math.abs(this.s-t.s))},t.prototype.distanceToOrigin=function(){return Math.max(Math.abs(this.q),Math.abs(this.r),Math.abs(this.s))},t.prototype.neighbor=function(e,n){return void 0===n&&(n=new t),this.add(r.Directions[e],n)},t.prototype.directionToNeighbor=function(e){for(var n=e.subtract(this,new t),o=0;o<r.Directions.length;o++)if(r.Directions[o].equals(n))return o;return-1},t.prototype.forEachNeighbor=function(t){for(var e=0;e<r.Directions.length;e++)t(this.neighbor(e))},t.prototype.add=function(t,e){return void 0===e&&(e=this),e.q=this.q+t.q,e.r=this.r+t.r,e.s=this.s+t.s,e},t.prototype.subtract=function(t,e){return void 0===e&&(e=this),e.q=this.q-t.q,e.r=this.r-t.r,e.s=this.s-t.s,e},t.prototype.mulScalar=function(t,e){return void 0===e&&(e=this),e.q=this.q*t,e.r=this.r*t,e.s=this.s*t,e},t.prototype.divScalar=function(t,e){return void 0===e&&(e=this),e.q=this.q/t,e.r=this.r/t,e.s=this.s/t,e},t.prototype.round=function(t){void 0===t&&(t=this);var e=this.q,r=this.r,n=this.s;t.q=Math.round(e),t.r=Math.round(r),t.s=Math.round(n);var o=Math.abs(t.q-e),i=Math.abs(t.r-r),a=Math.abs(t.s-n);return o>i&&o>a?t.q=-t.r-t.s:i>a?t.r=-t.q-t.s:t.s=-t.q-t.r,t},t.prototype.equals=function(t){return this.q===t.q&&this.r===t.r&&this.s===t.s},t}();r.Cube=n,r.Directions=[new n(1,-1,0),new n(1,0,-1),new n(0,1,-1),new n(-1,1,0),new n(-1,0,1),new n(0,-1,1)]},{}],22:[function(t,e,r){"use strict";function n(t,e,r){for(var n=e.getImageData(0,0,r.cols,r.rows).data,o=new a.ColorArray(new Uint8Array(n.buffer)),i=0;i<n.length;i++){var s=o.getRgba(i);0!==s&&r.hexels.mixRgba(i,s)}}function o(t,e,r,n){for(var o=t.hexels,i=a.ColorArray.withCapacity(o.capacity),s=0;s<o.capacity;s++){var c=o.getRgba(s);c!==e&&i.setFromRgbaInt(s,c)}var u=new Uint8ClampedArray(i.data.buffer),p=new ImageData(u,t.cols,t.rows);n.clearRect(0,0,r.width,r.height),n.putImageData(p,0,0)}Object.defineProperty(r,"__esModule",{value:!0});var i=t("./cube"),a=t("../graphics/data/color"),s=t("../graphics/math/point"),c=t("../graphics/math/rect"),u=t("../graphics/data/bit");r.H_WIDTH=Math.sqrt(3),r.H_HEIGHT=2,r.H_RIGHT=r.H_WIDTH/2,r.H_UP=r.H_HEIGHT/4;var p=function(){function t(t,e,n){void 0===n&&(n=a.ColorArray.withCapacity(t*e)),this.hasGradient=!0,this.cols=t,this.rows=e,this.hexels=n;var o=-r.H_WIDTH/2,i=-r.H_HEIGHT/2,s=r.H_WIDTH*(this.cols+.5),u=r.H_HEIGHT*(.75*this.rows+.25);this.bounds=c.Rect.withLBWH(o,i,s,u)}return t.prototype.cubeAt=function(t){var e=t/this.cols>>0,r=t%this.cols-(e>>1);return new i.Cube(r,e)},t.prototype.offsetAt=function(t){var e=t/this.cols>>0,r=t%this.cols;return s.point(r,e)},t.prototype.indexOfHexel=function(t){var e=this.pointToCube(t).round();return this.indexOfCube(e)},t.prototype.indexOfCube=function(t){if(0<=t.r&&t.r<this.rows){var e=t.r>>1;if(-e<=t.q&&t.q<this.cols-e)return this.cols*t.r+t.q+e}return-1},t.prototype.indexOfOffset=function(t){return 0<=t.x&&t.x<this.cols&&0<=t.y&&t.y<this.rows?this.cols*t.y+t.x:-1},t.prototype.cubeToPoint=function(t){var e=r.H_WIDTH*(t.q+t.r/2),n=.75*r.H_HEIGHT*t.r;return s.point(e,this.bounds.top-n)},t.prototype.pointToCube=function(t){var e=t.x,n=this.bounds.top-t.y,o=(r.H_WIDTH*e-n)/3,a=r.H_HEIGHT*n/3;return new i.Cube(o,a)},t.prototype.forEachCenterVertex=function(t,e){void 0===e&&(e=this.rows);for(var n=0,o=0;e>o;o++)for(var i=this.bounds.top-r.H_HEIGHT*(.75*o+.5),a=o/2-(o>>1),s=a+this.cols,c=a;s>c;c++){var u=r.H_WIDTH*c;t(u,i,n++)}},t.prototype.forEachCubicCoordinate=function(t){for(var e=0;e<this.rows;e++)for(var r=e>>1,n=-r;n<this.cols-r;n++)t(new i.Cube(n,e))},t.prototype.forEachOffsetCoordinate=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.cols;r++)t(s.point(r,e))},t.prototype.clear=function(t){this.hexels.setEachAttrib(t)},t.prototype.addBinaryImage=function(t){var e=this;t.color.isOpaque()?t.forEachSetBit(this.cols,function(r){e.hexels.setFromAttrib(r,t.color)}):t.forEachSetBit(this.cols,function(r){e.hexels.mix(r,t.color)})},t.prototype.addLine=function(t,e,r,n){var o=this;void 0===n&&(n=this.bitArray());var i=.5*e;return this.forEachCenterVertex(function(e,a,s){t.contains(e,a,i)&&(o.hexels.mix(s,r),n.set(s))}),n},t.prototype.addShape=function(t,e,r){var n=this;return void 0===r&&(r=this.bitArray()),this.forEachCenterVertex(function(o,i,a){t.contains(o,i)&&(n.hexels.mix(a,e),r.set(a))}),r},t.prototype.beginStroke=function(t,e,r,n){var o=this;return void 0===n&&(n=this.bitArray()),this.forEachHexelInRange(t,e,function(t){o.hexels.mix(t,r),n.set(t)}),n},t.prototype.continueStroke=function(t,e,r,n,o){var i=this;void 0===o&&(o=this.bitArray());var a=t;return this.forEachCubeInLine(t,e,function(t){i.appendHexagon(a,t,r,n,o),a=t}),o},t.prototype.appendHexagon=function(t,e,r,n,o){if(void 0===o&&(o=this.bitArray()),0===r){var a=this.indexOfCube(e);-1===a||o.get(a)||(this.hexels.mix(a,n),o.set(a))}else{var s=t.directionToNeighbor(e);if(-1===s)return;var c=new i.Cube;c.add(i.Directions[s>0?s-1:5]),c.mulScalar(r),c.add(e);var a=this.indexOfCube(c);-1===a||o.get(a)||(this.hexels.mix(a,n),o.set(a));for(var u=s+1;s+3>u;u++)for(var p=0;r>p;p++){c.neighbor(u%6,c);var h=this.indexOfCube(c);-1===h||o.get(h)||(this.hexels.mix(h,n),o.set(h))}}},t.prototype.forEachHexelInRange=function(t,e,r){for(var n=new i.Cube,o=-e;e>=o;o++){var a=Math.max(-e,-o-e),s=Math.min(e,-o+e);n.q=t.q+o;for(var c=a;s>=c;c++){n.r=t.r+c;var u=this.indexOfCube(n);-1!==u&&r(u)}}},t.prototype.forEachHexelInRing=function(t,e,r){if(0===e){var n=this.indexOfCube(t);-1!==n&&r(n)}else{var o=new i.Cube;o.add(i.Directions[4]),o.mulScalar(e),o.add(t);for(var a=0;6>a;a++)for(var s=0;e>s;s++){var n=this.indexOfCube(o);-1!==n&&r(n),o.neighbor(a,o)}}},t.prototype.floodFill=function(t,e,r){void 0===r&&(r=this.bitArray());var n=this.hexels.get(t),o=a.blend(e,n);return n.equals(o)?r:this.floodFillScanLine(t,o.toRgbaInt(),n.toRgbaInt(),r)},t.prototype.forEachCubeInLine=function(t,e,r){for(var n=new i.Cube(e.q-t.q,e.r-t.r),o=n.distanceToOrigin(),a=1/Math.max(o,1),s=0;o>=s;s++){var c=a*s,u=new i.Cube;u.q=t.q+n.q*c,u.r=t.r+n.r*c,u.s=t.s+n.s*c,r(u.round())}},t.prototype.floodFillScanLine=function(t,e,r,n){void 0===n&&(n=this.bitArray());var o,i,a,c,u,p,h,f=this.cols,d=this.rows,l=this.hexels,v=[],y=this.offsetAt(t);for(v.push(y);v.length>0;){for(y=v.pop(),p=y.x,h=y.y,o=h*f,i=o-f,a=o+f,c=!1,u=!1;p>=0&&l.getRgba(p+o)===r;)p--;for(0==(1&h)&&p>=0&&(h>0&&l.getRgba(p+i)===r&&(v.push(s.point(p,h-1)),c=!0),d-1>h&&l.getRgba(p+a)===r&&(v.push(s.point(p,h+1)),u=!0)),p++;f>p&&l.getRgba(p+o)===r;p++){var g=p+o;l.setFromRgbaInt(g,e),n.set(g),h>0&&(c||l.getRgba(p+i)!==r?c&&l.getRgba(p+i)!==r&&(c=!1):(v.push(s.point(p,h-1)),c=!0)),d-1>h&&(u||l.getRgba(p+a)!==r?u&&l.getRgba(p+a)!==r&&(u=!1):(v.push(s.point(p,h+1)),u=!0))}1&h&&f>p&&(!c&&h>0&&l.getRgba(p+i)===r&&v.push(s.point(p,h-1)),!u&&d-1>h&&l.getRgba(p+a)===r&&v.push(s.point(p,h+1)))}return n},t.prototype.bitArray=function(){return u.BitArray.withCapacity(this.hexels.capacity)},t}();r.Grid=p,r.copyPixelsToGrid=n,r.copyHexelsToCanvas=o},{"../graphics/data/bit":2,"../graphics/data/color":3,"../graphics/math/point":12,"../graphics/math/rect":13,"./cube":21}],23:[function(t,e,r){"use strict";function n(){D.length=0,N.length=0,q=0}function o(t){function e(t){0===t.button&&t.altKey&&(tt.val=I.Color.random(tt.val.a),$("#color-picker").spectrum("set",tt.unparsed.val),gt.color=tt.val)}if(2!==t.src.button){var r=1===t.src.button?z:pt;switch(t.status){case 0:c(),e(t.src),r.onStart&&r.onStart(t);break;case 1:r.onMove&&r.onMove(t);break;case 3:r.onLeave&&r.onLeave(t);break;case 2:r.onEnd&&r.onEnd(t)}}}function i(t){var e=pt;switch(t.pointers.length>1?e=V:V.onEnd(t),t.status){case 0:c(),e.onStart&&e.onStart(t);break;case 1:e.onMove&&e.onMove(t);break;case 3:e.onLeave&&e.onLeave(t);break;case 2:e.onEnd&&e.onEnd(t)}}function a(t){var e=F.BinaryImage.make(t,vt.cols,vt.rows,tt.val);if(e){N.push(e),D.length=0,q+=e.data.data.length;for(var r=function(){var t=N.shift();t.color.isOpaque()?t.forEachSetBit(vt.cols,function(e){yt.setFromAttrib(e,t.color)}):t.forEachSetBit(vt.cols,function(e){yt.mix(e,t.color)}),q-=t.data.data.length};q>U;)r()}}function s(t,e){t.addEventListener("DOMMouseScroll",e,!1),t.addEventListener("mousewheel",e,!1)}function c(){H&&(yt.setFromArray(0,vt.hexels),n(),H=!1)}function u(){function t(){var n=e.outerWidth(),o=e.innerHeight()-r.innerHeight();o>0&&(mt.resize(n,o)||gt.needToRender)&&(gt.needToRender=!1,gt.onDrawFrame()),requestAnimationFrame(t)}var e=$("body"),r=$("#toolbar");t()}function p(t,e){t!=pt&&($(ht).children("i").addClass("md-inactive").removeClass("md-active"),$(e).children("i").addClass("md-active").removeClass("md-inactive"),pt=t,ht=e)}function h(){f(),d(),l(),v(),y(),x(),_(),g(),m(),b()}function f(){$("#color-picker").spectrum({color:tt.unparsed.val,flat:!1,showInput:!1,showInitial:!1,allowEmpty:!1,showAlpha:!0,disabled:!1,showPalette:!0,showPaletteOnly:!0,togglePaletteOnly:!0,showSelectionPalette:!1,clickoutFiresChange:!0,hideAfterPaletteSelect:!0,preferredFormat:"rgb",palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],
change:function(t){if(t){t.setAlpha(ut);var e=t.toHex8String();$(this).spectrum("set",e),tt.val=I.Color.fromArgbString(e),gt.color=tt.val}},hide:function(t){ut=tt.val.a/255}}),$("#color-picker").on("dragstop.spectrum",function(t,e){ut=e.getAlpha()})}function d(){$("#brush").click(function(){p(k,"#brush")});var t=new Slider("input[name=brushRadius]",{min:1,max:50,step:1,value:et.unlerped.val,tooltip:"show"});t.on("slideStop",function(e){et.val=t.getValue()})}function l(){$("#line").click(function(){p(W,"#line")});var t=new Slider("input[name=lineThickness]",{min:1,max:100,step:1,value:rt.unlerped.val,tooltip:"show"});t.on("slideStop",function(e){rt.val=t.getValue(),gt.lineThickness=rt.val})}function v(){function t(t){e!=t&&($("#shape").children("i").removeClass(e).addClass(t),e=t)}var e="icon-circle";$("#shape").click(function(){"icon-circle"==e?p(Z,"#shape"):p(K,"#shape")}),$("input[name=maintainAspect]").change(function(){nt.val=this.checked?!0:!1}),$("#circle").click(function(){p(Z,"#shape"),t("icon-circle")});for(var r=["triangle","square","diamond","pentagon","hexagon","star","heart","flower","bat"],n=function(e){$("#"+r[e]).click(function(){ft=G[e],p(K,"#shape"),t("icon-"+r[e])})},o=0;o<r.length;o++)n(o)}function y(){function t(t,n){r!=n&&($("#other").children("i").removeClass(r).addClass(n),r=n,e=t)}var e=z,r="icon-pan";$("#other").click(function(){p(e,"#other")}),$("#color-sampler").click(function(){p(X,"#other"),t(X,"icon-eyedropper")}),$("#paint-bucket").click(function(){p(Y,"#other"),t(Y,"icon-bucket")}),$("#pan-tool").click(function(){p(z,"#other"),t(z,"icon-pan")})}function g(){function t(){var t='<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n        <label for="enableShadows">Enable shadows:</label>\n        <input name="enableShadows" type="checkbox" '+(ot.val?"checked":"")+'/>\n    </div>\n</div>\n<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n        <label for="zoomSpeed">Zoom speed:</label>\n        <input name="zoomSpeed" type="number" min="1" max="1000" />\n    </div>\n</div>\n<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n          <label for="gridWidth">Grid width:</label>\n          <input name="gridWidth" type="number" min="5" max="10" />\n    </div>\n</div>\n<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n          <label for="gridHeight">Grid height:</label>\n          <input name="gridHeight" type="number" min="5" max="10" />\n    </div>\n</div>';vex.dialog.open({message:"Options",input:t,callback:e}),r()}function e(t){if(t&&(t.enableShadows?ot.val||(vt.hasGradient=ot.val=!0,gt.applyGradientChanges()):ot.val&&(vt.hasGradient=ot.val=!1,gt.applyGradientChanges()),t.zoomSpeed&&(it.val=parseInt(t.zoomSpeed)),t.gridWidth!=at.uninterpolated.val||t.gridHeight!=st.uninterpolated.val)){at.val=parseInt(t.gridWidth),st.val=parseInt(t.gridHeight);var e=bt.width=at.val,r=bt.height=st.val,o=vt;vt=new M.Grid(e,r),vt.clear(J),vt.hasGradient=o.hasGradient;for(var i=new Uint32Array(o.hexels.data.buffer),a=new Uint32Array(vt.hexels.data.buffer),s=Math.min(r,o.rows),c=Math.min(e,o.cols),u=0;s>u;u++)for(var p=0;c>p;p++)a[u*e+p]=i[u*o.cols+p];gt.programs.hexel.setLayout(lt,vt),gt.projection=new C.Projection(vt.bounds,1,Math.max(vt.rows,vt.cols)),gt.projection.fillViewport(dt.clientWidth,dt.clientHeight),gt.needToRender=!0,n(),yt=I.ColorArray.fromColorArray(vt.hexels)}}function r(){$("input[name=zoomSpeed]").slider({min:1,max:1e3,step:1,value:it.unlerped.val,tooltip:"hide"}),$("input[name=gridWidth]").slider({ticks:[5,6,7,8,9],ticks_labels:["32","64","128","256","512"],min:5,max:9,step:1,value:at.uninterpolated.val,tooltip:"hide"}),$("input[name=gridHeight]").slider({ticks:[5,6,7,8,9],ticks_labels:["32","64","128","256","512"],min:5,max:9,step:1,value:st.uninterpolated.val,tooltip:"hide"})}$("#options").click(t)}function m(){function t(){var t="Upload image onto this "+vt.cols+"x"+vt.rows+" grid.",r='<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n        <label for="imagefile">Image:</label>\n        <input name="imagefile" type="file" accept="image/*" required>\n    </div>\n    <div class="vex-custom-input-wrapper">\n        <label for="x">X (hexels from left):</label>\n        <input name="x" type="number" min="0" max="'+vt.cols+'">\n    </div>\n    <div class="vex-custom-input-wrapper">\n        <label for="y">Y (hexels from top):</label>\n        <input name="y" type="number" min="0" max="'+vt.rows+'">\n    </div>\n    <div class="vex-custom-input-wrapper">\n        <label for="width">Width (in hexels):</label>\n        <input name="width" type="number" min="0">\n    </div>\n    <div class="vex-custom-input-wrapper">\n        <label for="height">Height (in hexels):</label>\n        <input name="height" type="number" min="0">\n    </div>\n</div>';vex.dialog.open({message:t,input:r,callback:e}),$("input[name=imagefile]").change(function(t){if(t.target.files[0]){var e=t.target.files[0];n(e,function(t){var e=bt.width/t.width,r=bt.height/t.height,n=Math.min(e,r),i=Math.round(t.width*n),a=Math.round(t.height*n),s=Math.round((bt.width-i)/2),c=Math.round((bt.height-a)/2);$("input[name=x]").val(s),$("input[name=y]").val(c),$("input[name=width]").val(i),$("input[name=height]").val(a),o=t})}})}function e(t){if(o&&t){var e=t.x,n=t.y,i=t.width,a=t.height;r(bt,xt,o,e,n,i,a),M.copyPixelsToGrid(bt,xt,vt),gt.applyColorChanges(),H=!0}}function r(t,e,r,n,o,i,a){void 0===n&&(n=0),void 0===o&&(o=0),void 0===i&&(i=vt.cols),void 0===a&&(a=vt.rows),e.clearRect(0,0,t.width,t.height),e.drawImage(r,0,0,r.width,r.height,n,o,i,a)}function n(t,e){var r=new FileReader;r.onload=function(t){var r=new Image;r.onload=function(){e(r)},r.src=t.target.result},r.readAsDataURL(t)}var o;$("#upload").click(t)}function b(){function t(){var t="Download hexel art as a "+vt.cols+"x"+vt.rows+" image file.",r='<div class="vex-custom-field-wrapper">\n    <div class="vex-custom-input-wrapper">\n        <label for="transparentColor">Transparent color:</label>\n        <input name="transparentColor" type="text" style="display: none" />\n    </div>\n    <br/>\n    <div class="vex-custom-input-wrapper">\n        <label for="filename">Filename:</label>\n        <input name="filename" type="text" value="'+ct.val+'"/>\n    </div>\n</div>\n<p> Note: an image viewer will interpret the file as pixel art, but if you reupload the file to this app, you will be able to view and modify the original hexel art.</p>';vex.dialog.open({message:t,input:r,callback:e}),$("input[name=transparentColor]").spectrum({color:Q.val.isZero()?null:Q.val.toArgbString(),flat:!1,showInput:!0,showInitial:!1,allowEmpty:!0,disabled:!1,showPalette:!0,showPaletteOnly:!0,togglePaletteOnly:!0,showSelectionPalette:!1,clickoutFiresChange:!0,hideAfterPaletteSelect:!0,preferredFormat:"rgb",palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(t){Q.val=t?I.Color.fromArgbString(t.toHex8String()):new I.Color}})}function e(t){t&&t.filename&&(ct.val=t.filename,M.copyHexelsToCanvas(vt,Q.val.toRgbaInt(),bt,xt),bt.toBlob(function(t){saveAs(t,ct.val,!0)},"image/png"))}$("#download").click(t)}function x(){$("#undo").click(function(){if(N.length>0){if(H)H=!1;else{var t=N.pop();D.push(t),q-=t.data.data.length}vt.hexels.setFromArray(0,yt);for(var e=0,r=N;e<r.length;e++){var n=r[e];vt.addBinaryImage(n)}gt.applyColorChanges()}})}function _(){$("#redo").click(function(){if(D.length>0){var t=D.pop();N.push(t),vt.addBinaryImage(t),gt.applyColorChanges()}})}function w(t){return 1<<t}Object.defineProperty(r,"__esModule",{value:!0});var P=t("./graphics/math/ellipse"),T=t("./graphics/math/line"),A=t("./graphics/data/model"),E=t("./graphics/math/point"),R=t("./graphics/data/shape"),C=t("./graphics/rendering/projection"),S=t("./graphics/math/rect"),O=t("./graphics/rendering/surface"),L=t("./graphics/math/vector"),M=t("./hexel/grid"),I=t("./graphics/data/color"),B=t("./renderer"),F=t("./graphics/data/bit"),j=t("./options");vex.defaultOptions.className="vex-theme-wireframe";var H,G=[A.Model.polygon(3),A.Model.square(),A.Model.diamond(),A.Model.polygon(5),A.Model.polygon(6),A.Model.star5(),A.Model.heart(),A.Model.flower(),A.Model.bat()],N=[],D=[],U=15e4,q=0,V={onStart:function(t){var e=t.pointers[0],r=t.pointers[1];this.previousSpan=E.distance(e,r),this.previousFocus=E.midpoint(e,r)},onMove:function(t){if(!this.previousFocus)return void this.onStart(t);var e=gt.projection,r=t.pointers[0],n=t.pointers[1],o=E.distance(r,n),i=e.applyChangeInZoom(o/this.previousSpan);this.previousSpan=o/i;var a=E.midpoint(r,n),s=L.Vec2.fromPointToPoint(a,this.previousFocus);s.divScalar(i),s=e.applyChangeInPan(s),this.previousFocus.x=a.x+s.x,this.previousFocus.y=a.y+s.y,e.applyChangesToMatrix(),gt.needToRender=!0},onEnd:function(t){this.previousFocus=null}},z={onStart:function(t){this.previous=t.pointers[0]},onMove:function(t){if(!this.previous)return void this.onStart(t);var e=t.pointers[0],r=L.Vec2.fromPointToPoint(e,this.previous);gt.projection.panByVector(r),gt.needToRender=!0,this.previous.x=e.x+r.x,this.previous.y=e.y+r.y},onEnd:function(t){this.previous=null}},k={onStart:function(t){var e=vt.pointToCube(t.pointers[0]).round(),r=vt.indexOfCube(e);-1!==r&&(this.record=vt.beginStroke(e,et.val,tt.val),gt.applyColorChanges(),this.previous=e)},onMove:function(t){if(this.previous){var e=vt.pointToCube(t.pointers[0]).round();e.equals(this.previous)||(vt.continueStroke(this.previous,e,et.val,tt.val,this.record),gt.applyColorChanges(),this.previous=e)}else this.onStart(t)},onEnd:function(t){this.record&&a(this.record),this.previous=null,this.record=null}},Y={onStart:function(t){if(!gt.needToRender){var e=t.pointers[0],r=vt.indexOfHexel(e);if(-1!==r){var n=vt.floodFill(r,tt.val);a(n),gt.applyColorChanges()}}}},X={onStart:function(t){this.onMove(t)},onMove:function(t){var e=t.pointers[0],r=vt.indexOfHexel(e);-1!=r&&(tt.val=vt.hexels.get(r),ut=tt.val.a/255,$("#color-picker").spectrum("set",tt.unparsed.val),gt.color=tt.val)}},W={onStart:function(t){this.start=t.pointers[0]},onMove:function(t){if(this.start){var e=t.pointers[0];gt.drawables.line=T.Line.fromPointToPoint(this.start,e),gt.needToRender=!0}},onEnd:function(t){if(this.start=null,gt.drawables.line){var e=vt.addLine(gt.drawables.line,rt.val,tt.val);a(e),gt.drawables.line=null,gt.applyColorChanges()}}},Z={onStart:function(t){this.start=t.pointers[0]},onMove:function(t){if(this.start){var e=t.pointers[0],r=S.Rect.fromPointToPoint(this.start,e);nt.val&&r.expandToSquare(),gt.drawables.ellipse=r,gt.needToRender=!0}},onLeave:function(t){this.onMove(t)},onEnd:function(t){if(this.start=null,gt.drawables.ellipse){var e=vt.addShape(P.Ellipse.fromRect(gt.drawables.ellipse),tt.val);a(e),gt.drawables.ellipse=null,gt.applyColorChanges()}}},K={onStart:function(t){this.start=t.pointers[0]},onMove:function(t){if(this.start){var e=t.pointers[0];if(gt.drawables.shape||(gt.drawables.shape=new R.Shape(ft)),nt.val)gt.drawables.shape.stretchAcrossLine(this.start,e);else{var r=this.start,n=e,o=S.Rect.withLBRT(n.x,n.y,r.x,r.y);gt.drawables.shape.fitInRect(o,2)}gt.needToRender=!0}},onEnd:function(t){if(this.start=null,gt.drawables.shape){var e=vt.addShape(gt.drawables.shape,tt.val);a(e),gt.drawables.shape=null,gt.applyColorChanges()}}},J=I.color(205,205,205,255),Q=j.ColorOption.create("transparentColor",J),tt=j.ColorOption.create("drawColor",I.color(39,78,19,255)),et=j.LerpedOption.create(new j.Lerper(-1,1),j.Option.num("brushRadius",2,1,50)),rt=j.LerpedOption.create(new j.Lerper(0,M.H_WIDTH),j.Option.num("lineThickness",2,1,100)),nt=j.Option.bool("maintainAspect",!0),ot=j.Option.bool("shadowsEnabled",!0),it=j.LerpedOption.create(j.Lerper.fromRange(1,2,1e3),j.Option.num("zoomSpeed",500,1,1e3)),at=j.InterpolatedOption.create(w,j.Option.num("log2cols",7,5,9)),st=j.InterpolatedOption.create(w,j.Option.num("log2rows",7,5,9)),ct=j.Option.str("filename","My Hexel Art"),ut=tt.val.a/255,pt=k,ht="#brush",ft=G[0],dt=document.getElementById("onscreen-canvas"),lt=dt.getContext("webgl"),vt=new M.Grid(at.val,st.val);vt.clear(J),vt.hasGradient=ot.val;var yt=I.ColorArray.fromColorArray(vt.hexels),gt=B.HexelRenderer.create(lt,vt,G);gt.lineThickness=rt.val,gt.color=tt.val;var mt=new O.Surface(dt,gt),bt=document.getElementById("offscreen-canvas"),xt=bt.getContext("2d");bt.width=vt.cols,bt.height=vt.rows,h(),s(dt,function(t){t.preventDefault(),t.stopPropagation();var e=t.detail<0||t.wheelDelta>0,r=e?it.val:1/it.val,n=mt.screenToWorld(t);gt.projection.zoomToPoint(r,n),gt.needToRender=!0}),O.addSurfaceListener(window,mt,o,i),u()},{"./graphics/data/bit":2,"./graphics/data/color":3,"./graphics/data/model":5,"./graphics/data/shape":6,"./graphics/math/ellipse":9,"./graphics/math/line":10,"./graphics/math/point":12,"./graphics/math/rect":13,"./graphics/math/vector":15,"./graphics/rendering/projection":17,"./graphics/rendering/surface":19,"./hexel/grid":22,"./options":24,"./renderer":30}],24:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./graphics/data/color"),o=function(){function t(t,e){this.key=t,this.value=e}return t.get=function(t){return localStorage?localStorage.getItem(t):null},t.bool=function(e,r){var n,o=t.get(e);return n="true"===o?!0:"false"===o?!1:r,new t(e,n)},t.num=function(e,r,n,o){var i=parseInt(t.get(e));return(isNaN(i)||n>i||i>o)&&(i=r),new t(e,i)},t.str=function(e,r){var n=t.get(e),o=n?n:r;return new t(e,o)},Object.defineProperty(t.prototype,"val",{get:function(){return this.value},set:function(t){this.value=t,localStorage&&localStorage.setItem(this.key,t.toString())},enumerable:!0,configurable:!0}),t}();r.Option=o;var i=function(){function t(t,e){this.unparsed=t,this.value=e}return t.create=function(e,r){var i,a=o.str(e,null);return a.val&&n.ArgbRegex.test(a.val)?i=n.Color.fromArgbString(a.val):(i=r,a.val=r.toArgbString()),new t(a,i)},Object.defineProperty(t.prototype,"val",{get:function(){return this.value},set:function(t){this.value=t,this.unparsed.val=t.toArgbString()},enumerable:!0,configurable:!0}),t}();r.ColorOption=i;var a=function(){function t(t,e,r){this.interpolator=t,this.uninterpolated=e,this.value=r}return t.create=function(e,r){var n=e(r.val);return new t(e,r,n)},Object.defineProperty(t.prototype,"val",{get:function(){return this.value},set:function(t){this.uninterpolated.val=t,this.value=this.interpolator(t)},enumerable:!0,configurable:!0}),t}();r.InterpolatedOption=a;var s=function(){function t(t,e,r){this.unlerped=e,this.lerper=t,this.value=r}return t.create=function(e,r){var n=e.lerp(r.val);return new t(e,r,n)},Object.defineProperty(t.prototype,"val",{get:function(){return this.value},set:function(t){this.unlerped.val=t,this.value=this.lerper.lerp(t)},enumerable:!0,configurable:!0}),t}();r.LerpedOption=s;var c=function(){function t(t,e){this.a=t,this.b=e}return t.fromRange=function(e,r,n){return new t(e,(r-e)/n)},t.prototype.lerp=function(t){return this.a+this.b*t},t.prototype.unlerp=function(t){return(t-this.a)/this.b},t}();r.Lerper=c},{"./graphics/data/color":3}],25:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("../graphics/data/indices"),i=t("../graphics/rendering/util"),a=t("../graphics/rendering/program"),s=t("./shaders"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t){var r=a.createProgramInfo(t,s.EllipseProgramSource),n=i.createArrayBuffer(t,new Float32Array([0,1,0,0,1,0,1,1])),c=i.createElementBuffer(t,o.IndexTupleArray.polygonIndices(4).data);return new e(r,{texCoordBuffer:n,elementBuffer:c})},e.prototype.bind=function(t){t.useProgram(this.location),t.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.texCoordBuffer),t.vertexAttribPointer(this.attribs.a_texCoord,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.attribs.a_texCoord),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bindings.elementBuffer)},e.prototype.setProjection=function(t,e){t.uniformMatrix4fv(this.uniforms.u_projection,!1,e.data)},e.prototype.setColor=function(t,e){t.uniform4fv(this.uniforms.u_color,e.data)},e.prototype.setEllipse=function(t,e){t.uniform4fv(this.uniforms.u_rect,e.data)},e.prototype.draw=function(t){t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)},e}(a.Program);r.EllipseProgram=c},{"../graphics/data/indices":4,"../graphics/rendering/program":16,"../graphics/rendering/util":20,"./shaders":28}],26:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("../hexel/grid"),i=t("../graphics/math/point"),a=t("../graphics/math/vector"),s=t("../graphics/rendering/program"),c=t("../graphics/math/vector"),u=t("../graphics/data/indices"),p=t("../graphics/data/vertices"),h=t("./shaders"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.basePosition=new a.Vec2,e.baseTexCoord=new a.Vec2,e}return n(e,t),e.create=function(t,r){var n=s.createProgramInfo(t,h.HexelProgramSource),o=new e(n,{positionBuffer:t.createBuffer(),texCoordBuffer:t.createBuffer(),gradientBuffer:t.createBuffer(),elementBuffer:t.createBuffer(),texture:t.createTexture()});return o.setLayout(t,r),o},e.prototype.bind=function(t){t.useProgram(this.location),t.enable(t.CULL_FACE),t.disable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.positionBuffer),t.vertexAttribPointer(this.attribs.a_position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.attribs.a_position),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.texCoordBuffer),t.vertexAttribPointer(this.attribs.a_texCoord,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.attribs.a_texCoord),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.gradientBuffer),t.vertexAttribPointer(this.attribs.a_gradient,1,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.attribs.a_gradient),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bindings.elementBuffer),t.bindTexture(t.TEXTURE_2D,this.bindings.texture)},e.prototype.setProjection=function(t,e){t.uniformMatrix4fv(this.uniforms.u_projection,!1,e.data)},e.prototype.setColors=function(t,e){t.bindTexture(t.TEXTURE_2D,this.bindings.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.grid.cols,this.grid.rows,0,t.RGBA,t.UNSIGNED_BYTE,e)},e.prototype.updateColors=function(t,e){t.bindTexture(t.TEXTURE_2D,this.bindings.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.grid.cols,this.grid.rows,t.RGBA,t.UNSIGNED_BYTE,e)},e.prototype.setGradient=function(t,e){t.bindBuffer(t.ARRAY_BUFFER,this.bindings.gradientBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)},e.prototype.setTexCoords=function(t,e){t.bindBuffer(t.ARRAY_BUFFER,this.bindings.texCoordBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)},e.prototype.setPositions=function(t,e){t.bindBuffer(t.ARRAY_BUFFER,this.bindings.positionBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)},e.prototype.setIndices=function(t,e){this.elementCount=e.length,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bindings.elementBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)},e.prototype.setLayout=function(t,e){this.grid=e;var r=this.grid,n=r.hexels.capacity;this.hexelsPerSection=Math.min(n,8192),this.sectionsPerLayout=n/this.hexelsPerSection,this.rowsPerSection=this.hexelsPerSection/r.cols,this.sectionHeight=1.5*this.rowsPerSection,this.setPositions(t,this.generateVertices()),this.setTexCoords(t,this.generateTexCoords()),this.setGradient(t,this.generateGradient()),this.setIndices(t,this.generateIndices()),this.setColors(t,e.hexels.data)},e.prototype.applyColorChanges=function(t){this.updateColors(t,this.grid.hexels.data)},e.prototype.applyGradientChanges=function(t){this.setGradient(t,this.generateGradient())},e.prototype.draw=function(t,e){var r=e.region,n=this.grid,o=n.pointToCube(i.point(0,r.top)).r-1,a=n.pointToCube(i.point(0,r.bottom)).r+1,s=Math.max(0,Math.floor(o/this.rowsPerSection)),c=Math.min(this.sectionsPerLayout,Math.ceil(a/this.rowsPerSection)),u=-this.sectionHeight,p=1/this.sectionsPerLayout;this.basePosition.x=0,this.basePosition.y=u*s,this.baseTexCoord.x=0,this.baseTexCoord.y=p*s;for(var h=s;c>h;h++)t.uniform2fv(this.uniforms.u_basePosition,this.basePosition.data),t.uniform2fv(this.uniforms.u_baseTexCoord,this.baseTexCoord.data),t.drawElements(t.TRIANGLES,this.elementCount,t.UNSIGNED_SHORT,0),this.basePosition.y+=u,this.baseTexCoord.y+=p},e.prototype.generateVertices=function(){var t=p.VertexArray.withCapacity(6*this.hexelsPerSection);return this.grid.forEachCenterVertex(function(e,r,n){t.append(e,r+1),t.append(e-o.H_RIGHT,r+o.H_UP),t.append(e-o.H_RIGHT,r-o.H_UP),t.append(e,r-1),t.append(e+o.H_RIGHT,r-o.H_UP),t.append(e+o.H_RIGHT,r+o.H_UP)},this.rowsPerSection),t.data},e.prototype.generateTexCoords=function(){for(var t=c.Vec2Array.withCapacity(6*this.hexelsPerSection),e=this.grid.rows,r=this.grid.cols,n=0;n<this.rowsPerSection;n++)for(var o=(n+.5)/e,i=0;r>i;i++)for(var a=(i+.5)/r,s=0;6>s;s++)t.append(a,o);return t.data},e.prototype.generateIndices=function(){for(var t=u.IndexTupleArray.withCapacity(4*this.hexelsPerSection),e=0;t.size<t.capacity;e+=6)t.append(e,e+1,e+2),t.append(e,e+2,e+3),t.append(e,e+3,e+4),t.append(e,e+4,e+5);return t.data},e.prototype.generateGradient=function(){var t=this.hexelsPerSection,e=new Float32Array(6*t),r=0;if(!this.grid.hasGradient)return e;for(var n=18/256,o=.125,i=50/256,a=0;t>a;a++)e[r++]=n,e[r++]=o,e[r++]=i,e[r++]=-n,e[r++]=-o,e[r++]=-i;return e},e}(s.Program);r.HexelProgram=f},{"../graphics/data/indices":4,"../graphics/data/vertices":8,"../graphics/math/point":12,"../graphics/math/vector":15,"../graphics/rendering/program":16,"../hexel/grid":22,"./shaders":28}],27:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("../graphics/data/indices"),i=t("../graphics/rendering/util"),a=t("../graphics/rendering/program"),s=t("./shaders"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t){var r=a.createProgramInfo(t,s.LineProgramSource),n=i.createArrayBuffer(t,new Float32Array([0,.5,0,-.5,1,-.5,1,.5])),c=i.createElementBuffer(t,o.IndexTupleArray.polygonIndices(4).data);return new e(r,{positionBuffer:n,elementBuffer:c})},e.prototype.bind=function(t){t.useProgram(this.location),t.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.positionBuffer),t.vertexAttribPointer(this.attribs.a_position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.attribs.a_position),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bindings.elementBuffer)},e.prototype.setProjection=function(t,e){t.uniformMatrix4fv(this.uniforms.u_projection,!1,e.data)},e.prototype.setColor=function(t,e){t.uniform4fv(this.uniforms.u_color,e.data)},e.prototype.setThickness=function(t,e){t.uniform1f(this.uniforms.u_thickness,e)},e.prototype.setLine=function(t,e){t.uniform4fv(this.uniforms.u_line,e.data)},e.prototype.draw=function(t){t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)},e}(a.Program);r.LineProgram=c},{"../graphics/data/indices":4,"../graphics/rendering/program":16,"../graphics/rendering/util":20,"./shaders":28}],28:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EllipseProgramSource={vs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform mat4 u_projection;uniform vec4 u_rect;attribute vec2 a_texCoord;varying vec2 v_texCoord;void main(){float left = u_rect[0]; float top = u_rect[1]; float right = u_rect[2]; float bottom = u_rect[3]; float width = right - left; float height = top - bottom; float posX = width * a_texCoord.x + left; float posY = height * a_texCoord.y + bottom; gl_Position = u_projection * vec4(posX, posY, 1.0, 1.0); v_texCoord = a_texCoord;}",fs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform vec4 u_color;varying vec2 v_texCoord;void main(){float dx = v_texCoord.x * 2.0 - 1.0; float dy = v_texCoord.y * 2.0 - 1.0; float dist2 = dx * dx + dy * dy; gl_FragColor = u_color * float(dist2 <= 1.0);}"},r.HexelProgramSource={vs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform sampler2D u_tex;uniform mat4 u_projection;uniform vec2 u_basePosition;uniform vec2 u_baseTexCoord;attribute vec2 a_position;attribute vec2 a_texCoord;attribute float a_gradient;varying vec4 v_color;void main(){gl_Position.xy = u_basePosition + a_position; gl_Position.z = 1.0; gl_Position.w = 1.0; gl_Position = u_projection * gl_Position; v_color = texture2D(u_tex, u_baseTexCoord + a_texCoord); v_color.r += a_gradient; v_color.g += a_gradient; v_color.b += a_gradient; v_color.a = 1.0;}",fs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec4 v_color;void main(){gl_FragColor = v_color;}"},r.LineProgramSource={vs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform mat4 u_projection;uniform vec4 u_line;uniform float u_thickness;attribute vec2 a_position;void main(){vec2 p1 = vec2(u_line[0], u_line[1]); vec2 p2 = vec2(u_line[2], u_line[3]); float width = distance(p1, p2); float height = u_thickness; float sx = width * a_position.x; float sy = height * a_position.y; float hypotenuse = width; float adjacent = p2.x - p1.x; float opposite = p2.y - p1.y; float sin = opposite / hypotenuse; float cos = adjacent / hypotenuse; float rx = cos * sx - sin * sy; float ry = sin * sx + cos * sy; float tx = rx + p1.x; float ty = ry + p1.y; gl_Position = u_projection * vec4(tx, ty, 1.0, 1.0);}",fs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform vec4 u_color;void main(){gl_FragColor = u_color;}"},r.ShapeProgramSource={vs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform mat4 u_projection;uniform mat3 u_model;attribute vec2 a_position;void main(){gl_Position.xy = a_position; gl_Position.z = 1.0; gl_Position.xyz = u_model * gl_Position.xyz; gl_Position.w = 1.0; gl_Position = u_projection * gl_Position;}",fs:"#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform vec4 u_color;void main(){gl_FragColor = u_color;}"}},{}],29:[function(t,e,r){"use strict";function n(t){for(var e=0,r=0,n=0;n<t.length;n++)e+=t[n].vertices.size,r+=t[n].indices.size;for(var o=i.VertexArray.withCapacity(e),s=a.IndexTupleArray.withCapacity(r),c=o.attribLength()*Float32Array.BYTES_PER_ELEMENT,u=s.attribLength()*Uint16Array.BYTES_PER_ELEMENT,n=0;n<t.length;n++){var p=t[n];p.vertexBufferOffset=o.size*c,p.elementBufferOffset=s.size*u,o.appendArray(t[n].vertices),s.appendArray(t[n].indices)}return{vertices:o.data,indices:s.data}}var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=t("../graphics/data/vertices"),a=t("../graphics/data/indices"),s=t("../graphics/rendering/util"),c=t("../graphics/rendering/program"),u=t("./shaders"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.elementCount=0,e.elementOffset=0,e}return o(e,t),e.create=function(t,r){var o=c.createProgramInfo(t,u.ShapeProgramSource),i=n(r),a=s.createArrayBuffer(t,i.vertices),p=s.createElementBuffer(t,i.indices);return new e(o,{positionBuffer:a,elementBuffer:p})},e.prototype.bind=function(t){t.useProgram(this.location),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,this.bindings.positionBuffer),t.enableVertexAttribArray(this.attribs.a_position),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bindings.elementBuffer)},e.prototype.setProjection=function(t,e){t.uniformMatrix4fv(this.uniforms.u_projection,!1,e.data)},e.prototype.setColor=function(t,e){t.uniform4fv(this.uniforms.u_color,e.data)},e.prototype.setModel=function(t,e){t.vertexAttribPointer(this.attribs.a_position,2,t.FLOAT,!1,0,e.vertexBufferOffset),this.elementCount=e.indices.data.length,this.elementOffset=e.elementBufferOffset},e.prototype.setModelMatrix=function(t,e){t.uniformMatrix3fv(this.uniforms.u_model,!1,e.data)},e.prototype.draw=function(t){t.drawElements(t.TRIANGLES,this.elementCount,t.UNSIGNED_SHORT,this.elementOffset)},e}(c.Program);r.ShapeProgram=p},{"../graphics/data/indices":4,"../graphics/data/vertices":8,"../graphics/rendering/program":16,"../graphics/rendering/util":20,"./shaders":28}],30:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./graphics/rendering/renderer"),i=t("./graphics/rendering/projection"),a=t("./program/ellipse"),s=t("./program/line"),c=t("./program/shape"),u=t("./program/hexel"),p=t("./hexel/grid"),h=t("./graphics/data/color"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rgba=new h.ColorF,e.lineThickness=p.H_WIDTH,e}return n(e,t),e.create=function(t,r,n){var o=Math.max(r.rows,r.cols),p=new i.Projection(r.bounds,1,o),h={ellipse:a.EllipseProgram.create(t),line:s.LineProgram.create(t),shape:c.ShapeProgram.create(t,n),hexel:u.HexelProgram.create(t,r)},f={ellipse:null,line:null,shape:null};return new e(t,p,h,f)},Object.defineProperty(e.prototype,"color",{set:function(t){this.rgba.setFromColor(t),this.rgba.premultiplyAlpha()},enumerable:!0,configurable:!0}),e.prototype.onSurfaceCreated=function(){var t=this.gl;t.clearColor(0,0,0,0),t.cullFace(t.BACK),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},e.prototype.onDrawFrame=function(){var t=this.gl,e=this.projection,r=e.matrix,n=this.programs,o=n.hexel,i=n.shape,a=n.ellipse,s=n.line,c=this.drawables,u=c.shape,p=c.ellipse,h=c.line,f=this.lineThickness,d=this.rgba;this.useProgram(o),o.setProjection(t,r),o.draw(t,e),u?(this.useProgram(i),i.setProjection(t,r),i.setColor(t,d),i.setModel(t,u.model),i.setModelMatrix(t,u.matrix),i.draw(t)):p?(this.useProgram(a),a.setProjection(t,r),a.setColor(t,d),a.setEllipse(t,p),a.draw(t)):h&&(this.useProgram(s),s.setProjection(t,r),s.setColor(t,d),
s.setThickness(t,f),s.setLine(t,h),s.draw(t))},e.prototype.applyGradientChanges=function(){this.programs.hexel.applyGradientChanges(this.gl),this.needToRender=!0},e.prototype.applyColorChanges=function(){this.programs.hexel.applyColorChanges(this.gl),this.needToRender=!0},e}(o.Renderer);r.HexelRenderer=f},{"./graphics/data/color":3,"./graphics/rendering/projection":17,"./graphics/rendering/renderer":18,"./hexel/grid":22,"./program/ellipse":25,"./program/hexel":26,"./program/line":27,"./program/shape":29}]},{},[23]);